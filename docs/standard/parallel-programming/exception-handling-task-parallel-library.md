---
title: Control de excepciones (Task Parallel Library)
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-standard
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords: tasks, exceptions
ms.assetid: beb51e50-9061-4d3d-908c-56a4f7c2e8c1
caps.latest.revision: "21"
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.openlocfilehash: e62498376d321d8ff22a53315b9d5f18a8865056
ms.sourcegitcommit: bd1ef61f4bb794b25383d3d72e71041a5ced172e
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 10/18/2017
---
# <a name="exception-handling-task-parallel-library"></a><span data-ttu-id="5e2fb-102">Control de excepciones (Task Parallel Library)</span><span class="sxs-lookup"><span data-stu-id="5e2fb-102">Exception Handling (Task Parallel Library)</span></span>
<span data-ttu-id="5e2fb-103">Las excepciones no controladas que se inician mediante código de usuario que se ejecuta dentro de una tarea se propagan de vuelta al subproceso que hace la llamada, excepto en determinados escenarios que se describen posteriormente en este tema.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-103">Unhandled exceptions that are thrown by user code that is running inside a task are propagated back to the calling thread, except in certain scenarios that are described later in this topic.</span></span> <span data-ttu-id="5e2fb-104">Las excepciones se propagan cuando se usa uno de los métodos estático o de instancia <xref:System.Threading.Tasks.Task.Wait%2A?displayProperty=nameWithType> o <!--zz <xref:System.Threading.Tasks.Task%601.Wait%2A?displayProperty=nameWithType>  --> `Wait` métodos y se pueden controlar si se incluye la llamada en un `try` / `catch` instrucción.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-104">Exceptions are propagated when you use one of the static or instance <xref:System.Threading.Tasks.Task.Wait%2A?displayProperty=nameWithType> or <!--zz <xref:System.Threading.Tasks.Task%601.Wait%2A?displayProperty=nameWithType>  --> `Wait` methods, and you handle them by enclosing the call in a `try`/`catch` statement.</span></span> <span data-ttu-id="5e2fb-105">Si una tarea es la tarea primaria de tareas secundarias asociadas o si se esperan varias tareas, pueden producirse varias excepciones.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-105">If a task is the parent of attached child tasks, or if you are waiting on multiple tasks, multiple exceptions could be thrown.</span></span>  
  
 <span data-ttu-id="5e2fb-106">Para propagar todas las excepciones de nuevo al subproceso que realiza la llamada, la infraestructura de la tarea las encapsula en una instancia de <xref:System.AggregateException> .</span><span class="sxs-lookup"><span data-stu-id="5e2fb-106">To propagate all the exceptions back to the calling thread, the Task infrastructure wraps them in an <xref:System.AggregateException> instance.</span></span> <span data-ttu-id="5e2fb-107">La excepción <xref:System.AggregateException> tiene una propiedad <xref:System.AggregateException.InnerExceptions%2A> que se puede enumerar para examinar todas las excepciones originales que se produjeron y controlar (o no) cada una de ellas de forma individual.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-107">The <xref:System.AggregateException> exception has an <xref:System.AggregateException.InnerExceptions%2A> property that can be enumerated to examine all the original exceptions that were thrown, and handle (or not handle) each one individually.</span></span> <span data-ttu-id="5e2fb-108">También puede controlar las excepciones originales mediante el <xref:System.AggregateException.Handle%2A?displayProperty=nameWithType> método.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-108">You can also handle the original exceptions by using the <xref:System.AggregateException.Handle%2A?displayProperty=nameWithType> method.</span></span>  
  
 <span data-ttu-id="5e2fb-109">Incluso aunque solo se produzca una excepción, se encapsulará en una excepción <xref:System.AggregateException> , como se muestra en el ejemplo siguiente.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-109">Even if only one exception is thrown, it is still wrapped in an <xref:System.AggregateException> exception, as the following example shows.</span></span>  
  
 [!code-csharp[TPL_Exceptions#21](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_exceptions/cs/handling21.cs#21)]
 [!code-vb[TPL_Exceptions#21](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_exceptions/vb/handling21.vb#21)]  
  
 <span data-ttu-id="5e2fb-110">Para evitar una excepción no controlada, basta con detectar el objeto <xref:System.AggregateException> y omitir las excepciones internas.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-110">You could avoid an unhandled exception by just catching the <xref:System.AggregateException> and not observing any of the inner exceptions.</span></span> <span data-ttu-id="5e2fb-111">Sin embargo, esta operación no resulta recomendable porque es igual que detectar el tipo <xref:System.Exception> base en escenarios no paralelos.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-111">However, we recommend that you do not do this because it is analogous to catching the base <xref:System.Exception> type in non-parallel scenarios.</span></span> <span data-ttu-id="5e2fb-112">Si desea detectar una excepción sin realizar acciones concretas que la resuelvan, puede dejar al programa en un estado indeterminado.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-112">To catch an exception without taking specific actions to recover from it can leave your program in an indeterminate state.</span></span>  
  
 <span data-ttu-id="5e2fb-113">Si no desea llamar a la <xref:System.Threading.Tasks.Task.Wait%2A?displayProperty=nameWithType> o <!--zz <xref:System.Threading.Tasks.Task%601.Wait%2A?displayProperty=nameWithType>  --> `Wait` método para esperar la finalización de una tarea, también se puede recuperar el <xref:System.AggregateException> excepción de la tarea <xref:System.Threading.Tasks.Task.Exception%2A> propiedad, como se muestra en el ejemplo siguiente.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-113">If you do not want to call the <xref:System.Threading.Tasks.Task.Wait%2A?displayProperty=nameWithType> or <!--zz <xref:System.Threading.Tasks.Task%601.Wait%2A?displayProperty=nameWithType>  --> `Wait` method to wait for a task's completion, you can also retrieve the <xref:System.AggregateException> exception from the task's <xref:System.Threading.Tasks.Task.Exception%2A> property, as the following example shows.</span></span> <span data-ttu-id="5e2fb-114">Para más información, consulte la sección [Observar excepciones mediante la propiedad Task.Exception](#ExceptionProp) de este tema.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-114">For more information, see the [Observing Exceptions By Using the Task.Exception Property](#ExceptionProp) section in this topic.</span></span>  
  
 [!code-csharp[TPL_Exceptions#29](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_exceptions/cs/handling22.cs#29)]
 [!code-vb[TPL_Exceptions#29](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_exceptions/vb/handling22.vb#29)]  
  
 <span data-ttu-id="5e2fb-115">Si no espera a una tarea que propague la excepción ni accede a su propiedad <xref:System.Threading.Tasks.Task.Exception%2A> , la excepción se escalará conforme a la directiva de excepciones de .NET cuando la tarea se recopile como elemento no utilizado.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-115">If you do not wait on a task that propagates an exception, or access its <xref:System.Threading.Tasks.Task.Exception%2A> property, the exception is escalated according to the .NET exception policy when the task is garbage-collected.</span></span>  
  
 <span data-ttu-id="5e2fb-116">Cuando las excepciones pueden propagarse de vuelta al subproceso de unión, es posible que una tarea continúe procesando algunos elementos después de que se haya producido la excepción.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-116">When exceptions are allowed to bubble up back to the joining thread, it is possible that a task may continue to process some items after the exception is raised.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="5e2fb-117">Cuando está habilitada la opción "Solo mi código", en algunos casos, Visual Studio se interrumpe en la línea que produce la excepción y muestra el mensaje de error "Excepción no controlada por el código de usuario".</span><span class="sxs-lookup"><span data-stu-id="5e2fb-117">When "Just My Code" is enabled, Visual Studio in some cases will break on the line that throws the exception and display an error message that says "exception not handled by user code."</span></span> <span data-ttu-id="5e2fb-118">Este error es benigno.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-118">This error is benign.</span></span> <span data-ttu-id="5e2fb-119">Puede presionar F5 para continuar y ver el comportamiento de control de excepciones que se muestra en estos ejemplos.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-119">You can press F5 to continue and see the exception-handling behavior that is demonstrated in these examples.</span></span> <span data-ttu-id="5e2fb-120">Para evitar que Visual Studio se interrumpa con el primer error, desactive la casilla **Habilitar Solo mi código** bajo **Herramientas, Opciones, Depuración, General**.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-120">To prevent Visual Studio from breaking on the first error, just uncheck the **Enable Just My Code** checkbox under **Tools, Options, Debugging, General**.</span></span>  
  
## <a name="attached-child-tasks-and-nested-aggregateexceptions"></a><span data-ttu-id="5e2fb-121">Tareas secundarias asociadas y objetos AggregateException anidados</span><span class="sxs-lookup"><span data-stu-id="5e2fb-121">Attached Child Tasks and Nested AggregateExceptions</span></span>  
 <span data-ttu-id="5e2fb-122">Si una tarea tiene una tarea secundaria adjunta que inicia una excepción, esa excepción se encapsula en un objeto <xref:System.AggregateException> antes de que se propague a la tarea primaria, que encapsula esa excepción en su propio objeto <xref:System.AggregateException> antes de propagarla de nuevo al subproceso que realiza la llamada.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-122">If a task has an attached child task that throws an exception, that exception is wrapped in an <xref:System.AggregateException> before it is propagated to the parent task, which wraps that exception in its own <xref:System.AggregateException> before it propagates it back to the calling thread.</span></span> <span data-ttu-id="5e2fb-123">En tales casos, la <xref:System.AggregateException.InnerExceptions%2A> propiedad de la <xref:System.AggregateException> excepción detectada en el <xref:System.Threading.Tasks.Task.Wait%2A?displayProperty=nameWithType> o <!--zz <xref:System.Threading.Tasks.Task%601.Wait%2A?displayProperty=nameWithType>  --> `Wait` o <xref:System.Threading.Tasks.Task.WaitAny%2A> o <xref:System.Threading.Tasks.Task.WaitAll%2A> método contiene uno o varios <xref:System.AggregateException> instancias, no el excepciones originales que produjeron el error.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-123">In such cases, the <xref:System.AggregateException.InnerExceptions%2A> property of the <xref:System.AggregateException> exception that is caught at the <xref:System.Threading.Tasks.Task.Wait%2A?displayProperty=nameWithType> or <!--zz <xref:System.Threading.Tasks.Task%601.Wait%2A?displayProperty=nameWithType>  --> `Wait` or <xref:System.Threading.Tasks.Task.WaitAny%2A> or <xref:System.Threading.Tasks.Task.WaitAll%2A> method contains one or more <xref:System.AggregateException> instances, not the original exceptions that caused the fault.</span></span> <span data-ttu-id="5e2fb-124">Para evitar tener que iterar sobre anidado <xref:System.AggregateException> excepciones, puede usar el <xref:System.AggregateException.Flatten%2A> método para quitar todos los anidado <xref:System.AggregateException> excepciones, por lo que el <xref:System.AggregateException.InnerExceptions%2A?displayProperty=nameWithType> propiedad contiene las excepciones originales.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-124">To avoid having to iterate over nested <xref:System.AggregateException> exceptions, you can use the <xref:System.AggregateException.Flatten%2A> method to remove all the nested <xref:System.AggregateException> exceptions, so that the <xref:System.AggregateException.InnerExceptions%2A?displayProperty=nameWithType> property contains the original exceptions.</span></span> <span data-ttu-id="5e2fb-125">En el ejemplo siguiente, las instancias anidadas de <xref:System.AggregateException> se reducen y se controlan en un solo bucle.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-125">In the following example, nested <xref:System.AggregateException> instances are flattened and handled in just one loop.</span></span>  
  
 [!code-csharp[TPL_Exceptions#22](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_exceptions/cs/flatten2.cs#22)]
 [!code-vb[TPL_Exceptions#22](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_exceptions/vb/flatten2.vb#22)]  
  
 <span data-ttu-id="5e2fb-126">También puede usar el <xref:System.AggregateException.Flatten%2A?displayProperty=nameWithType> método volver a producir las excepciones internas de varias <xref:System.AggregateException> instancias iniciadas por varias tareas en una sola <xref:System.AggregateException> instancia, tal y como se muestra en el ejemplo siguiente.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-126">You can also use the <xref:System.AggregateException.Flatten%2A?displayProperty=nameWithType> method to rethrow the inner exceptions from multiple <xref:System.AggregateException> instances thrown by multiple tasks in a single <xref:System.AggregateException> instance, as the following example shows.</span></span>  
  
 [!code-csharp[TPL_Exceptions#13](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_exceptions/cs/taskexceptions2.cs#13)]
 [!code-vb[TPL_Exceptions#13](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_exceptions/vb/taskexceptions2.vb#13)]  
  
## <a name="exceptions-from-detached-child-tasks"></a><span data-ttu-id="5e2fb-127">Excepciones de tareas secundarias desasociadas</span><span class="sxs-lookup"><span data-stu-id="5e2fb-127">Exceptions from Detached Child Tasks</span></span>  
 <span data-ttu-id="5e2fb-128">De forma predeterminada, las tareas secundarias están desasociadas cuando se crean.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-128">By default, child tasks are created as detached.</span></span> <span data-ttu-id="5e2fb-129">Las excepciones producidas por tareas desasociadas deben controlarse o reiniciarse en la tarea primaria inmediata; no se propagan de nuevo al subproceso que realiza la llamada del mismo modo que las tareas secundarias asociadas.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-129">Exceptions thrown from detached tasks must be handled or rethrown in the immediate parent task; they are not propagated back to the calling thread in the same way as attached child tasks propagated back.</span></span> <span data-ttu-id="5e2fb-130">La tarea primaria superior puede reiniciar manualmente una excepción de una tarea secundaria desasociada para que se encapsule en un objeto <xref:System.AggregateException> y propagarla de vuelta al subproceso de unión.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-130">The topmost parent can manually rethrow an exception from a detached child to cause it to be wrapped in an <xref:System.AggregateException> and propagated back to the calling thread.</span></span>  
  
 [!code-csharp[TPL_Exceptions#23](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_exceptions/cs/detached21.cs#23)]
 [!code-vb[TPL_Exceptions#23](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_exceptions/vb/detached21.vb#23)]  
  
 <span data-ttu-id="5e2fb-131">Aunque se use una tarea de continuación para observar una excepción en una tarea secundaria, la tarea primaria debe seguir observando la excepción.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-131">Even if you use a continuation to observe an exception in a child task, the exception still must be observed by the parent task.</span></span>  
  
## <a name="exceptions-that-indicate-cooperative-cancellation"></a><span data-ttu-id="5e2fb-132">Excepciones que indican la cancelación cooperativa</span><span class="sxs-lookup"><span data-stu-id="5e2fb-132">Exceptions That Indicate Cooperative Cancellation</span></span>  
 <span data-ttu-id="5e2fb-133">Cuando el código de usuario de una tarea responde a una solicitud de cancelación, el procedimiento correcto es producir una excepción <xref:System.OperationCanceledException> que se pasa en el token de cancelación con el que se comunicó la solicitud.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-133">When user code in a task responds to a cancellation request, the correct procedure is to throw an <xref:System.OperationCanceledException> passing in the cancellation token on which the request was communicated.</span></span> <span data-ttu-id="5e2fb-134">Antes de intentar propagar la excepción, la instancia de la tarea compara el token de la excepción con el que recibió durante su creación.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-134">Before it attempts to propagate the exception, the task instance compares the token in the exception to the one that was passed to it when it was created.</span></span> <span data-ttu-id="5e2fb-135">Si son iguales, la tarea propaga una excepción <xref:System.Threading.Tasks.TaskCanceledException> encapsulada en un elemento <xref:System.AggregateException>y puede verse cuando se examinan las excepciones internas.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-135">If they are the same, the task propagates a <xref:System.Threading.Tasks.TaskCanceledException> wrapped in the <xref:System.AggregateException>, and it can be seen when the inner exceptions are examined.</span></span> <span data-ttu-id="5e2fb-136">Sin embargo, si el subproceso que hace la llamada no está esperando la tarea, no se propagará esa excepción concreta.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-136">However, if the calling thread is not waiting on the task, this specific exception will not be propagated.</span></span> <span data-ttu-id="5e2fb-137">Para obtener más información, consulta [Task Cancellation](../../../docs/standard/parallel-programming/task-cancellation.md).</span><span class="sxs-lookup"><span data-stu-id="5e2fb-137">For more information, see [Task Cancellation](../../../docs/standard/parallel-programming/task-cancellation.md).</span></span>  
  
 [!code-csharp[TPL_Exceptions#4](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_exceptions/cs/exceptions.cs#4)]
 [!code-vb[TPL_Exceptions#4](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_exceptions/vb/tpl_exceptions.vb#4)]  
  
## <a name="using-the-handle-method-to-filter-inner-exceptions"></a><span data-ttu-id="5e2fb-138">Usar el método Handle para filtrar excepciones internas</span><span class="sxs-lookup"><span data-stu-id="5e2fb-138">Using the Handle Method to Filter Inner Exceptions</span></span>  
 <span data-ttu-id="5e2fb-139">El método <xref:System.AggregateException.Handle%2A?displayProperty=nameWithType> puede usarse para filtrar excepciones que pueden tratarse como "controladas" sin necesidad de usar ninguna otra lógica.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-139">You can use the <xref:System.AggregateException.Handle%2A?displayProperty=nameWithType> method to filter out exceptions that you can treat as "handled" without using any further logic.</span></span> <span data-ttu-id="5e2fb-140">En el delegado de usuario que se proporciona a la <xref:System.AggregateException.Handle%28System.Func%7BSystem.Exception%2CSystem.Boolean%7D%29?displayProperty=nameWithType> método, puede examinar el tipo de excepción, su <xref:System.Exception.Message%2A> propiedad o cualquier otra información sobre lo que le permitirá determinar si es benigna.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-140">In the user delegate that is supplied to the <xref:System.AggregateException.Handle%28System.Func%7BSystem.Exception%2CSystem.Boolean%7D%29?displayProperty=nameWithType> method, you can examine the exception type, its <xref:System.Exception.Message%2A> property, or any other information about it that will let you determine whether it is benign.</span></span> <span data-ttu-id="5e2fb-141">Las excepciones para el que el delegado devuelve `false` se reinician en un nuevo <xref:System.AggregateException> inmediatamente después de la instancia la <xref:System.AggregateException.Handle%2A?displayProperty=nameWithType> devuelve del método.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-141">Any exceptions for which the delegate returns `false` are rethrown in a new <xref:System.AggregateException> instance immediately after the <xref:System.AggregateException.Handle%2A?displayProperty=nameWithType> method returns.</span></span>  
  
 <span data-ttu-id="5e2fb-142">En el ejemplo siguiente es funcionalmente equivalente al primer ejemplo de este tema, que examina cada excepción de la <xref:System.AggregateException.InnerExceptions%2A?displayProperty=nameWithType> colección.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-142">The following example is functionally equivalent to the first example in this topic, which examines each exception in the <xref:System.AggregateException.InnerExceptions%2A?displayProperty=nameWithType> collection.</span></span>  <span data-ttu-id="5e2fb-143">En su lugar, llama a este controlador de excepciones del <xref:System.AggregateException.Handle%2A?displayProperty=nameWithType> objeto del método para cada excepción y solo vuelve a generar excepciones no `CustomException` instancias.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-143">Instead, this exception handler calls the <xref:System.AggregateException.Handle%2A?displayProperty=nameWithType> method object for each exception, and only rethrows exceptions that are not `CustomException` instances.</span></span>  
  
 [!code-csharp[TPL_Exceptions#26](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_exceptions/cs/handlemethod21.cs#26)]
 [!code-vb[TPL_Exceptions#26](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_exceptions/vb/handlemethod21.vb#26)]  
  
 <span data-ttu-id="5e2fb-144">Éste es un ejemplo más completo que usa el <xref:System.AggregateException.Handle%2A?displayProperty=nameWithType> método para proporcionar un control especial para un <xref:System.UnauthorizedAccessException> excepción al enumerar los archivos.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-144">The following is a more complete example that uses the <xref:System.AggregateException.Handle%2A?displayProperty=nameWithType> method to provide special handling for an <xref:System.UnauthorizedAccessException> exception when enumerating files.</span></span>  
  
 [!code-csharp[TPL_Exceptions#12](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_exceptions/cs/taskexceptions.cs#12)]
 [!code-vb[TPL_Exceptions#12](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_exceptions/vb/taskexceptions.vb#12)]  
  
<a name="ExceptionProp"></a>   
## <a name="observing-exceptions-by-using-the-taskexception-property"></a><span data-ttu-id="5e2fb-145">Observar excepciones mediante la propiedad Task.Exception</span><span class="sxs-lookup"><span data-stu-id="5e2fb-145">Observing Exceptions by Using the Task.Exception Property</span></span>  
 <span data-ttu-id="5e2fb-146">Si una tarea se completa con el estado <xref:System.Threading.Tasks.TaskStatus.Faulted?displayProperty=nameWithType>, se puede examinar su propiedad <xref:System.Threading.Tasks.Task.Exception%2A> para detectar qué excepción concreta produjo el error.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-146">If a task completes in the <xref:System.Threading.Tasks.TaskStatus.Faulted?displayProperty=nameWithType> state, its <xref:System.Threading.Tasks.Task.Exception%2A> property can be examined to discover which specific exception caused the fault.</span></span> <span data-ttu-id="5e2fb-147">Un mecanismo adecuado para observar la propiedad <xref:System.Threading.Tasks.Task.Exception%2A> es usar una continuación que se ejecute solo si se produce un error en la tarea anterior, tal y como se muestra en el siguiente ejemplo.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-147">A good way to observe the <xref:System.Threading.Tasks.Task.Exception%2A> property is to use a continuation that runs only if the antecedent task faults, as shown in the following example.</span></span>  
  
 [!code-csharp[TPL_Exceptions#27](../../../samples/snippets/csharp/VS_Snippets_Misc/tpl_exceptions/cs/exceptionprop21.cs#27)]
 [!code-vb[TPL_Exceptions#27](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpl_exceptions/vb/exceptionprop21.vb#27)]  
  
 <span data-ttu-id="5e2fb-148">En una aplicación real, el delegado de continuación podría registrar información detallada sobre la excepción y posiblemente generar nuevas tareas para recuperarse de la excepción.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-148">In a real application, the continuation delegate could log detailed information about the exception and possibly spawn new tasks to recover from the exception.</span></span>  
  
## <a name="unobservedtaskexception-event"></a><span data-ttu-id="5e2fb-149">Evento UnobservedTaskException</span><span class="sxs-lookup"><span data-stu-id="5e2fb-149">UnobservedTaskException Event</span></span>  
 <span data-ttu-id="5e2fb-150">En algunos escenarios (por ejemplo, cuando se hospedan complementos que no son de confianza), es posible que se produzcan numerosas excepciones benignas y que resulte demasiado difícil observarlas todas manualmente.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-150">In some scenarios, such as when hosting untrusted plug-ins, benign exceptions might be common, and it might be too difficult to manually observe them all.</span></span> <span data-ttu-id="5e2fb-151">En estos casos, se puede proceder a controlar el evento <xref:System.Threading.Tasks.TaskScheduler.UnobservedTaskException?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-151">In these cases, you can handle the <xref:System.Threading.Tasks.TaskScheduler.UnobservedTaskException?displayProperty=nameWithType> event.</span></span> <span data-ttu-id="5e2fb-152">La instancia de <xref:System.Threading.Tasks.UnobservedTaskExceptionEventArgs?displayProperty=nameWithType> que se pasa al controlador se puede utilizar para evitar que la excepción no observada se propague de nuevo al subproceso de unión.</span><span class="sxs-lookup"><span data-stu-id="5e2fb-152">The <xref:System.Threading.Tasks.UnobservedTaskExceptionEventArgs?displayProperty=nameWithType> instance that is passed to your handler can be used to prevent the unobserved exception from being propagated back to the joining thread.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5e2fb-153">Vea también</span><span class="sxs-lookup"><span data-stu-id="5e2fb-153">See Also</span></span>  
 [<span data-ttu-id="5e2fb-154">Biblioteca TPL</span><span class="sxs-lookup"><span data-stu-id="5e2fb-154">Task Parallel Library (TPL)</span></span>](../../../docs/standard/parallel-programming/task-parallel-library-tpl.md)
