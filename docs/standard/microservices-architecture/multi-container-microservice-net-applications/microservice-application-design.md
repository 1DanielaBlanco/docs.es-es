---
title: "Diseñar una aplicación orientada a servicios de microservicio"
description: "Arquitectura de Microservicios de .NET para aplicaciones .NET en contenedores | Diseñar una aplicación orientada a servicios de microservicio"
keywords: Docker, microservicios, ASP.NET, contenedor
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 05/26/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.topic: article
ms.openlocfilehash: 1e1dc919c7e35580576c86b4cf9872b4f8cea2c2
ms.sourcegitcommit: c2e216692ef7576a213ae16af2377cd98d1a67fa
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 10/22/2017
---
# <a name="designing-a-microservice-oriented-application"></a><span data-ttu-id="c39a1-104">Diseñar una aplicación orientada a servicios de microservicio</span><span class="sxs-lookup"><span data-stu-id="c39a1-104">Designing a microservice-oriented application</span></span>

<span data-ttu-id="c39a1-105">En esta sección se centra en desarrollar una aplicación hipotética empresarial de servidor.</span><span class="sxs-lookup"><span data-stu-id="c39a1-105">This section focuses on developing a hypothetical server-side enterprise application.</span></span>

## <a name="application-specifications"></a><span data-ttu-id="c39a1-106">Especificaciones de la aplicación</span><span class="sxs-lookup"><span data-stu-id="c39a1-106">Application specifications</span></span>

<span data-ttu-id="c39a1-107">La aplicación hipotética controla las solicitudes mediante la ejecución lógica de negocios, obtener acceso a las bases de datos y, a continuación, devolver respuestas HTML, JSON o XML.</span><span class="sxs-lookup"><span data-stu-id="c39a1-107">The hypothetical application handles requests by executing business logic, accessing databases, and then returning HTML, JSON, or XML responses.</span></span> <span data-ttu-id="c39a1-108">Le dirá que la aplicación debe admitir una variedad de clientes, incluidos los exploradores de escritorio que ejecutan aplicaciones de una sola página (SPAs), las aplicaciones web tradicionales, las aplicaciones web móviles y aplicaciones móviles nativas.</span><span class="sxs-lookup"><span data-stu-id="c39a1-108">We will say that the application must support a variety of clients, including desktop browsers running Single Page Applications (SPAs), traditional web apps, mobile web apps, and native mobile apps.</span></span> <span data-ttu-id="c39a1-109">La aplicación también podría exponer una API de otros fabricantes consumir.</span><span class="sxs-lookup"><span data-stu-id="c39a1-109">The application might also expose an API for third parties to consume.</span></span> <span data-ttu-id="c39a1-110">También debe ser capaz de integrar su microservicios o las aplicaciones externas de forma asincrónica, por lo que el enfoque ayudará resistencia de la microservicios en el caso de errores parciales.</span><span class="sxs-lookup"><span data-stu-id="c39a1-110">It should also be able to integrate its microservices or external applications asynchronously, so that approach will help resiliency of the microservices in the case of partial failures.</span></span>

<span data-ttu-id="c39a1-111">La aplicación constará de estos tipos de componentes:</span><span class="sxs-lookup"><span data-stu-id="c39a1-111">The application will consist of these types of components:</span></span>

-   <span data-ttu-id="c39a1-112">Componentes de presentación.</span><span class="sxs-lookup"><span data-stu-id="c39a1-112">Presentation components.</span></span> <span data-ttu-id="c39a1-113">Se trata de un responsables de controlar la interfaz de usuario y el consumo de servicios remotos.</span><span class="sxs-lookup"><span data-stu-id="c39a1-113">These are responsible for handling the UI and consuming remote services.</span></span>

-   <span data-ttu-id="c39a1-114">Dominio o la lógica empresarial.</span><span class="sxs-lookup"><span data-stu-id="c39a1-114">Domain or business logic.</span></span> <span data-ttu-id="c39a1-115">Se trata de la lógica de dominio de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c39a1-115">This is the application’s domain logic.</span></span>

-   <span data-ttu-id="c39a1-116">Lógica de acceso de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="c39a1-116">Database access logic.</span></span> <span data-ttu-id="c39a1-117">Se compone de data access components para responsables de obtener acceso a bases de datos (SQL o NoSQL).</span><span class="sxs-lookup"><span data-stu-id="c39a1-117">This consists of data access components responsible for accessing databases (SQL or NoSQL).</span></span>

-   <span data-ttu-id="c39a1-118">Lógica de integración de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c39a1-118">Application integration logic.</span></span> <span data-ttu-id="c39a1-119">Se trata de un canal de mensajería, principalmente en función de los agentes de mensajes.</span><span class="sxs-lookup"><span data-stu-id="c39a1-119">This includes a messaging channel, mainly based on message brokers.</span></span>

<span data-ttu-id="c39a1-120">La aplicación solicitará alta escalabilidad, permitiendo sus subsistemas verticales escalar horizontalmente de forma autónoma, porque ciertos subsistemas requerirá mayor escalabilidad que otros usuarios.</span><span class="sxs-lookup"><span data-stu-id="c39a1-120">The application will require high scalability, while allowing its vertical subsystems to scale out autonomously, because certain subsystems will require more scalability than others.</span></span>

<span data-ttu-id="c39a1-121">La aplicación debe ser capaz de implementarse en varios entornos de infraestructura (varias nubes públicas y locales) y debe ser multiplataforma, puede mover fácilmente de Linux en Windows (o viceversa).</span><span class="sxs-lookup"><span data-stu-id="c39a1-121">The application must be able to be deployed in multiple infrastructure environments (multiple public clouds and on-premises) and ideally should be cross-platform, able to move from Linux to Windows (or vice versa) easily.</span></span>

## <a name="development-team-context"></a><span data-ttu-id="c39a1-122">Contexto de equipo de desarrollo</span><span class="sxs-lookup"><span data-stu-id="c39a1-122">Development team context</span></span>

<span data-ttu-id="c39a1-123">También se supone lo siguiente sobre el proceso de desarrollo de la aplicación:</span><span class="sxs-lookup"><span data-stu-id="c39a1-123">We also assume the following about the development process for the application:</span></span>

-   <span data-ttu-id="c39a1-124">Tiene varios equipos de desarrollo centrarse en áreas de empresarial diferente de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c39a1-124">You have multiple dev teams focusing on different business areas of the application.</span></span>

-   <span data-ttu-id="c39a1-125">Los miembros del equipo nuevo deben ser más productivos rápidamente, y la aplicación debe ser fácil de entender y modificar.</span><span class="sxs-lookup"><span data-stu-id="c39a1-125">New team members must become productive quickly, and the application must be easy to understand and modify.</span></span>

-   <span data-ttu-id="c39a1-126">La aplicación tendrá una evolución a largo plazo y reglas de negocio cambiantes.</span><span class="sxs-lookup"><span data-stu-id="c39a1-126">The application will have a long-term evolution and ever-changing business rules.</span></span>

-   <span data-ttu-id="c39a1-127">Necesita el buen mantenimiento a largo plazo, lo que significa tener agilidad al implementar los nuevos cambios en el futuro mientras se pueda actualizar varios subsistemas con un impacto mínimo en los otros subsistemas.</span><span class="sxs-lookup"><span data-stu-id="c39a1-127">You need good long-term maintainability, which means having agility when implementing new changes in the future while being able to update multiple subsystems with minimum impact on the other subsystems.</span></span>

-   <span data-ttu-id="c39a1-128">Desea la integración continua práctica y la implementación continua de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c39a1-128">You want to practice continuous integration and continuous deployment of the application.</span></span>

-   <span data-ttu-id="c39a1-129">Desea aprovechar las ventajas de nuevas tecnologías (marcos, de programación de idiomas, etc.) durante la evolución de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c39a1-129">You want to take advantage of emerging technologies (frameworks, programming languages, etc.) while evolving the application.</span></span> <span data-ttu-id="c39a1-130">¿Desea realizar migraciones completas de la aplicación cuando se mueven a las nuevas tecnologías, ya podría dar lugar a altos costos y afectar a la capacidad de predicción y la estabilidad de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c39a1-130">You do not want to make full migrations of the application when moving to new technologies, because that would result in high costs and impact the predictability and stability of the application.</span></span>

## <a name="choosing-an-architecture"></a><span data-ttu-id="c39a1-131">Elección de una arquitectura</span><span class="sxs-lookup"><span data-stu-id="c39a1-131">Choosing an architecture</span></span>

<span data-ttu-id="c39a1-132">¿Cuál debe ser la arquitectura de implementación de aplicación?</span><span class="sxs-lookup"><span data-stu-id="c39a1-132">What should the application deployment architecture be?</span></span> <span data-ttu-id="c39a1-133">Las especificaciones de la aplicación, junto con el contexto de desarrollo, es recomendable que debe diseñar la aplicación, descomponiendo en subsistemas autónomos en forma de colaborar microservicios y contenedores, donde un microservicio es un contenedor.</span><span class="sxs-lookup"><span data-stu-id="c39a1-133">The specifications for the application, along with the development context, strongly suggest that you should architect the application by decomposing it into autonomous subsystems in the form of collaborating microservices and containers, where a microservice is a container.</span></span>

<span data-ttu-id="c39a1-134">En este enfoque, cada servicio (contenedor) implementa un conjunto de funciones coherente y sigan relacionados.</span><span class="sxs-lookup"><span data-stu-id="c39a1-134">In this approach, each service (container) implements a set of cohesive and narrowly related functions.</span></span> <span data-ttu-id="c39a1-135">Por ejemplo, una aplicación puede constar de servicios como el servicio de catálogo, orden de servicio, el servicio de la cesta de compras, servicio de perfiles de usuario, etcetera.</span><span class="sxs-lookup"><span data-stu-id="c39a1-135">For example, an application might consist of services such as the catalog service, ordering service, basket service, user profile service, etc.</span></span>

<span data-ttu-id="c39a1-136">Microservicios comunican utilizando protocolos como HTTP (REST), pero también de forma asincrónica (es decir, AMQP) siempre que sea posible, especialmente cuando propagar las actualizaciones con eventos de integración.</span><span class="sxs-lookup"><span data-stu-id="c39a1-136">Microservices communicate using protocols such as HTTP (REST), but also asynchronously (that is AMQP) whenever possible, especially when propagating updates with integration events.</span></span>

<span data-ttu-id="c39a1-137">Microservicios se desarrollan y se implementa como contenedores de forma independiente entre sí.</span><span class="sxs-lookup"><span data-stu-id="c39a1-137">Microservices are developed and deployed as containers independently of one another.</span></span> <span data-ttu-id="c39a1-138">Esto significa que un equipo de desarrollo se puede desarrollar e implementar un microservicio determinado sin afectar a otros subsistemas.</span><span class="sxs-lookup"><span data-stu-id="c39a1-138">This means that a development team can be developing and deploying a certain microservice without impacting other subsystems.</span></span>

<span data-ttu-id="c39a1-139">Cada microservicio tiene su propia base de datos, lo que le permite totalmente se separa de otras microservicios.</span><span class="sxs-lookup"><span data-stu-id="c39a1-139">Each microservice has its own database, allowing it to be fully decoupled from other microservices.</span></span> <span data-ttu-id="c39a1-140">Cuando sea necesario, la coherencia entre las bases de datos de diferentes microservicios se logra mediante eventos de integración de nivel de aplicación (a través de un bus de eventos lógicos), tal y como se controla en el comando y la segregación de responsabilidad de consulta (CQRS).</span><span class="sxs-lookup"><span data-stu-id="c39a1-140">When necessary, consistency between databases from different microservices is achieved using application-level integration events (through a logical event bus), as handled in Command and Query Responsibility Segregation (CQRS).</span></span> <span data-ttu-id="c39a1-141">Debido a eso, las restricciones de negocio deben contemplar coherencia definitiva entre las múltiples microservicios y bases de datos relacionadas.</span><span class="sxs-lookup"><span data-stu-id="c39a1-141">Because of that, the business constraints must embrace eventual consistency between the multiple microservices and related databases.</span></span>

### <a name="eshoponcontainers-a-reference-application-for-net-core-and-microservices-deployed-using-containers"></a><span data-ttu-id="c39a1-142">eShopOnContainers: una aplicación de referencia de .NET Core y microservicios implementado con contenedores</span><span class="sxs-lookup"><span data-stu-id="c39a1-142">eShopOnContainers: A reference application for .NET Core and microservices deployed using containers</span></span>

<span data-ttu-id="c39a1-143">Para que pueda centrarse en la arquitectura y las tecnologías en lugar de pensar en un dominio de negocio hypothetic que es posible que no sepa, hemos seleccionado un dominio de negocio conocido:; es decir, una aplicación de comercio electrónico simplificado (e-shop) que presenta un catálogo de productos, recibe pedidos de clientes, comprueba el inventario y realiza otras funciones de negocio.</span><span class="sxs-lookup"><span data-stu-id="c39a1-143">So that you can focus on the architecture and technologies instead of thinking about a hypothetic business domain that you might not know, we have selected a well-known business domain—namely, a simplified e-commerce (e-shop) application that presents a catalog of products, takes orders from customers, verifies inventory, and performs other business functions.</span></span> <span data-ttu-id="c39a1-144">Este código de origen de la aplicación basada en el contenedor está disponible en la [eShopOnContainers](http://aka.ms/MicroservicesArchitecture) repositorio de GitHub.</span><span class="sxs-lookup"><span data-stu-id="c39a1-144">This container-based application source code is available in the [eShopOnContainers](http://aka.ms/MicroservicesArchitecture) GitHub repo.</span></span>

<span data-ttu-id="c39a1-145">La aplicación consta de varios subsistemas, incluidos varios almacén UI servidores front-end (una aplicación Web y una aplicación nativa móvil), junto con las microservicios de back-end y los contenedores para todas las operaciones de servidor necesarios.</span><span class="sxs-lookup"><span data-stu-id="c39a1-145">The application consists of multiple subsystems, including several store UI front ends (a Web application and a native mobile app), along with the back-end microservices and containers for all the required server-side operations.</span></span> <span data-ttu-id="c39a1-146">Figura 8-1 muestra la arquitectura de la aplicación de referencia.</span><span class="sxs-lookup"><span data-stu-id="c39a1-146">Figure 8-1 shows the architecture of the reference application.</span></span>

![](./media/image1.png)

<span data-ttu-id="c39a1-147">**Figura 8-1**.</span><span class="sxs-lookup"><span data-stu-id="c39a1-147">**Figure 8-1**.</span></span> <span data-ttu-id="c39a1-148">El eShopOnContainers hacen referencia a aplicación, que muestra una comunicación de cliente a microservicio directa y el bus de eventos</span><span class="sxs-lookup"><span data-stu-id="c39a1-148">The eShopOnContainers reference application, showing a direct client-to-microservice communication and the event bus</span></span>

<span data-ttu-id="c39a1-149">**Entorno de hospedaje**.</span><span class="sxs-lookup"><span data-stu-id="c39a1-149">**Hosting environment**.</span></span> <span data-ttu-id="c39a1-150">En la figura 8-1, verá varios contenedores que implementan dentro de un único host de Docker.</span><span class="sxs-lookup"><span data-stu-id="c39a1-150">In Figure 8-1, you see several containers deployed within a single Docker host.</span></span> <span data-ttu-id="c39a1-151">Que sería el caso cuando se implementa en un único host de Docker con el docker-crear comando.</span><span class="sxs-lookup"><span data-stu-id="c39a1-151">That would be the case when deploying to a single Docker host with the docker-compose up command.</span></span> <span data-ttu-id="c39a1-152">Sin embargo, si está utilizando organizador o clúster de contenedor, cada contenedor pueden ejecutarse en otro host (nodo) y cualquier nodo podría ejecutar cualquier número de contenedores, tal y como se explicó anteriormente en la sección de arquitectura.</span><span class="sxs-lookup"><span data-stu-id="c39a1-152">However, if you are using an orchestrator or container cluster, each container could be running in a different host (node), and any node could be running any number of containers, as we explained earlier in the architecture section.</span></span>

<span data-ttu-id="c39a1-153">**Arquitectura de comunicación**.</span><span class="sxs-lookup"><span data-stu-id="c39a1-153">**Communication architecture**.</span></span> <span data-ttu-id="c39a1-154">La aplicación eShopOnContainers utiliza dos tipos de comunicación, según el tipo de la acción funcional (consultas frente a transacciones y actualizaciones):</span><span class="sxs-lookup"><span data-stu-id="c39a1-154">The eShopOnContainers application uses two communication types, depending on the kind of the functional action (queries versus updates and transactions):</span></span>

-   <span data-ttu-id="c39a1-155">Comunicación de cliente a microservicio directa.</span><span class="sxs-lookup"><span data-stu-id="c39a1-155">Direct client-to-microservice communication.</span></span> <span data-ttu-id="c39a1-156">Esto se utiliza para las consultas y al aceptar la actualización o comandos transaccionales desde las aplicaciones cliente.</span><span class="sxs-lookup"><span data-stu-id="c39a1-156">This is used for queries and when accepting update or transactional commands from the client apps.</span></span>

-   <span data-ttu-id="c39a1-157">Comunicación asincrónica basado en eventos.</span><span class="sxs-lookup"><span data-stu-id="c39a1-157">Asynchronous event-based communication.</span></span> <span data-ttu-id="c39a1-158">Esto se produce a través de un bus de eventos para propagar las actualizaciones a través de microservicios o para integrar con aplicaciones externas.</span><span class="sxs-lookup"><span data-stu-id="c39a1-158">This occurs through an event bus to propagate updates across microservices or to integrate with external applications.</span></span> <span data-ttu-id="c39a1-159">El bus de eventos se puede implementar con cualquier tecnología de infraestructura de mensajería del agente como RabbitMQ, o mediante bus de servicio de nivel superiores como Service Bus de Azure, NServiceBus, MassTransit o Brighter.</span><span class="sxs-lookup"><span data-stu-id="c39a1-159">The event bus can be implemented with any messaging-broker infrastructure technology like RabbitMQ, or using higher-level service buses like Azure Service Bus, NServiceBus, MassTransit, or Brighter.</span></span>

<span data-ttu-id="c39a1-160">La aplicación se implementa como un conjunto de microservicios en forma de contenedores.</span><span class="sxs-lookup"><span data-stu-id="c39a1-160">The application is deployed as a set of microservices in the form of containers.</span></span> <span data-ttu-id="c39a1-161">Las aplicaciones cliente pueden comunicarse con los contenedores, así como la comunicación entre microservicios.</span><span class="sxs-lookup"><span data-stu-id="c39a1-161">Client apps can communicate with those containers as well as communicate between microservices.</span></span> <span data-ttu-id="c39a1-162">Como se mencionó, esta arquitectura inicial está usando una arquitectura de comunicación de cliente a microservicio directa, lo que significa que una aplicación cliente puede realizar solicitudes en cada uno de los microservicios directamente.</span><span class="sxs-lookup"><span data-stu-id="c39a1-162">As mentioned, this initial architecture is using a direct client-to-microservice communication architecture, which means that a client application can make requests to each of the microservices directly.</span></span> <span data-ttu-id="c39a1-163">Cada microservicio tiene un extremo público como https://servicename.applicationname.companyname.</span><span class="sxs-lookup"><span data-stu-id="c39a1-163">Each microservice has a public endpoint like https://servicename.applicationname.companyname.</span></span> <span data-ttu-id="c39a1-164">Si es necesario, cada microservicio puede usar un puerto TCP diferente.</span><span class="sxs-lookup"><span data-stu-id="c39a1-164">If required, each microservice can use a different TCP port.</span></span> <span data-ttu-id="c39a1-165">En producción, que la dirección URL debería asignar al equilibrador de carga de la microservicios, que distribuye las solicitudes entre las instancias de microservicio disponible.</span><span class="sxs-lookup"><span data-stu-id="c39a1-165">In production, that URL would map to the microservices’ load balancer, which distributes requests across the available microservice instances.</span></span>

<span data-ttu-id="c39a1-166">**Nota importante en vs de puerta de enlace de API. Comunicación directa en eShopOnContainers.**</span><span class="sxs-lookup"><span data-stu-id="c39a1-166">**Important note on API Gateway vs. Direct Communication in eShopOnContainers.**</span></span> <span data-ttu-id="c39a1-167">Como se explica en la sección de la arquitectura de esta guía, la arquitectura de comunicación de cliente a microservicio directa puede tener inconvenientes cuando se está generando una aplicación basada en microservicio grande y compleja.</span><span class="sxs-lookup"><span data-stu-id="c39a1-167">As explained in the architecture section of this guide, the direct client-to-microservice communication architecture can have drawbacks when you are building a large and complex microservice-based application.</span></span> <span data-ttu-id="c39a1-168">Pero puede ser lo suficientemente bueno como para una aplicación pequeña, como en la eShopOnContainers, aplicación, cuyo objetivo es centrarse en una más fácil inicia aplicaciones basados en el contenedor de Docker y no queríamos crear un único monolítico API de puerta de enlace que pueden afectar a la autonomía de desarrollo de microservicios.</span><span class="sxs-lookup"><span data-stu-id="c39a1-168">But it can be good enough for a small application, such as in the eShopOnContainers application, where the goal is to focus on a simpler getting started Docker container-based application and we didn’t want to create a single monolithic API Gateway that can impact the microservices’ development autonomy.</span></span>

<span data-ttu-id="c39a1-169">Sin embargo, si va a diseñar una aplicación basada en microservicio grande con decenas de microservicios, se recomienda encarecidamente que tener en cuenta el patrón de puerta de enlace de API, tal y como se explica en la sección de arquitectura.</span><span class="sxs-lookup"><span data-stu-id="c39a1-169">But, if you are going to design a large microservice-based application with dozens of microservices, we strongly recommend that you consider the API Gateway pattern, as we explained in the architecture section.</span></span>
<span data-ttu-id="c39a1-170">Esta decisión arquitectura se pudieron refactorizar una vez que pensar en las aplicaciones para entornos de producción y frontales fabrican expresamente para clientes remotos.</span><span class="sxs-lookup"><span data-stu-id="c39a1-170">This architectural decision could be refactored once thinking about production-ready applications and specially-made facades for remote clients.</span></span> <span data-ttu-id="c39a1-171">Tener varias las puertas de enlace de API personalizada según el factor de forma de las aplicaciones cliente puede proporcionar ventajas con respecto a la agregación de datos diferente por cada aplicación de cliente más puede ocultar microservicios interno o las API a las aplicaciones cliente y autorizar en ese nivel único.</span><span class="sxs-lookup"><span data-stu-id="c39a1-171">Having multiple custom API Gateways depending on the client apps' form-factor can provide benefits in regard to different data aggregation per client app plus you can hide internal microservices or APIs to the client apps and authorize in that single tier.</span></span> 

<span data-ttu-id="c39a1-172">Sin embargo y como se ha mencionado, tenga cuidado con grandes monolítico API puertas de enlace y que podría terminar la autonomía de desarrollo de su microservicios.</span><span class="sxs-lookup"><span data-stu-id="c39a1-172">However, and as mentioned, beware against large and monolithic API Gateways that might kill your microservices' development autonomy.</span></span>

### <a name="data-sovereignty-per-microservice"></a><span data-ttu-id="c39a1-173">Soberanía de datos por microservicio</span><span class="sxs-lookup"><span data-stu-id="c39a1-173">Data sovereignty per microservice</span></span>

<span data-ttu-id="c39a1-174">En la aplicación de ejemplo, cada microservicio posee su propia base de datos o el origen de datos y cada base de datos o el origen de datos se implementa como otro contenedor.</span><span class="sxs-lookup"><span data-stu-id="c39a1-174">In the sample application, each microservice owns its own database or data source, and each database or data source is deployed as another container.</span></span> <span data-ttu-id="c39a1-175">Se tomó esta decisión de diseño solo para que sea fácil para un desarrollador obtener el código de GitHub, clonarlo y ábralo en Visual Studio o código de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="c39a1-175">This design decision was made only to make it easy for a developer to get the code from GitHub, clone it, and open it in Visual Studio or Visual Studio Code.</span></span> <span data-ttu-id="c39a1-176">O bien, como alternativa, facilita compilar las imágenes de Docker personalizadas mediante .NET Core CLI y la CLI de Docker y, a continuación, implementar y ejecutarlos en un entorno de desarrollo de Docker.</span><span class="sxs-lookup"><span data-stu-id="c39a1-176">Or alternatively, it makes it easy to compile the custom Docker images using .NET Core CLI and the Docker CLI, and then deploy and run them in a Docker development environment.</span></span> <span data-ttu-id="c39a1-177">En cualquier caso, con los contenedores de datos orígenes permite a los desarrolladores compilarán e implementación en cuestión de minutos sin tener que proporcionar una base de datos externo o cualquier otro origen de datos con dependencias en la infraestructura (en la nube o local).</span><span class="sxs-lookup"><span data-stu-id="c39a1-177">Either way, using containers for data sources lets developers build and deploy in a matter of minutes without having to provision an external database or any other data source with hard dependencies on infrastructure (cloud or on-premises).</span></span>

<span data-ttu-id="c39a1-178">En un entorno de producción real, de alta disponibilidad y escalabilidad, las bases de datos deben basarse en los servidores de base de datos en la nube o local, pero no en contenedores.</span><span class="sxs-lookup"><span data-stu-id="c39a1-178">In a real production environment, for high availability and for scalability, the databases should be based on database servers in the cloud or on-premises, but not in containers.</span></span>

<span data-ttu-id="c39a1-179">Por lo tanto, las unidades de implementación de microservicios (e incluso para bases de datos de esta aplicación) son contenedores de Docker y la aplicación de referencia es una aplicación de contenedor múltiples que acoja microservicios principios.</span><span class="sxs-lookup"><span data-stu-id="c39a1-179">Therefore, the units of deployment for microservices (and even for databases in this application) are Docker containers, and the reference application is a multi-container application that embraces microservices principles.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="c39a1-180">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="c39a1-180">Additional resources</span></span>

-   <span data-ttu-id="c39a1-181">**eShopOnContainers repositorio de GitHub. Código de la aplicación de referencia de origen**
    *https://aka.ms/eShopOnContainers/*</span><span class="sxs-lookup"><span data-stu-id="c39a1-181">**eShopOnContainers GitHub repo. Source code for the reference application**
*https://aka.ms/eShopOnContainers/*</span></span>

## <a name="benefits-of-a-microservice-based-solution"></a><span data-ttu-id="c39a1-182">Ventajas de una solución basada en microservicio</span><span class="sxs-lookup"><span data-stu-id="c39a1-182">Benefits of a microservice-based solution</span></span>

<span data-ttu-id="c39a1-183">Una solución de microservicio en función de este tiene muchas ventajas:</span><span class="sxs-lookup"><span data-stu-id="c39a1-183">A microservice based solution like this has many benefits:</span></span>

<span data-ttu-id="c39a1-184">**Cada microservicio es relativamente pequeña, fácil de administrar y desarrollar**.</span><span class="sxs-lookup"><span data-stu-id="c39a1-184">**Each microservice is relatively small—easy to manage and evolve**.</span></span> <span data-ttu-id="c39a1-185">De manera específica:</span><span class="sxs-lookup"><span data-stu-id="c39a1-185">Specifically:</span></span>

-   <span data-ttu-id="c39a1-186">Es fácil para un desarrollador entender y empezar a trabajar rápidamente con buena productividad.</span><span class="sxs-lookup"><span data-stu-id="c39a1-186">It is easy for a developer to understand and get started quickly with good productivity.</span></span>

-   <span data-ttu-id="c39a1-187">Contenedores de inicio rápido, lo que permite a los desarrolladores más productivo.</span><span class="sxs-lookup"><span data-stu-id="c39a1-187">Containers start fast, which makes developers more productive.</span></span>

-   <span data-ttu-id="c39a1-188">Un IDE como Visual Studio puede cargar proyectos más pequeños con más rapidez, aumentando la productividad de los desarrolladores.</span><span class="sxs-lookup"><span data-stu-id="c39a1-188">An IDE like Visual Studio can load smaller projects fast, making developers productive.</span></span>

-   <span data-ttu-id="c39a1-189">Cada microservicio puede diseñado, desarrollarse e implementarse independientemente de otros microservicios, que proporciona agilidad porque es más fácil de implementar nuevas versiones de microservicios con frecuencia.</span><span class="sxs-lookup"><span data-stu-id="c39a1-189">Each microservice can be designed, developed, and deployed independently of other microservices, which provides agility because it is easier to deploy new versions of microservices frequently.</span></span>

<span data-ttu-id="c39a1-190">**Es posible escalar horizontalmente áreas individuales de la aplicación**.</span><span class="sxs-lookup"><span data-stu-id="c39a1-190">**It is possible to scale out individual areas of the application**.</span></span> <span data-ttu-id="c39a1-191">Por ejemplo, el servicio de catálogo o el servicio de la cesta de compras deba ser escalado, pero no el proceso de pedido.</span><span class="sxs-lookup"><span data-stu-id="c39a1-191">For instance, the catalog service or the basket service might need to be scaled out, but not the ordering process.</span></span> <span data-ttu-id="c39a1-192">Una infraestructura de microservicios será mucho más eficaz con respecto a los recursos que usa mientras se escala horizontalmente, lo que sería una arquitectura monolítica.</span><span class="sxs-lookup"><span data-stu-id="c39a1-192">A microservices infrastructure will be much more efficient with regard to the resources used when scaling out than a monolithic architecture would be.</span></span>

<span data-ttu-id="c39a1-193">**Puede dividir el trabajo entre varios equipos de desarrollo**.</span><span class="sxs-lookup"><span data-stu-id="c39a1-193">**You can divide the development work between multiple teams**.</span></span> <span data-ttu-id="c39a1-194">Cada servicio puede ser propiedad de un equipo de desarrollo único.</span><span class="sxs-lookup"><span data-stu-id="c39a1-194">Each service can be owned by a single development team.</span></span> <span data-ttu-id="c39a1-195">Cada equipo puede administrar, desarrollar, implementar y escalar su servicio, independientemente del resto de los equipos.</span><span class="sxs-lookup"><span data-stu-id="c39a1-195">Each team can manage, develop, deploy, and scale their service independently of the rest of the teams.</span></span>

<span data-ttu-id="c39a1-196">**Problemas son más aislados**.</span><span class="sxs-lookup"><span data-stu-id="c39a1-196">**Issues are more isolated**.</span></span> <span data-ttu-id="c39a1-197">Si hay un problema en un servicio, solo a ese servicio inicialmente se ve afectado (excepto cuando se usa el diseño incorrecto con dependencias directas entre microservicios) y pueden continuar con otros servicios controlar las solicitudes.</span><span class="sxs-lookup"><span data-stu-id="c39a1-197">If there is an issue in one service, only that service is initially impacted (except when the wrong design is used, with direct dependencies between microservices), and other services can continue to handle requests.</span></span> <span data-ttu-id="c39a1-198">En cambio, un componente en mal estado en una arquitectura de implementación monolítico puede aportar hacia abajo todo el sistema, especialmente al implica recursos, como una pérdida de memoria.</span><span class="sxs-lookup"><span data-stu-id="c39a1-198">In contrast, one malfunctioning component in a monolithic deployment architecture can bring down the entire system, especially when it involves resources, such as a memory leak.</span></span> <span data-ttu-id="c39a1-199">Además, cuando se ha resuelto un problema en un microservicio, puede implementar simplemente la microservicio afectado sin influir en el resto de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c39a1-199">Additionally, when an issue in a microservice is resolved, you can deploy just the affected microservice without impacting the rest of the application.</span></span>

<span data-ttu-id="c39a1-200">**Puede utilizar las tecnologías más recientes**.</span><span class="sxs-lookup"><span data-stu-id="c39a1-200">**You can use the latest technologies**.</span></span> <span data-ttu-id="c39a1-201">Ya puede empezar a desarrollar servicios de forma independiente y ejecutarlas en paralelo (gracias a contenedores y .NET Core), puede comenzar a usar las últimas tecnologías y marcos de trabajo de forma oportuna en lugar de quedarse atascado en una pila o marco de trabajo para el conjunto anterior aplicación.</span><span class="sxs-lookup"><span data-stu-id="c39a1-201">Because you can start developing services independently and run them side by side (thanks to containers and .NET Core), you can start using the latest technologies and frameworks expediently instead of being stuck on an older stack or framework for the whole application.</span></span>

## <a name="downsides-of-a-microservice-based-solution"></a><span data-ttu-id="c39a1-202">Desventajas de una solución basada en microservicio</span><span class="sxs-lookup"><span data-stu-id="c39a1-202">Downsides of a microservice-based solution</span></span>

<span data-ttu-id="c39a1-203">Una solución de microservicio según así también tiene algunas desventajas:</span><span class="sxs-lookup"><span data-stu-id="c39a1-203">A microservice based solution like this also has some drawbacks:</span></span>

<span data-ttu-id="c39a1-204">**Aplicación distribuida**.</span><span class="sxs-lookup"><span data-stu-id="c39a1-204">**Distributed application**.</span></span> <span data-ttu-id="c39a1-205">Distribuir la aplicación, agrega una complejidad para los desarrolladores cuando se diseñar y crear los servicios.</span><span class="sxs-lookup"><span data-stu-id="c39a1-205">Distributing the application adds complexity for developers when they are designing and building the services.</span></span> <span data-ttu-id="c39a1-206">Por ejemplo, los programadores deben implementar interservicios comunicación mediante protocolos como HTTP o AMPQ, que agrega complejidad para las pruebas y control de excepciones.</span><span class="sxs-lookup"><span data-stu-id="c39a1-206">For example, developers must implement interservice communication using protocols like HTTP or AMPQ, which adds complexity for testing and exception handling.</span></span> <span data-ttu-id="c39a1-207">También agrega latencia en el sistema.</span><span class="sxs-lookup"><span data-stu-id="c39a1-207">It also adds latency to the system.</span></span>

<span data-ttu-id="c39a1-208">**Complejidad de la implementación**.</span><span class="sxs-lookup"><span data-stu-id="c39a1-208">**Deployment complexity**.</span></span> <span data-ttu-id="c39a1-209">Una aplicación que tiene docenas de tipos de microservicios y que necesitan alta escalabilidad (debe ser capaz de crear varias instancias por cada servicio y el equilibrio de dichos servicios a través de varios hosts) significa un alto grado de complejidad de la implementación para la administración y operaciones de TI.</span><span class="sxs-lookup"><span data-stu-id="c39a1-209">An application that has dozens of microservices types and needs high scalability (it needs to be able to create many instances per service and balance those services across many hosts) means a high degree of deployment complexity for IT operations and management.</span></span> <span data-ttu-id="c39a1-210">Si no se usa una infraestructura orientada a servicios de microservicio (por ejemplo, un orchestrator y programador), que la complejidad adicional puede requerir mucho más los esfuerzos de desarrollo de la propia aplicación de negocios.</span><span class="sxs-lookup"><span data-stu-id="c39a1-210">If you are not using a microservice-oriented infrastructure (like an orchestrator and scheduler), that additional complexity can require far more development efforts than the business application itself.</span></span>

<span data-ttu-id="c39a1-211">**Las transacciones atómicas**.</span><span class="sxs-lookup"><span data-stu-id="c39a1-211">**Atomic transactions**.</span></span> <span data-ttu-id="c39a1-212">Las transacciones atómicas entre varios microservicios normalmente no son posibles.</span><span class="sxs-lookup"><span data-stu-id="c39a1-212">Atomic transactions between multiple microservices usually are not possible.</span></span> <span data-ttu-id="c39a1-213">Los requisitos empresariales deben adoptar coherencia definitiva entre varios microservicios.</span><span class="sxs-lookup"><span data-stu-id="c39a1-213">The business requirements have to embrace eventual consistency between multiple microservices.</span></span>

<span data-ttu-id="c39a1-214">**Aumentar los recursos globales que se necesitan** (total de memoria, las unidades y recursos de red para todos los hosts o servidores).</span><span class="sxs-lookup"><span data-stu-id="c39a1-214">**Increased global resource needs** (total memory, drives, and network resources for all the servers or hosts).</span></span> <span data-ttu-id="c39a1-215">En muchos casos, al reemplazar una aplicación monolítica con un enfoque microservicios, la cantidad de recursos globales necesaria para la nueva aplicación basada en microservicio será mayor que las necesidades de infraestructura de la aplicación monolítica original.</span><span class="sxs-lookup"><span data-stu-id="c39a1-215">In many cases, when you replace a monolithic application with a microservices approach, the amount of global resources needed by the new microservice-based application will be larger than the infrastructure needs of the original monolithic application.</span></span> <span data-ttu-id="c39a1-216">Esto es porque el mayor grado de granularidad y servicios distribuidos requiere recursos de índole más globales.</span><span class="sxs-lookup"><span data-stu-id="c39a1-216">This is because the higher degree of granularity and distributed services requires more global resources.</span></span> <span data-ttu-id="c39a1-217">Sin embargo, dado el bajo costo de recursos en general y la ventaja de poder escalar horizontalmente solo determinadas áreas de la aplicación en comparación con los costos a largo plazo de hora de desarrollar aplicaciones monolíticas, el aumento del uso de recursos es normalmente un buen equilibrio para grandes, aplicaciones a largo plazo.</span><span class="sxs-lookup"><span data-stu-id="c39a1-217">However, given the low cost of resources in general and the benefit of being able to scale out just certain areas of the application compared to long-term costs when evolving monolithic applications, the increased use of resources is usually a good tradeoff for large, long-term applications.</span></span>

<span data-ttu-id="c39a1-218">**Problemas de comunicación directa client‑to‑microservice**.</span><span class="sxs-lookup"><span data-stu-id="c39a1-218">**Issues with direct client‑to‑microservice communication**.</span></span> <span data-ttu-id="c39a1-219">Cuando la aplicación es grande, con docenas de microservicios, hay problemas y limitaciones si la aplicación requiere las comunicaciones de cliente a microservicio directa.</span><span class="sxs-lookup"><span data-stu-id="c39a1-219">When the application is large, with dozens of microservices, there are challenges and limitations if the application requires direct client-to-microservice communications.</span></span> <span data-ttu-id="c39a1-220">Un problema es un error de coincidencia potencial entre las necesidades del cliente y las API expuestas por cada uno de los microservicios.</span><span class="sxs-lookup"><span data-stu-id="c39a1-220">One problem is a potential mismatch between the needs of the client and the APIs exposed by each of the microservices.</span></span> <span data-ttu-id="c39a1-221">En algunos casos, la aplicación cliente deba hacer varias solicitudes independientes para crear la interfaz de usuario, que puede ser ineficaz a través de Internet y pueden resultar poco a través de una red móvil.</span><span class="sxs-lookup"><span data-stu-id="c39a1-221">In certain cases, the client application might need to make many separate requests to compose the UI, which can be inefficient over the Internet and would be impractical over a mobile network.</span></span> <span data-ttu-id="c39a1-222">Por lo tanto, se deben minimizar las solicitudes de la aplicación cliente para el sistema back-end.</span><span class="sxs-lookup"><span data-stu-id="c39a1-222">Therefore, requests from the client application to the back-end system should be minimized.</span></span>

<span data-ttu-id="c39a1-223">Otro problema con las comunicaciones de cliente a microservicio directa es que algunos microservicios pueden estar usando los protocolos que no son aptos para la Web.</span><span class="sxs-lookup"><span data-stu-id="c39a1-223">Another problem with direct client-to-microservice communications is that some microservices might be using protocols that are not Web-friendly.</span></span> <span data-ttu-id="c39a1-224">Un servicio puede usar un protocolo binario, mientras que otro servicio puede utilizar mensajería de AMQP.</span><span class="sxs-lookup"><span data-stu-id="c39a1-224">One service might use a binary protocol, while another service might use AMQP messaging.</span></span> <span data-ttu-id="c39a1-225">Estos protocolos no son firewall‑friendly y son útiles internamente.</span><span class="sxs-lookup"><span data-stu-id="c39a1-225">Those protocols are not firewall‑friendly and are best used internally.</span></span> <span data-ttu-id="c39a1-226">Normalmente, una aplicación debe utilizar protocolos como HTTP y WebSockets para la comunicación fuera del firewall.</span><span class="sxs-lookup"><span data-stu-id="c39a1-226">Usually, an application should use protocols such as HTTP and WebSockets for communication outside of the firewall.</span></span>

<span data-ttu-id="c39a1-227">Todavía otra desventaja con este enfoque client‑to‑service directa es que resulta difícil refactorizar los contratos para los microservicios.</span><span class="sxs-lookup"><span data-stu-id="c39a1-227">Yet another drawback with this direct client‑to‑service approach is that it makes it difficult to refactor the contracts for those microservices.</span></span> <span data-ttu-id="c39a1-228">Con el tiempo a los desarrolladores posible que desee cambiar la forma en que el sistema se divide en servicios.</span><span class="sxs-lookup"><span data-stu-id="c39a1-228">Over time developers might want to change how the system is partitioned into services.</span></span> <span data-ttu-id="c39a1-229">Por ejemplo, puede combinar los dos servicios o dividir un servicio en dos o más servicios.</span><span class="sxs-lookup"><span data-stu-id="c39a1-229">For example, they might merge two services or split a service into two or more services.</span></span> <span data-ttu-id="c39a1-230">Sin embargo, si los clientes se comunican directamente con los servicios, realizar este tipo de refactorización puede interrumpir la compatibilidad con aplicaciones de cliente.</span><span class="sxs-lookup"><span data-stu-id="c39a1-230">However, if clients communicate directly with the services, performing this kind of refactoring can break compatibility with client apps.</span></span>

<span data-ttu-id="c39a1-231">Como se mencionó en la sección de arquitectura, al diseñar y crear una aplicación compleja basada en microservicios, considere el uso de varias las puertas de enlace de API específica en lugar de al enfoque más sencillo de comunicación directa client‑to‑microservice.</span><span class="sxs-lookup"><span data-stu-id="c39a1-231">As mentioned in the architecture section, when designing and building a complex application based on microservices, you might consider the use of multiple fine-grained API Gateways instead of the simpler direct client‑to‑microservice communication approach.</span></span>

<span data-ttu-id="c39a1-232">**Creación de particiones de la microservicios**.</span><span class="sxs-lookup"><span data-stu-id="c39a1-232">**Partitioning the microservices**.</span></span> <span data-ttu-id="c39a1-233">Por último, independientemente del método que seguir para que la arquitectura de microservicio, otro desafío consiste en decidir cómo dividir una aplicación to-end en varios microservicios.</span><span class="sxs-lookup"><span data-stu-id="c39a1-233">Finally, no matter which approach you take for your microservice architecture, another challenge is deciding how to partition an end-to-end application into multiple microservices.</span></span> <span data-ttu-id="c39a1-234">Como se indicó en la sección de la arquitectura de la guía, hay varias técnicas y enfoques que puede realizar.</span><span class="sxs-lookup"><span data-stu-id="c39a1-234">As noted in the architecture section of the guide, there are several techniques and approaches you can take.</span></span> <span data-ttu-id="c39a1-235">Básicamente, debe identificar las áreas de la aplicación que se separa de las demás áreas y que tienen un número reducido de dependencias.</span><span class="sxs-lookup"><span data-stu-id="c39a1-235">Basically, you need to identify areas of the application that are decoupled from the other areas and that have a low number of hard dependencies.</span></span> <span data-ttu-id="c39a1-236">En muchos casos, esto se alinea los servicios de creación de particiones por caso de uso.</span><span class="sxs-lookup"><span data-stu-id="c39a1-236">In many cases, this is aligned to partitioning services by use case.</span></span> <span data-ttu-id="c39a1-237">Por ejemplo, en nuestra aplicación e shop, tenemos un servicio de ordenación que se encarga de toda la lógica de negocios relacionados con el proceso de pedido.</span><span class="sxs-lookup"><span data-stu-id="c39a1-237">For example, in our e-shop application, we have an ordering service that is responsible for all the business logic related to the order process.</span></span> <span data-ttu-id="c39a1-238">También tenemos el servicio del catálogo y el servicio de la cesta de compras que implementan otras capacidades.</span><span class="sxs-lookup"><span data-stu-id="c39a1-238">We also have the catalog service and the basket service that implement other capabilities.</span></span> <span data-ttu-id="c39a1-239">Idealmente, cada servicio debe tener solo un pequeño conjunto de responsabilidades.</span><span class="sxs-lookup"><span data-stu-id="c39a1-239">Ideally, each service should have only a small set of responsibilities.</span></span> <span data-ttu-id="c39a1-240">Esto es similar al principio de responsabilidad única (SRP) aplicado a las clases, que indica que una clase debe tener sólo un motivo para cambiarlo.</span><span class="sxs-lookup"><span data-stu-id="c39a1-240">This is similar to the single responsibility principle (SRP) applied to classes, which states that a class should only have one reason to change.</span></span> <span data-ttu-id="c39a1-241">Pero en este caso, trata microservicios, por lo que el ámbito será mayor que una sola clase.</span><span class="sxs-lookup"><span data-stu-id="c39a1-241">But in this case, it is about microservices, so the scope will be larger than a single class.</span></span> <span data-ttu-id="c39a1-242">Más de todo un microservicio tiene que ser completamente autónomo, de principio a fin, incluida la responsabilidad de sus propios orígenes de datos.</span><span class="sxs-lookup"><span data-stu-id="c39a1-242">Most of all, a microservice has to be completely autonomous, end to end, including responsibility for its own data sources.</span></span>

## <a name="external-versus-internal-architecture-and-design-patterns"></a><span data-ttu-id="c39a1-243">Externa frente a los patrones de arquitectura y el diseño internos</span><span class="sxs-lookup"><span data-stu-id="c39a1-243">External versus internal architecture and design patterns</span></span>

<span data-ttu-id="c39a1-244">La arquitectura externa es la arquitectura de microservicio compuesta por varios servicios, siguiendo los principios descritos en la sección de la arquitectura de esta guía.</span><span class="sxs-lookup"><span data-stu-id="c39a1-244">The external architecture is the microservice architecture composed by multiple service, following the principles described in the architecture section of this guide.</span></span> <span data-ttu-id="c39a1-245">Sin embargo, según la naturaleza de cada microservicio e independiente de la arquitectura de alto nivel microservicio que elija, es común y a veces es aconsejable tener distintas arquitecturas internas, basados en patrones diferentes, para diferentes microservicios.</span><span class="sxs-lookup"><span data-stu-id="c39a1-245">However, depending on the nature of each microservice, and independently of high-level microservice architecture you choose, it is common and sometimes advisable to have different internal architectures, each based on different patterns, for different microservices.</span></span> <span data-ttu-id="c39a1-246">Incluso pueden utilizar el microservicios diversas tecnologías y lenguajes de programación.</span><span class="sxs-lookup"><span data-stu-id="c39a1-246">The microservices can even use different technologies and programming languages.</span></span> <span data-ttu-id="c39a1-247">Figura 8-2 muestra esta diversidad.</span><span class="sxs-lookup"><span data-stu-id="c39a1-247">Figure 8-2 illustrates this diversity.</span></span>

![](./media/image2.png)

<span data-ttu-id="c39a1-248">**Figura 8-2**.</span><span class="sxs-lookup"><span data-stu-id="c39a1-248">**Figure 8-2**.</span></span> <span data-ttu-id="c39a1-249">Externa frente a la arquitectura interna y diseño</span><span class="sxs-lookup"><span data-stu-id="c39a1-249">External versus internal architecture and design</span></span>

<span data-ttu-id="c39a1-250">Por ejemplo, en nuestro *eShopOnContainers* microservicios de perfil de ejemplo, el catálogo, la cesta de compras y usuario son simples (básicamente, los subsistemas de CRUD).</span><span class="sxs-lookup"><span data-stu-id="c39a1-250">For instance, in our *eShopOnContainers* sample, the catalog, basket, and user profile microservices are simple (basically, CRUD subsystems).</span></span> <span data-ttu-id="c39a1-251">Por lo tanto, su arquitectura interna y el diseño es sencillo.</span><span class="sxs-lookup"><span data-stu-id="c39a1-251">Therefore, their internal architecture and design is straightforward.</span></span> <span data-ttu-id="c39a1-252">Sin embargo, puede que tenga otros microservicios, como la ordenación microservicio, que es más complejo y representa las reglas de negocios cambiantes con un alto grado de complejidad del dominio.</span><span class="sxs-lookup"><span data-stu-id="c39a1-252">However, you might have other microservices, such as the ordering microservice, which is more complex and represents ever-changing business rules with a high degree of domain complexity.</span></span> <span data-ttu-id="c39a1-253">En estos casos, puede implementar modelos más avanzados dentro de un microservicio determinado, como las que se define con los enfoques de diseño basado en dominio (DDD), como se hace el *eShopOnContainers* orden microservicio.</span><span class="sxs-lookup"><span data-stu-id="c39a1-253">In cases like these, you might want to implement more advanced patterns within a particular microservice, like the ones defined with domain-driven design (DDD) approaches, as we are doing in the *eShopOnContainers* ordering microservice.</span></span> <span data-ttu-id="c39a1-254">(Se tratarán estos patrones DDD más adelante la sección que explica la implementación de la *eShopOnContainers* ordenación microservicio.)</span><span class="sxs-lookup"><span data-stu-id="c39a1-254">(We will review these DDD patterns in the section later that explains the implementation of the *eShopOnContainers* ordering microservice.)</span></span>

<span data-ttu-id="c39a1-255">Otra razón para una tecnología distinta por microservicio podría ser la naturaleza de cada microservicio.</span><span class="sxs-lookup"><span data-stu-id="c39a1-255">Another reason for a different technology per microservice might be the nature of each microservice.</span></span> <span data-ttu-id="c39a1-256">Por ejemplo, podría ser mejor usar un lenguaje de programación funcional como F\#, o incluso un lenguaje como R si desea usar AI y dominios, en lugar de un lenguaje de programación más orientada a objetos como C de aprendizaje automático\#.</span><span class="sxs-lookup"><span data-stu-id="c39a1-256">For example, it might be better to use a functional programming language like F\#, or even a language like R if you are targeting AI and machine learning domains, instead of a more object-oriented programming language like C\#.</span></span>

<span data-ttu-id="c39a1-257">La conclusión es que cada microservicio puede tener una arquitectura interna diferente basándose en patrones de diseño diferentes.</span><span class="sxs-lookup"><span data-stu-id="c39a1-257">The bottom line is that each microservice can have a different internal architecture based on different design patterns.</span></span> <span data-ttu-id="c39a1-258">Microservicios no todas las deben implementarse mediante patrones DDD avanzados, ya podría ser excesiva de ingeniería ellos.</span><span class="sxs-lookup"><span data-stu-id="c39a1-258">Not all microservices should be implemented using advanced DDD patterns, because that would be over-engineering them.</span></span> <span data-ttu-id="c39a1-259">Del mismo modo, no deberían implementarse microservicios complejos con lógica de negocios cambiante como componentes CRUD o puede acabar con código de baja calidad.</span><span class="sxs-lookup"><span data-stu-id="c39a1-259">Similarly, complex microservices with ever-changing business logic should not be implemented as CRUD components, or you can end up with low-quality code.</span></span>



## <a name="the-new-world-multiple-architectural-patterns-and-polyglot-microservices"></a><span data-ttu-id="c39a1-260">El nuevo mundo: varios modelos arquitectónicos y microservicios polyglot</span><span class="sxs-lookup"><span data-stu-id="c39a1-260">The new world: multiple architectural patterns and polyglot microservices</span></span>

<span data-ttu-id="c39a1-261">Hay muchos patrones arquitectónicos utilizados por los programadores y arquitectos de software.</span><span class="sxs-lookup"><span data-stu-id="c39a1-261">There are many architectural patterns used by software architects and developers.</span></span> <span data-ttu-id="c39a1-262">Los siguientes son algunos (combinación de estilos de arquitectura y patrones de arquitectura):</span><span class="sxs-lookup"><span data-stu-id="c39a1-262">The following are a few (mixing architecture styles and architecture patterns):</span></span>

-   <span data-ttu-id="c39a1-263">Simple CRUD, nivel único, una capa.</span><span class="sxs-lookup"><span data-stu-id="c39a1-263">Simple CRUD, single-tier, single-layer.</span></span>

-   <span data-ttu-id="c39a1-264">[Tradicional N capas](https://msdn.microsoft.com/en-us/library/ee658109.aspx#Layers).</span><span class="sxs-lookup"><span data-stu-id="c39a1-264">[Traditional N-Layered](https://msdn.microsoft.com/en-us/library/ee658109.aspx#Layers).</span></span>

-   <span data-ttu-id="c39a1-265">[Dominio controlada por diseño en capas N](https://blogs.msdn.microsoft.com/cesardelatorre/2011/07/03/published-first-alpha-version-of-domain-oriented-n-layered-architecture-v2-0/).</span><span class="sxs-lookup"><span data-stu-id="c39a1-265">[Domain-Driven Design N-layered](https://blogs.msdn.microsoft.com/cesardelatorre/2011/07/03/published-first-alpha-version-of-domain-oriented-n-layered-architecture-v2-0/).</span></span>

-   <span data-ttu-id="c39a1-266">[Limpiar arquitectura](https://8thlight.com/blog/uncle-bob/2012/08/13/the-clean-architecture.html) (como se utiliza con [eShopOnWeb](http://aka.ms/WebAppArchitecture))</span><span class="sxs-lookup"><span data-stu-id="c39a1-266">[Clean Architecture](https://8thlight.com/blog/uncle-bob/2012/08/13/the-clean-architecture.html) (as used with [eShopOnWeb](http://aka.ms/WebAppArchitecture))</span></span>

-   <span data-ttu-id="c39a1-267">[Comando y consultar la segregación de responsabilidad](https://martinfowler.com/bliki/CQRS.html) (CQRS).</span><span class="sxs-lookup"><span data-stu-id="c39a1-267">[Command and Query Responsibility Segregation](https://martinfowler.com/bliki/CQRS.html) (CQRS).</span></span>

-   <span data-ttu-id="c39a1-268">[Arquitectura controlada por eventos](https://en.wikipedia.org/wiki/Event-driven_architecture) (EDA).</span><span class="sxs-lookup"><span data-stu-id="c39a1-268">[Event-Driven Architecture](https://en.wikipedia.org/wiki/Event-driven_architecture) (EDA).</span></span>

<span data-ttu-id="c39a1-269">También puede compilar microservicios con muchas tecnologías y lenguajes, como las API Web de ASP.NET Core, NancyFx, ASP.NET Core SignalR (disponible con .NET Core 2), F\#, Node.js, Python, Java, C++, GoLang y mucho más.</span><span class="sxs-lookup"><span data-stu-id="c39a1-269">You can also build microservices with many technologies and languages, such as ASP.NET Core Web APIs, NancyFx, ASP.NET Core SignalR (available with .NET Core 2), F\#, Node.js, Python, Java, C++, GoLang, and more.</span></span>

<span data-ttu-id="c39a1-270">Lo importante es que ningún patrón de arquitectura determinada o estilo ni cualquier tecnología en particular, es adecuado para todas las situaciones.</span><span class="sxs-lookup"><span data-stu-id="c39a1-270">The important point is that no particular architecture pattern or style, nor any particular technology, is right for all situations.</span></span> <span data-ttu-id="c39a1-271">Figura 8-3 muestra algunos enfoques y las tecnologías (aunque no en ningún orden concreto) que podía utilizarse en microservicios diferentes.</span><span class="sxs-lookup"><span data-stu-id="c39a1-271">Figure 8-3 shows some approaches and technologies (although not in any particular order) that could be used in different microservices.</span></span>

![](./media/image3.png)

<span data-ttu-id="c39a1-272">**Figura 8-3**.</span><span class="sxs-lookup"><span data-stu-id="c39a1-272">**Figure 8-3**.</span></span> <span data-ttu-id="c39a1-273">Los patrones arquitectónicos múltiple y el mundo microservicios polyglot</span><span class="sxs-lookup"><span data-stu-id="c39a1-273">Multi-architectural patterns and the polyglot microservices world</span></span>

<span data-ttu-id="c39a1-274">Como se muestra en figura 8-3, en aplicaciones formada por muchas microservicios (limitado contextos en terminología de diseño basado en dominio, o simplemente "subsistemas" como microservicios autónomo), podría implementar cada microservicio de forma diferente.</span><span class="sxs-lookup"><span data-stu-id="c39a1-274">As shown in Figure 8-3, in applications composed of many microservices (Bounded Contexts in domain-driven design terminology, or simply “subsystems” as autonomous microservices), you might implement each microservice in a different way.</span></span> <span data-ttu-id="c39a1-275">Cada uno de ellos podría cuentan con un patrón de arquitectura diferente y usar distintos idiomas y las bases de datos según la naturaleza de la aplicación, los requisitos empresariales y prioridades.</span><span class="sxs-lookup"><span data-stu-id="c39a1-275">Each might have a different architecture pattern and use different languages and databases depending on the application’s nature, business requirements, and priorities.</span></span> <span data-ttu-id="c39a1-276">En algunos casos el microservicios podrían ser similar.</span><span class="sxs-lookup"><span data-stu-id="c39a1-276">In some cases the microservices might be similar.</span></span> <span data-ttu-id="c39a1-277">Pero que no es normalmente el caso, porque el límite del contexto y los requisitos de cada subsistema normalmente son diferentes.</span><span class="sxs-lookup"><span data-stu-id="c39a1-277">But that is not usually the case, because each subsystem’s context boundary and requirements are usually different.</span></span>

<span data-ttu-id="c39a1-278">Por ejemplo, para una aplicación de mantenimiento CRUD simple, no podría no sentido diseñar e implementar patrones DDD.</span><span class="sxs-lookup"><span data-stu-id="c39a1-278">For instance, for a simple CRUD maintenance application, it might not make sense to design and implement DDD patterns.</span></span> <span data-ttu-id="c39a1-279">Pero para el dominio principal o el negocio principal, es posible que deba aplicar patrones más avanzadas para abordar la complejidad de negocio con reglas de negocios cambiantes.</span><span class="sxs-lookup"><span data-stu-id="c39a1-279">But for your core domain or core business, you might need to apply more advanced patterns to tackle business complexity with ever-changing business rules.</span></span>

<span data-ttu-id="c39a1-280">Especialmente cuando se trabaja con aplicaciones de gran tamaño compuestas por varios subsistemas, no se debe aplicar una única arquitectura de nivel superior en función de un modelo de arquitectura de inicio único.</span><span class="sxs-lookup"><span data-stu-id="c39a1-280">Especially when you deal with large applications composed by multiple sub-systems, you should not apply a single top-level architecture based on a single architecture pattern.</span></span> <span data-ttu-id="c39a1-281">Por ejemplo, CQRS no se debe aplicar como una arquitectura de nivel superior para una aplicación completa, pero podría ser útil para un conjunto específico de servicios.</span><span class="sxs-lookup"><span data-stu-id="c39a1-281">For instance, CQRS should not be applied as a top-level architecture for a whole application, but might be useful for a specific set of services.</span></span>

<span data-ttu-id="c39a1-282">No hay ninguna solución mágica o un patrón de arquitectura correcta para cada caso especificado.</span><span class="sxs-lookup"><span data-stu-id="c39a1-282">There is no silver bullet or a right architecture pattern for every given case.</span></span> <span data-ttu-id="c39a1-283">No puede tener "un patrón de arquitectura descarte todos ellos."</span><span class="sxs-lookup"><span data-stu-id="c39a1-283">You cannot have “one architecture pattern to rule them all.”</span></span> <span data-ttu-id="c39a1-284">Dependiendo de las prioridades de cada microservicio, debe elegir un enfoque diferente para cada uno, como se explica en las secciones siguientes.</span><span class="sxs-lookup"><span data-stu-id="c39a1-284">Depending on the priorities of each microservice, you must choose a different approach for each, as explained in the following sections.</span></span>


>[!div class="step-by-step"]
<span data-ttu-id="c39a1-285">[Anterior] (index.md) [siguiente] (datos-controlada por-crud-microservice.md)</span><span class="sxs-lookup"><span data-stu-id="c39a1-285">[Previous] (index.md) [Next] (data-driven-crud-microservice.md)</span></span>
