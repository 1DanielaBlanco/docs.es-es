---
title: Flujo de trabajo de desarrollo para aplicaciones de Docker
description: Arquitectura de Microservicios de .NET para aplicaciones .NET en contenedores | Flujo de trabajo de desarrollo para aplicaciones de Docker
keywords: Docker, microservicios, ASP.NET, contenedor
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 10/18/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.topic: article
ms.openlocfilehash: 5a53aee4261a5a0bfc25b3520c50cf505b84f287
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 11/21/2017
---
# <a name="development-workflow-for-docker-apps"></a><span data-ttu-id="bc0c5-104">Flujo de trabajo de desarrollo para aplicaciones de Docker</span><span class="sxs-lookup"><span data-stu-id="bc0c5-104">Development workflow for Docker apps</span></span>

<span data-ttu-id="bc0c5-105">El ciclo de vida de desarrollo de aplicación se inicia en el equipo del desarrollador, donde el desarrollador de códigos de la aplicación utilizando el lenguaje que prefieran y comprueba de forma local.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-105">The application development lifecycle starts at each developer’s machine, where the developer codes the application using their preferred language and tests it locally.</span></span> <span data-ttu-id="bc0c5-106">Independientemente del lenguaje, marco de trabajo y la plataforma que elige el desarrollador, con este flujo de trabajo, el desarrollador es siempre desarrollar y probar contenedores de Docker, pero hacerlo localmente.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-106">No matter which language, framework, and platform the developer chooses, with this workflow, the developer is always developing and testing Docker containers, but doing so locally.</span></span>

<span data-ttu-id="bc0c5-107">Cada contenedor (una instancia de una imagen de Docker) incluye los siguientes componentes:</span><span class="sxs-lookup"><span data-stu-id="bc0c5-107">Each container (an instance of a Docker image) includes the following components:</span></span>

-   <span data-ttu-id="bc0c5-108">Una selección de sistema operativo (por ejemplo, una distribución de Linux, Windows Nano Server o Windows Server Core).</span><span class="sxs-lookup"><span data-stu-id="bc0c5-108">An operating system selection (for example, a Linux distribution, Windows Nano Server, or Windows Server Core).</span></span>

-   <span data-ttu-id="bc0c5-109">Archivos agregados por el programador (archivos binarios de aplicación, etcetera).</span><span class="sxs-lookup"><span data-stu-id="bc0c5-109">Files added by the developer (application binaries, etc.).</span></span>

-   <span data-ttu-id="bc0c5-110">Información de configuración (configuración de entorno y las dependencias).</span><span class="sxs-lookup"><span data-stu-id="bc0c5-110">Configuration information (environment settings and dependencies).</span></span>

## <a name="workflow-for-developing-docker-container-based-applications"></a><span data-ttu-id="bc0c5-111">Flujo de trabajo para desarrollar aplicaciones basadas en contenedor de Docker</span><span class="sxs-lookup"><span data-stu-id="bc0c5-111">Workflow for developing Docker container-based applications</span></span>

<span data-ttu-id="bc0c5-112">Esta sección se describe la *bucle interno* flujo de trabajo de desarrollo para aplicaciones basadas en contenedor de Docker.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-112">This section describes the *inner-loop* development workflow for Docker container-based applications.</span></span> <span data-ttu-id="bc0c5-113">El flujo de trabajo de bucle interna significa no está teniendo en cuenta el flujo de trabajo de DevOps más amplio y solo se centra en el trabajo de desarrollo realizado en el equipo del desarrollador.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-113">The inner-loop workflow means it is not taking into account the broader DevOps workflow and just focuses on the development work done on the developer’s computer.</span></span> <span data-ttu-id="bc0c5-114">Los pasos iniciales para configurar el entorno no se incluyen, ya que los que se realizan solo una vez.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-114">The initial steps to set up the environment are not included, since those are done only once.</span></span>

<span data-ttu-id="bc0c5-115">Una aplicación se compone de sus propios servicios, además de bibliotecas adicionales (dependencias).</span><span class="sxs-lookup"><span data-stu-id="bc0c5-115">An application is composed of your own services plus additional libraries (dependencies).</span></span> <span data-ttu-id="bc0c5-116">Éstos son los pasos básicos que normalmente utilizan al compilar una aplicación de Docker, como se muestra en la figura 5-1.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-116">The following are the basic steps you usually take when building a Docker application, as illustrated in Figure 5-1.</span></span>

![](./media/image1.png)

<span data-ttu-id="bc0c5-117">**Figura 5-1.**</span><span class="sxs-lookup"><span data-stu-id="bc0c5-117">**Figure 5-1.**</span></span> <span data-ttu-id="bc0c5-118">Flujo de trabajo de paso a paso para el desarrollo de aplicaciones en contenedores de Docker</span><span class="sxs-lookup"><span data-stu-id="bc0c5-118">Step-by-step workflow for developing Docker containerized apps</span></span>

<span data-ttu-id="bc0c5-119">En esta guía, se detalla todo este proceso y se explica cada paso importante centrándose en un entorno de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-119">In this guide, this whole process is detailed and every major step is explained by focusing on a Visual Studio environment.</span></span>

<span data-ttu-id="bc0c5-120">Cuando se usa un enfoque de desarrollo de editor/CLI (por ejemplo, código de Visual Studio más CLI de Docker en macOS o Windows), debe conocer cada paso, generalmente con más detalle que si está utilizando Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-120">When you are using an editor/CLI development approach (for example, Visual Studio Code plus Docker CLI on macOS or Windows), you need to know every step, generally in more detail than if you are using Visual Studio.</span></span> <span data-ttu-id="bc0c5-121">Para obtener más información acerca de cómo trabajar en un entorno de CLI, consulte el libro electrónico [ciclo de vida de aplicaciones en contenedores de Docker con Microsoft Platforms y herramientas](http://aka.ms/dockerlifecycleebook/).</span><span class="sxs-lookup"><span data-stu-id="bc0c5-121">For more details about working in a CLI environment, refer to the e-book [Containerized Docker Application lifecycle with Microsoft Platforms and Tools](http://aka.ms/dockerlifecycleebook/).</span></span>

<span data-ttu-id="bc0c5-122">Cuando se usa Visual Studio 2015 o Visual Studio de 2017, muchos de estos pasos se administran automáticamente, lo cual mejora considerablemente su productividad.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-122">When you are using Visual Studio 2015 or Visual Studio 2017, many of those steps are handled for you, which dramatically improves your productivity.</span></span> <span data-ttu-id="bc0c5-123">Esto es especialmente cierto cuando usa Visual Studio de 2017 y contenedor varias aplicaciones de destino.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-123">This is especially true when you are using Visual Studio 2017 and targeting multi-container applications.</span></span> <span data-ttu-id="bc0c5-124">Por ejemplo, con un solo clic, Visual Studio agrega el archivo Dockerfile y docker compose.yml a los proyectos con la configuración de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-124">For instance, with just one mouse click, Visual Studio adds the Dockerfile and docker-compose.yml file to your projects with the configuration for your application.</span></span> <span data-ttu-id="bc0c5-125">Al ejecutar la aplicación en Visual Studio, crea la imagen de Docker y se ejecuta la aplicación contenedora múltiples directamente en Docker; incluso permite depurar varios contenedores al mismo tiempo.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-125">When you run the application in Visual Studio, it builds the Docker image and runs the multi-container application directly in Docker; it even allows you to debug several containers at once.</span></span> <span data-ttu-id="bc0c5-126">Estas características aumentará la velocidad de desarrollo.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-126">These features will boost your development speed.</span></span>

<span data-ttu-id="bc0c5-127">Sin embargo, solo porque Visual Studio realiza estos pasos automática no significa que no es necesario saber lo que ocurre en debajo con Docker.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-127">However, just because Visual Studio makes those steps automatic does not mean that you do not need to know what is going on underneath with Docker.</span></span> <span data-ttu-id="bc0c5-128">Por lo tanto, en las indicaciones siguientes, se detalla cada paso.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-128">Therefore, in the guidance that follows, we detail every step.</span></span>

![](./media/image2.png)

## <a name="step-1-start-coding-and-create-your-initial-application-or-service-baseline"></a><span data-ttu-id="bc0c5-129">Paso 1.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-129">Step 1.</span></span> <span data-ttu-id="bc0c5-130">Comienza a escribir código y crear la aplicación inicial o la línea de base de servicio</span><span class="sxs-lookup"><span data-stu-id="bc0c5-130">Start coding and create your initial application or service baseline</span></span>

<span data-ttu-id="bc0c5-131">Desarrollar una aplicación de Docker es similar a la manera de que desarrollar una aplicación sin Docker.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-131">Developing a Docker application is similar to the way you develop an application without Docker.</span></span> <span data-ttu-id="bc0c5-132">La diferencia es que al desarrollar para Docker, va a implementar y probar su aplicación o servicios que se ejecutan dentro de los contenedores de Docker en su entorno local.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-132">The difference is that while developing for Docker, you are deploying and testing your application or services running within Docker containers in your local environment.</span></span> <span data-ttu-id="bc0c5-133">El contenedor puede ser un contenedor de Linux o un contenedor de Windows.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-133">The container can be either a Linux container or a Windows container.</span></span>

### <a name="set-up-your-local-environment-with-visual-studio"></a><span data-ttu-id="bc0c5-134">Configurar el entorno local con Visual Studio</span><span class="sxs-lookup"><span data-stu-id="bc0c5-134">Set up your local environment with Visual Studio</span></span>

<span data-ttu-id="bc0c5-135">Para comenzar, asegúrese de que tiene [Docker Community Edition (CE)](https://www.docker.com/community-edition) para Windows instalado, como se explica en las siguientes instrucciones:</span><span class="sxs-lookup"><span data-stu-id="bc0c5-135">To begin, make sure you have [Docker Community Edition (CE)](https://www.docker.com/community-edition) for Windows installed, as explained in the following instructions:</span></span>

[<span data-ttu-id="bc0c5-136">Introducción a Docker CE para Windows</span><span class="sxs-lookup"><span data-stu-id="bc0c5-136">Get started with Docker CE for Windows</span></span>](https://docs.docker.com/docker-for-windows/)

<span data-ttu-id="bc0c5-137">Además, necesitará Visual Studio de 2017 instalado.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-137">In addition, you will need Visual Studio 2017 installed.</span></span> <span data-ttu-id="bc0c5-138">Esto es preferible sobre Visual Studio 2015 con Visual Studio Tools para Docker complemento, porque Visual Studio de 2017 ha avanzado más compatibilidad con Docker, como compatibilidad para depurar contenedores.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-138">This is preferred over Visual Studio 2015 with the Visual Studio Tools for Docker add-in, because Visual Studio 2017 has more advanced support for Docker, like support for debugging containers.</span></span> <span data-ttu-id="bc0c5-139">2017 de Visual Studio incluye las herramientas de Docker si ha seleccionado la **.NET Core y Docker** carga de trabajo durante la instalación, tal como se muestra en la figura 5-2.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-139">Visual Studio 2017 includes the tooling for Docker if you selected the **.NET Core and Docker** workload during installation, as shown in Figure 5-2.</span></span>

![](./media/image3.png)

<span data-ttu-id="bc0c5-140">**Figura 5-2**.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-140">**Figure 5-2**.</span></span> <span data-ttu-id="bc0c5-141">Al seleccionar la **.NET Core y Docker** carga de trabajo durante la instalación de Visual Studio de 2017</span><span class="sxs-lookup"><span data-stu-id="bc0c5-141">Selecting the **.NET Core and Docker** workload during Visual Studio 2017 setup</span></span>

<span data-ttu-id="bc0c5-142">Puede comenzar a codificar la aplicación en .NET sin formato (normalmente en .NET Core si va a utilizar los contenedores) incluso antes de habilitar a Docker en la aplicación e implementar y probar en Docker.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-142">You can start coding your application in plain .NET (usually in .NET Core if you are planning to use containers) even before enabling Docker in your application and deploying and testing in Docker.</span></span> <span data-ttu-id="bc0c5-143">Sin embargo, se recomienda que empezar a trabajar en Docker tan pronto como sea posible, ya que será el entorno real y se pueden detectar los problemas tan pronto como sea posible.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-143">However, it is recommended that you start working on Docker as soon as possible, because that will be the real environment and any issues can be discovered as soon as possible.</span></span> <span data-ttu-id="bc0c5-144">Esto se recomienda porque Visual Studio resulta muy sencillo trabajar con Docker que casi parece transparente: el mejor ejemplo al depurar aplicaciones de contenedor múltiples desde Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-144">This is encouraged because Visual Studio makes it so easy to work with Docker that it almost feels transparent—the best example when debugging multi-container applications from Visual Studio.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="bc0c5-145">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="bc0c5-145">Additional resources</span></span>

-   <span data-ttu-id="bc0c5-146">**Introducción a Docker CE para Windows**
    [*https://docs.docker.com/docker-for-windows/*](https://docs.docker.com/docker-for-windows/)</span><span class="sxs-lookup"><span data-stu-id="bc0c5-146">**Get started with Docker CE for Windows**
[*https://docs.docker.com/docker-for-windows/*](https://docs.docker.com/docker-for-windows/)</span></span>

-   <span data-ttu-id="bc0c5-147">**Visual Studio de 2017**
    [*https://www.visualstudio.com/vs/visual-studio-2017/*](https://www.visualstudio.com/vs/visual-studio-2017/)</span><span class="sxs-lookup"><span data-stu-id="bc0c5-147">**Visual Studio 2017**
[*https://www.visualstudio.com/vs/visual-studio-2017/*](https://www.visualstudio.com/vs/visual-studio-2017/)</span></span>

![](./media/image4.png)

## <a name="step-2-create-a-dockerfile-related-to-an-existing-net-base-image"></a><span data-ttu-id="bc0c5-148">Paso 2.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-148">Step 2.</span></span> <span data-ttu-id="bc0c5-149">Cree un Dockerfile relacionados con una imagen base existente de .NET</span><span class="sxs-lookup"><span data-stu-id="bc0c5-149">Create a Dockerfile related to an existing .NET base image</span></span>

<span data-ttu-id="bc0c5-150">Necesita un Dockerfile para cada imagen personalizada que desee crear; También necesita un Dockerfile para cada contenedor para su implementación, tanto si implementa automáticamente en Visual Studio o manualmente mediante la CLI de Docker (ejecución de docker y docker-crear comandos).</span><span class="sxs-lookup"><span data-stu-id="bc0c5-150">You need a Dockerfile for each custom image you want to build; you also need a Dockerfile for each container to be deployed, whether you deploy automatically from Visual Studio or manually using the Docker CLI (docker run and docker-compose commands).</span></span> <span data-ttu-id="bc0c5-151">Si la aplicación contiene un único servicio personalizado, es necesario un Dockerfile único.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-151">If your application contains a single custom service, you need a single Dockerfile.</span></span> <span data-ttu-id="bc0c5-152">Si la aplicación contiene varios servicios (como en una arquitectura microservicios), necesita un Dockerfile para cada servicio.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-152">If your application contains multiple services (as in a microservices architecture), you need one Dockerfile for each service.</span></span>

<span data-ttu-id="bc0c5-153">El Dockerfile se coloca en la carpeta raíz de la aplicación o servicio.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-153">The Dockerfile is placed in the root folder of your application or service.</span></span> <span data-ttu-id="bc0c5-154">Contiene los comandos que indican cómo configurar y ejecutar la aplicación o servicio en un contenedor de Docker.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-154">It contains the commands that tell Docker how to set up and run your application or service in a container.</span></span> <span data-ttu-id="bc0c5-155">Manualmente, puede crear un archivo Dockerfile en el código y agregarlo al proyecto junto con sus dependencias de .NET.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-155">You can manually create a Dockerfile in code and add it to your project along with your .NET dependencies.</span></span>

<span data-ttu-id="bc0c5-156">En Visual Studio y sus herramientas de Docker, esta tarea requiere solo unos pocos clics del mouse.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-156">With Visual Studio and its tools for Docker, this task requires only a few mouse clicks.</span></span> <span data-ttu-id="bc0c5-157">Cuando crea un nuevo proyecto en Visual Studio de 2017, hay una opción denominada **compatibilidad con el contenedor habilitar (Docker)**, tal y como se muestra en la figura 5-3.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-157">When you create a new project in Visual Studio 2017, there is an option named **Enable Container (Docker) Support**, as shown in Figure 5-3.</span></span>

![](./media/image5.png)

<span data-ttu-id="bc0c5-158">**Figura 5-3**.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-158">**Figure 5-3**.</span></span> <span data-ttu-id="bc0c5-159">Habilitar la compatibilidad de Docker cuando se crea un nuevo proyecto en Visual Studio de 2017</span><span class="sxs-lookup"><span data-stu-id="bc0c5-159">Enabling Docker Support when creating a new project in Visual Studio 2017</span></span>

<span data-ttu-id="bc0c5-160">También puede habilitar la compatibilidad de Docker en un proyecto nuevo o existente haciendo clic en el archivo de proyecto en Visual Studio y seleccionando la opción **proyecto compatible con el complemento Docker**, tal y como se muestra en la figura 5-4.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-160">You can also enable Docker support on a new or existing project by right-clicking your project file in Visual Studio and selecting the option **Add-Docker Project Support**, as shown in Figure 5-4.</span></span>

![](./media/image6.png)

<span data-ttu-id="bc0c5-161">**Figura 5-4**.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-161">**Figure 5-4**.</span></span> <span data-ttu-id="bc0c5-162">Habilitar la compatibilidad de Docker en un proyecto existente de Visual Studio de 2017</span><span class="sxs-lookup"><span data-stu-id="bc0c5-162">Enabling Docker support in an existing Visual Studio 2017 project</span></span>

<span data-ttu-id="bc0c5-163">Esta acción en un proyecto (por ejemplo, una aplicación Web ASP.NET o servicio de API Web), agrega un archivo Dockerfile al proyecto con la configuración necesaria.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-163">This action on a project (like an ASP.NET Web application or Web API service) adds a Dockerfile to the project with the required configuration.</span></span> <span data-ttu-id="bc0c5-164">También se agrega un archivo de compose.yml de docker para la solución completa.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-164">It also adds a docker-compose.yml file for the whole solution.</span></span> <span data-ttu-id="bc0c5-165">En las siguientes secciones, se describe la información que se pasa a cada uno de esos archivos.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-165">In the following sections, we describe the information that goes into each of those files.</span></span> <span data-ttu-id="bc0c5-166">Visual Studio puede hacer este trabajo por usted, pero resulta útil para comprender qué implica un Dockerfile.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-166">Visual Studio can do this work for you, but it is useful to understand what goes into a Dockerfile.</span></span>

### <a name="option-a-creating-a-project-using-an-existing-official-net-docker-image"></a><span data-ttu-id="bc0c5-167">Opción A: crear un proyecto mediante una imagen de Docker .NET oficial existente</span><span class="sxs-lookup"><span data-stu-id="bc0c5-167">Option A: Creating a project using an existing official .NET Docker image</span></span>

<span data-ttu-id="bc0c5-168">Suele generar una imagen personalizada para el contenedor de encima de una imagen base que se puede obtener desde un repositorio oficial en el [Docker Hub](https://hub.docker.com/) registro.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-168">You usually build a custom image for your container on top of a base image you can get from an official repository at the [Docker Hub](https://hub.docker.com/) registry.</span></span> <span data-ttu-id="bc0c5-169">Eso es precisamente lo que sucede en segundo plano cuando se habilita la compatibilidad con Docker en Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-169">That is precisely what happens under the covers when you enable Docker support in Visual Studio.</span></span> <span data-ttu-id="bc0c5-170">El Dockerfile utilizará una imagen de aspnetcore existente.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-170">Your Dockerfile will use an existing aspnetcore image.</span></span>

<span data-ttu-id="bc0c5-171">Anteriormente se explica qué imágenes de Docker y repositorios puede usar, según el marco y el sistema operativo que ha elegido.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-171">Earlier we explained which Docker images and repos you can use, depending on the framework and OS you have chosen.</span></span> <span data-ttu-id="bc0c5-172">Por ejemplo, si desea usar ASP.NET Core (Linux o Windows), la imagen utilizada es microsoft / aspnetcore:2.0.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-172">For instance, if you want to use ASP.NET Core (Linux or Windows), the image to use is microsoft/aspnetcore:2.0.</span></span> <span data-ttu-id="bc0c5-173">Por lo tanto, debe especificar qué imagen de Docker base que se utilizará para el contenedor.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-173">Therefore, you just need to specify what base Docker image you will use for your container.</span></span> <span data-ttu-id="bc0c5-174">Hacerlo mediante la adición de microsoft / aspnetcore:2.0 en el Dockerfile.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-174">You do that by adding FROM microsoft/aspnetcore:2.0 to your Dockerfile.</span></span> <span data-ttu-id="bc0c5-175">Esto se realizará automáticamente por Visual Studio, pero si fuera a actualizar la versión, actualice este valor.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-175">This will be automatically performed by Visual Studio, but if you were to update the version, you update this value.</span></span>

<span data-ttu-id="bc0c5-176">El uso de un repositorio de imágenes .NET oficial de Docker Hub con un número de versión, se garantiza que las mismas características de lenguaje están disponibles en todos los equipos (incluido el desarrollo, pruebas y producción).</span><span class="sxs-lookup"><span data-stu-id="bc0c5-176">Using an official .NET image repository from Docker Hub with a version number ensures that the same language features are available on all machines (including development, testing, and production).</span></span>

<span data-ttu-id="bc0c5-177">En el ejemplo siguiente se muestra un ejemplo de Dockerfile para un contenedor de ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-177">The following example shows a sample Dockerfile for an ASP.NET Core container.</span></span>

```
FROM microsoft/aspnetcore:2.0
  
ARG source
  
WORKDIR /app
  
EXPOSE 80
  
COPY ${source:-obj/Docker/publish} .
  
ENTRYPOINT ["dotnet", " MySingleContainerWebApp.dll "]
```

<span data-ttu-id="bc0c5-178">En este caso, el contenedor se basa en la versión 2.0 de la imagen de Docker de núcleo de ASP.NET oficial (Multi-arch para Linux y Windows).</span><span class="sxs-lookup"><span data-stu-id="bc0c5-178">In this case, the container is based on version 2.0 of the official ASP.NET Core Docker image (multi-arch for Linux and Windows).</span></span> <span data-ttu-id="bc0c5-179">Esta es la configuración `FROM microsoft/aspnetcore:2.0`.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-179">This is the setting `FROM microsoft/aspnetcore:2.0`.</span></span> <span data-ttu-id="bc0c5-180">(Para obtener más información acerca de esta imagen base, vea la [imagen de Docker de ASP.NET Core](https://hub.docker.com/r/microsoft/aspnetcore/) página y la [imagen de Docker de .NET Core](https://hub.docker.com/r/microsoft/dotnet/) página.) En el Dockerfile, también debe indicar a Docker para que escuche en el puerto TCP que se va a usar en tiempo de ejecución (en este caso, el puerto 80, tal y como se configura con la opción de exponer).</span><span class="sxs-lookup"><span data-stu-id="bc0c5-180">(For further details about this base image, see the [ASP.NET Core Docker Image](https://hub.docker.com/r/microsoft/aspnetcore/) page and the [.NET Core Docker Image](https://hub.docker.com/r/microsoft/dotnet/) page.) In the Dockerfile, you also need to instruct Docker to listen on the TCP port you will use at runtime (in this case, port 80, as configured with the EXPOSE setting).</span></span>

<span data-ttu-id="bc0c5-181">Puede especificar opciones de configuración adicionales en el Dockerfile, dependiendo del lenguaje y framework que está utilizando.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-181">You can specify additional configuration settings in the Dockerfile, depending on the language and framework you are using.</span></span> <span data-ttu-id="bc0c5-182">Por ejemplo, la línea de punto de entrada con \["dotnet", "MySingleContainerWebApp.dll"\] indica Docker para ejecutar una aplicación .NET Core.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-182">For instance, the ENTRYPOINT line with \["dotnet", "MySingleContainerWebApp.dll"\] tells Docker to run a .NET Core application.</span></span> <span data-ttu-id="bc0c5-183">Si usas la CLI de núcleo de .NET (dotnet CLI) y el SDK para compilar y ejecutar la aplicación. NET, esta configuración sería diferente.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-183">If you are using the SDK and the .NET Core CLI (dotnet CLI) to build and run the .NET application, this setting would be different.</span></span> <span data-ttu-id="bc0c5-184">La conclusión es que la línea de punto de entrada y otros valores de configuración pueden variar según la plataforma y el idioma que elija para su aplicación.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-184">The bottom line is that the ENTRYPOINT line and other settings will be different depending on the language and platform you choose for your application.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="bc0c5-185">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="bc0c5-185">Additional resources</span></span>

-   <span data-ttu-id="bc0c5-186">**Creación de imágenes de Docker para las aplicaciones de .NET Core**
    [*https://docs.microsoft.com/dotnet/core/docker/building-net-docker-images*](https://docs.microsoft.com/dotnet/core/docker/building-net-docker-images)</span><span class="sxs-lookup"><span data-stu-id="bc0c5-186">**Building Docker Images for .NET Core Applications**
[*https://docs.microsoft.com/dotnet/core/docker/building-net-docker-images*](https://docs.microsoft.com/dotnet/core/docker/building-net-docker-images)</span></span>

-   <span data-ttu-id="bc0c5-187">**Crear su propia imagen**.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-187">**Build your own image**.</span></span> <span data-ttu-id="bc0c5-188">En la documentación oficial de Docker.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-188">In the official Docker documentation.</span></span>
    [<span data-ttu-id="bc0c5-189">*https://docs.docker.com/Engine/tutorials/dockerimages/*</span><span class="sxs-lookup"><span data-stu-id="bc0c5-189">*https://docs.docker.com/engine/tutorials/dockerimages/*</span></span>](https://docs.docker.com/engine/tutorials/dockerimages/)

### <a name="using-multi-arch-image-repositories"></a><span data-ttu-id="bc0c5-190">Uso de imagen arch varios repositorios</span><span class="sxs-lookup"><span data-stu-id="bc0c5-190">Using multi-arch image repositories</span></span>

<span data-ttu-id="bc0c5-191">Un repositorio único puede contener las variantes de la plataforma, como una imagen de Linux y una imagen de Windows.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-191">A single repo can contain platform variants, such as a Linux image and a Windows image.</span></span> <span data-ttu-id="bc0c5-192">Esta característica permite a los proveedores como Microsoft (creadores de imagen base) crear un repositorio único para abarcar varias plataformas (es decir, Linux y Windows).</span><span class="sxs-lookup"><span data-stu-id="bc0c5-192">This feature allows vendors like Microsoft (base image creators) to create a single repo to cover multiple platforms (that is Linux and Windows).</span></span> <span data-ttu-id="bc0c5-193">Por ejemplo, el [microsoft/dotnet](https://hub.docker.com/r/microsoft/aspnetcore/) repositorio disponible en el registro de Docker Hub proporciona compatibilidad con Linux y Windows Nano Server usando el mismo nombre de repositorio.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-193">For example, the [microsoft/dotnet](https://hub.docker.com/r/microsoft/aspnetcore/) repository available in the Docker Hub registry provides support for Linux and Windows Nano Server by using the same repo name.</span></span>

<span data-ttu-id="bc0c5-194">Si especifica una etiqueta, como destino una plataforma que sea explícita, como en los casos siguientes:</span><span class="sxs-lookup"><span data-stu-id="bc0c5-194">If you specify a tag, targeting a platform that is explicit like in the following cases:</span></span>

-   <span data-ttu-id="bc0c5-195">**Microsoft/aspnetcore:2.0.0-jessie**</span><span class="sxs-lookup"><span data-stu-id="bc0c5-195">**microsoft/aspnetcore:2.0.0-jessie**</span></span>

        .NET Core 2.0 runtime-only on Linux 

-   <span data-ttu-id="bc0c5-196">**Microsoft/aspnetcore:2.0.0-nanoserver**</span><span class="sxs-lookup"><span data-stu-id="bc0c5-196">**microsoft/aspnetcore:2.0.0-nanoserver**</span></span>

        .NET Core 2.0 runtime-only on Windows Nano Server

<span data-ttu-id="bc0c5-197">Sin embargo y esto es nuevo desde mediados de 2017, si especifica el mismo nombre de imagen, incluso con la misma etiqueta, las nuevas imágenes varias arch (por ejemplo, la imagen de aspnetcore que admite varios arch) utilizará la versión de Linux o Windows según el host Docker SO que se va a implementar , como se muestra en el ejemplo siguiente:</span><span class="sxs-lookup"><span data-stu-id="bc0c5-197">But, and this is new since mid-2017, if you specify the same image name, even with the same tag, the new multi-arch images (like the aspnetcore image which supports multi-arch) will use the Linux or Windows version depending on the Docker host OS you are deploying, as shown in the following example:</span></span>

-   <span data-ttu-id="bc0c5-198">**Microsoft / aspnetcore:2.0**</span><span class="sxs-lookup"><span data-stu-id="bc0c5-198">**microsoft/aspnetcore:2.0**</span></span>

        Multi-arch: .NET Core 2.0 runtime-only on Linux or Windows Nano Server depending on the Docker host OS

<span data-ttu-id="bc0c5-199">Este modo, cuando se extraen de una imagen desde un host de Windows, extraerá la variante de Windows y extraer el mismo nombre de imagen de un host Linux extraerá la variante de Linux.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-199">This way, when you pull an image from a Windows host, it will pull the Windows variant, and pulling the same image name from a Linux host will pull the Linux variant.</span></span>

### <a name="option-b-creating-your-base-image-from-scratch"></a><span data-ttu-id="bc0c5-200">Opción B: crear la imagen base desde el principio</span><span class="sxs-lookup"><span data-stu-id="bc0c5-200">Option B: Creating your base image from scratch</span></span>

<span data-ttu-id="bc0c5-201">Puede crear su propia imagen de base de Docker desde el principio.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-201">You can create your own Docker base image from scratch.</span></span> <span data-ttu-id="bc0c5-202">Este escenario no se recomienda para un usuario que se está iniciando con Docker, pero si desea establecer los bits específicos de su propia imagen base, puede hacerlo.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-202">This scenario is not recommended for someone who is starting with Docker, but if you want to set the specific bits of your own base image, you can do so.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="bc0c5-203">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="bc0c5-203">Additional resources</span></span>

-   <span data-ttu-id="bc0c5-204">**Arch varias imágenes de .NET Core**.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-204">**Multi-arch .NET Core images**.</span></span>
<span data-ttu-id="bc0c5-205">https://github.com/dotnet/Announcements/issues/14</span><span class="sxs-lookup"><span data-stu-id="bc0c5-205">https://github.com/dotnet/announcements/issues/14</span></span> 
-   <span data-ttu-id="bc0c5-206">**Crear una imagen base**.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-206">**Create a base image**.</span></span> <span data-ttu-id="bc0c5-207">Documentación oficial de Docker.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-207">Official Docker documentation.</span></span>
    [<span data-ttu-id="bc0c5-208">*https://docs.docker.com/Engine/userguide/ENG-Image/BaseImages/*</span><span class="sxs-lookup"><span data-stu-id="bc0c5-208">*https://docs.docker.com/engine/userguide/eng-image/baseimages/*</span></span>](https://docs.docker.com/engine/userguide/eng-image/baseimages/)

![](./media/image7.png)

## <a name="step-3-create-your-custom-docker-images-and-embed-your-application-or-service-in-them"></a><span data-ttu-id="bc0c5-209">Paso 3.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-209">Step 3.</span></span> <span data-ttu-id="bc0c5-210">Crear las imágenes del Docker personalizadas y lo inserte la aplicación o servicio en ellas</span><span class="sxs-lookup"><span data-stu-id="bc0c5-210">Create your custom Docker images and embed your application or service in them</span></span>

<span data-ttu-id="bc0c5-211">Para cada servicio en la aplicación, debe crear una imagen relacionada.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-211">For each service in your application, you need to create a related image.</span></span> <span data-ttu-id="bc0c5-212">Si la aplicación está formada por un único servicio o aplicación web, solo tiene una sola imagen.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-212">If your application is made up of a single service or web application, you just need a single image.</span></span>

<span data-ttu-id="bc0c5-213">Tenga en cuenta que las imágenes de Docker se generan automáticamente para usted en Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-213">Note that the Docker images are built automatically for you in Visual Studio.</span></span> <span data-ttu-id="bc0c5-214">Los pasos siguientes sólo son necesarios para el flujo de trabajo de editor/CLI y la explicación de por motivos de claridad sobre lo que ocurre debajo.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-214">The following steps are only needed for the editor/CLI workflow and explained for clarity about what happens underneath.</span></span>

<span data-ttu-id="bc0c5-215">Como desarrollador, debe desarrollar y probar localmente hasta que pulse una completa de características o cambiar en el sistema de control de código fuente (por ejemplo, para GitHub).</span><span class="sxs-lookup"><span data-stu-id="bc0c5-215">You, as developer, need to develop and test locally until you push a completed feature or change to your source control system (for example, to GitHub).</span></span> <span data-ttu-id="bc0c5-216">Esto significa que necesita para crear las imágenes de Docker y la implementación de contenedores en un host Docker local (Windows o Linux VM) y ejecutar, probar y depurar en esos contenedores locales.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-216">This means that you need to create the Docker images and deploy containers to a local Docker host (Windows or Linux VM) and run, test, and debug against those local containers.</span></span>

<span data-ttu-id="bc0c5-217">Para crear una imagen personalizada en su entorno local mediante la CLI de Docker y el Dockerfile, puede usar el comando de compilación de docker, como se muestra en la figura 5-5.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-217">To create a custom image in your local environment by using Docker CLI and your Dockerfile, you can use the docker build command, as in Figure 5-5.</span></span>

![](./media/image8.png)

<span data-ttu-id="bc0c5-218">**Figura 5-5**.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-218">**Figure 5-5**.</span></span> <span data-ttu-id="bc0c5-219">Crear una imagen personalizada de Docker</span><span class="sxs-lookup"><span data-stu-id="bc0c5-219">Creating a custom Docker image</span></span>

<span data-ttu-id="bc0c5-220">Si lo desea, en lugar de ejecutar directamente la compilación de docker desde la carpeta del proyecto, puede generar primero una carpeta que se pueden implementar con las bibliotecas .NET necesarias y los archivos binarios ejecutando dotnet publicación y, a continuación, use el comando de compilación de docker.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-220">Optionally, instead of directly running docker build from the project folder, you can first generate a deployable folder with the required .NET libraries and binaries by running dotnet publish, and then use the docker build command.</span></span>

<span data-ttu-id="bc0c5-221">Esto creará una imagen de Docker con el nombre cesardl/netcore-webapi-microservicio-docker: primero.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-221">This will create a Docker image with the name cesardl/netcore-webapi-microservice-docker:first.</span></span> <span data-ttu-id="bc0c5-222">En este caso,: en primer lugar es una etiqueta que representa una versión específica.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-222">In this case, :first is a tag representing a specific version.</span></span> <span data-ttu-id="bc0c5-223">Puede repetir este paso para cada imagen personalizada que se debe crear para la aplicación de Docker compuesta.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-223">You can repeat this step for each custom image you need to create for your composed Docker application.</span></span>

<span data-ttu-id="bc0c5-224">Cuando se realiza una aplicación de varios contenedores (es decir, es una aplicación de contenedor de varios), también puede usar el docker redactar una--comando de compilación para generar todas las imágenes relacionadas con un solo comando mediante el uso de los metadatos expuestos en relacionado archivos de compose.yml de docker.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-224">When an application is made of multiple containers (that is, it is a multi-container application), you can also use the docker-compose up --build command to build all the related images with a single command by using the metadata exposed in the related docker-compose.yml files.</span></span>

<span data-ttu-id="bc0c5-225">Se pueden encontrar las imágenes existentes en el repositorio local mediante el docker comandos de imágenes, tal como se muestra en la figura 5-6.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-225">You can find the existing images in your local repository by using the docker images command, as shown in Figure 5-6.</span></span>

![](./media/image9.png)

<span data-ttu-id="bc0c5-226">**Figura 5-6.**</span><span class="sxs-lookup"><span data-stu-id="bc0c5-226">**Figure 5-6.**</span></span> <span data-ttu-id="bc0c5-227">Visualización de imágenes existentes mediante el comando de imágenes de docker</span><span class="sxs-lookup"><span data-stu-id="bc0c5-227">Viewing existing images using the docker images command</span></span>

### <a name="creating-docker-images-with-visual-studio"></a><span data-ttu-id="bc0c5-228">Creación de imágenes de Docker con Visual Studio</span><span class="sxs-lookup"><span data-stu-id="bc0c5-228">Creating Docker images with Visual Studio</span></span>

<span data-ttu-id="bc0c5-229">Cuando se utiliza Visual Studio para crear un proyecto con el soporte técnico de Docker, no cree explícitamente una imagen.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-229">When you are using Visual Studio to create a project with Docker support, you do not explicitly create an image.</span></span> <span data-ttu-id="bc0c5-230">En su lugar, la imagen se crea automáticamente cuando presione F5 y ejecute el servicio o aplicación dockerized.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-230">Instead, the image is created for you when you press F5 and run the dockerized application or service.</span></span> <span data-ttu-id="bc0c5-231">Este paso es automático en Visual Studio y no verá ocurrir, pero es importante que sepa lo que está ocurriendo en debajo.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-231">This step is automatic in Visual Studio, and you will not see it happen, but it is important that you know what is going on underneath.</span></span>

![](./media/image10.png)

## <a name="step-4-define-your-services-in-docker-composeyml-when-building-a-multi-container-docker-application"></a><span data-ttu-id="bc0c5-232">Paso 4.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-232">Step 4.</span></span> <span data-ttu-id="bc0c5-233">Definir los servicios en docker compose.yml al compilar una aplicación de Docker de contenedor múltiples</span><span class="sxs-lookup"><span data-stu-id="bc0c5-233">Define your services in docker-compose.yml when building a multi-container Docker application</span></span>

<span data-ttu-id="bc0c5-234">El [docker compose.yml](https://docs.docker.com/compose/compose-file/) archivo le permite definir un conjunto de servicios relacionados que desee implementar como una aplicación compuesta con comandos de implementación.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-234">The [docker-compose.yml](https://docs.docker.com/compose/compose-file/) file lets you define a set of related services to be deployed as a composed application with deployment commands.</span></span>

<span data-ttu-id="bc0c5-235">Para usar un archivo de compose.yml de docker, debe crear el archivo de la ventana principal o la carpeta raíz de la solución, con contenido parecidos a los en el ejemplo siguiente:</span><span class="sxs-lookup"><span data-stu-id="bc0c5-235">To use a docker-compose.yml file, you need to create the file in your main or root solution folder, with content similar to that in the following example:</span></span>

```yml
version: '3'
  
services:

  webmvc:
    image: eshop/web
    environment:
      - CatalogUrl=http://catalog.api
      - OrderingUrl=http://ordering.api
    ports:
      - "80:80"
    depends_on:
      - catalog.api
      - ordering.api

  catalog.api:
    image: eshop/catalog.api
    environment: 
      - ConnectionString=Server=sql.data;Database=CatalogDB;…
    ports:
      - "81:80"
    depends_on:
      - sql.data

  ordering.api:
    image: eshop/ordering.api
    environment:
      - ConnectionString=Server=sql.data;Database=OrderingDb;…
    ports:
      - "82:80"
    extra_hosts:
      - "CESARDLBOOKVHD:10.0.75.1"
    depends_on:
      - sql.data

  sql.data:
    image: mssql-server-linux:latest
    environment:
      - SA_PASSWORD=Pass@word
      - ACCEPT_EULA=Y
    ports:
      - "5433:1433"

```

<span data-ttu-id="bc0c5-236">Tenga en cuenta que este archivo compose.yml docker es una versión simplificada y combinada.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-236">Note that this docker-compose.yml file is a simplified and merged version.</span></span> <span data-ttu-id="bc0c5-237">Contiene datos de configuración estática para cada contenedor (por ejemplo, el nombre de la imagen personalizada), que siempre se aplica, junto con información de configuración que podría depender en el entorno de implementación, como la cadena de conexión.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-237">It contains static configuration data for each container (like the name of the custom image), which always applies, plus configuration information that might depend on the deployment environment, like the connection string.</span></span> <span data-ttu-id="bc0c5-238">En secciones posteriores, obtendrá información sobre cómo puede dividir la configuración de docker compose.yml en varios docker-crear archivos y valores de invalidación según el tipo de entorno y la ejecución (debug o release).</span><span class="sxs-lookup"><span data-stu-id="bc0c5-238">In later sections, you will learn how you can split the docker-compose.yml configuration into multiple docker-compose files and override values depending on the environment and execution type (debug or release).</span></span>

<span data-ttu-id="bc0c5-239">En el ejemplo de archivo de docker compose.yml define cinco servicios: el servicio de webmvc (una aplicación web), dos microservicios (catalog.api y ordering.api) y datos de un contenedor de origen, sql.data, en función de SQL Server para Linux que se ejecuta como un contenedor.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-239">The docker-compose.yml file example defines five services: the webmvc service (a web application), two microservices (catalog.api and ordering.api), and one data source container, sql.data, based on SQL Server for Linux running as a container.</span></span> <span data-ttu-id="bc0c5-240">Cada servicio se implementa como un contenedor, por lo que es necesaria para cada una imagen de Docker.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-240">Each service is deployed as a container, so a Docker image is required for each.</span></span>

<span data-ttu-id="bc0c5-241">El archivo docker compose.yml especifica no solo se usan los contenedores, pero ¿cómo se configuran por separado.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-241">The docker-compose.yml file specifies not only what containers are being used, but how they are individually configured.</span></span> <span data-ttu-id="bc0c5-242">Por ejemplo, el webmvc definición de contenedor en el archivo .yml:</span><span class="sxs-lookup"><span data-stu-id="bc0c5-242">For instance, the webmvc container definition in the .yml file:</span></span>

-   <span data-ttu-id="bc0c5-243">Usa un pregenerado compras o imagen de web: más reciente.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-243">Uses a pre-built eshop/web:latest image.</span></span> <span data-ttu-id="bc0c5-244">Sin embargo, también puede configurar la imagen que se crea como parte de la redacción de docker la ejecución con una configuración adicional basada en una compilación: sección en el archivo docker-compose.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-244">However, you could also configure the image to be built as part of the docker-compose execution with an additional configuration based on a build: section in the docker-compose file.</span></span>

-   <span data-ttu-id="bc0c5-245">Inicializa dos variables de entorno (dirección URL de catálogo y OrderingUrl).</span><span class="sxs-lookup"><span data-stu-id="bc0c5-245">Initializes two environment variables (CatalogUrl and OrderingUrl).</span></span>

-   <span data-ttu-id="bc0c5-246">Reenvía el puerto 80 en el contenedor para el puerto 80 externo en el equipo host expuesto.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-246">Forwards the exposed port 80 on the container to the external port 80 on the host machine.</span></span>

-   <span data-ttu-id="bc0c5-247">Vincula la aplicación web para el catálogo y el orden de servicio con la función\_en configuración.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-247">Links the web app to the catalog and ordering service with the depends\_on setting.</span></span> <span data-ttu-id="bc0c5-248">Esto hace que el servicio debe esperar hasta que se inician los servicios.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-248">This causes the service to wait until those services are started.</span></span>

<span data-ttu-id="bc0c5-249">Cuando se incluye información sobre cómo implementar microservicios y contenedor varias aplicaciones, examinaremos el archivo compose.yml de docker en una sección posterior.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-249">We will revisit the docker-compose.yml file in a later section when we cover how to implement microservices and multi-container apps.</span></span>

### <a name="working-with-docker-composeyml-in-visual-studio-2017"></a><span data-ttu-id="bc0c5-250">Trabajar con docker-compose.yml en Visual Studio de 2017</span><span class="sxs-lookup"><span data-stu-id="bc0c5-250">Working with docker-compose.yml in Visual Studio 2017</span></span>

<span data-ttu-id="bc0c5-251">Cuando se agrega compatibilidad con soluciones de Docker a un proyecto de servicio en una solución de Visual Studio, tal como se muestra en la figura 5-7, Visual Studio agrega un archivo Dockerfile al proyecto y agrega una sección de servicio (proyecto) en la solución con los archivos de compose.yml de docker.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-251">When you add Docker solution support to a service project in a Visual Studio solution, as shown in Figure 5-7, Visual Studio adds a Dockerfile to your project, and it adds a service section (project) in your solution with the docker-compose.yml files.</span></span> <span data-ttu-id="bc0c5-252">Es una forma sencilla de empezar a crear la solución de varios contenedores.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-252">It is an easy way to start composing your multiple-container solution.</span></span> <span data-ttu-id="bc0c5-253">A continuación, puede abrir los archivos de docker compose.yml y actualizarlas con características adicionales.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-253">You can then open the docker-compose.yml files and update them with additional features.</span></span>

![](./media/image6.png)

<span data-ttu-id="bc0c5-254">**Figura 5-7**.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-254">**Figure 5-7**.</span></span> <span data-ttu-id="bc0c5-255">Agregar compatibilidad de Docker en Visual Studio de 2017 haciendo clic en un proyecto de ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="bc0c5-255">Adding Docker support in Visual Studio 2017 by right-clicking an ASP.NET Core project</span></span>

<span data-ttu-id="bc0c5-256">Agregar compatibilidad con Docker en Visual Studio no solo el Dockerfile agrega al proyecto, pero agrega la información de configuración a varios archivos de compose.yml de docker global que se establecen en el nivel de solución.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-256">Adding Docker support in Visual Studio not only adds the Dockerfile to your project, but adds the configuration information to several global docker-compose.yml files that are set at the solution level.</span></span>

<span data-ttu-id="bc0c5-257">Después de agregar compatibilidad de Docker a la solución en Visual Studio, también verá un nuevo nodo (en el archivo de proyecto docker compose.dcproj) en el Explorador de soluciones que contiene los archivos de compose.yml de docker agregada, como se muestra en la figura 5-8.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-257">After you add Docker support to your solution in Visual Studio, you will also see a new node (in the docker-compose.dcproj project file) in Solution Explorer that contains the added docker-compose.yml files, as shown in Figure 5-8.</span></span>

![](./media/image11.PNG)

<span data-ttu-id="bc0c5-258">**Figura 5-8**.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-258">**Figure 5-8**.</span></span> <span data-ttu-id="bc0c5-259">El **crear docker** nodo de árbol que se agregó en el Explorador de soluciones de Visual Studio de 2017</span><span class="sxs-lookup"><span data-stu-id="bc0c5-259">The **docker-compose** tree node added in Visual Studio 2017 Solution Explorer</span></span>

<span data-ttu-id="bc0c5-260">Puede implementar una aplicación de contenedor de varios con un archivo único de compose.yml de docker mediante el crear docker comando.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-260">You could deploy a multi-container application with a single docker-compose.yml file by using the docker-compose up command.</span></span> <span data-ttu-id="bc0c5-261">Sin embargo, Visual Studio agrega un grupo de ellos por lo que puede invalidar valores dependiendo del entorno (desarrollo frente a producción) y la ejecución de tipo (versión en comparación con depuración).</span><span class="sxs-lookup"><span data-stu-id="bc0c5-261">However, Visual Studio adds a group of them so you can override values depending on the environment (development versus production) and execution type (release versus debug).</span></span> <span data-ttu-id="bc0c5-262">Esta capacidad se explican en secciones posteriores.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-262">This capability will be explained in later sections.</span></span>

![](./media/image12.png)

## <a name="step-5-build-and-run-your-docker-application"></a><span data-ttu-id="bc0c5-263">Paso 5.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-263">Step 5.</span></span> <span data-ttu-id="bc0c5-264">Compilar y ejecutar la aplicación de Docker</span><span class="sxs-lookup"><span data-stu-id="bc0c5-264">Build and run your Docker application</span></span>

<span data-ttu-id="bc0c5-265">Si la aplicación solo tiene un único contenedor, puede ejecutar mediante la implementación en el host Docker (virtual o servidor físico).</span><span class="sxs-lookup"><span data-stu-id="bc0c5-265">If your application only has a single container, you can run it by deploying it to your Docker host (VM or physical server).</span></span> <span data-ttu-id="bc0c5-266">Sin embargo, si la aplicación contiene varios servicios, se puede implementar como una aplicación compuesta, ya sea mediante un solo comando CLI (docker-constituyen una), o con Visual Studio, que va a utilizar ese comando en segundo plano.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-266">However, if your application contains multiple services, you can deploy it as a composed application, either using a single CLI command (docker-compose up), or with Visual Studio, which will use that command under the covers.</span></span> <span data-ttu-id="bc0c5-267">Echemos un vistazo a las distintas opciones.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-267">Let’s look at the different options.</span></span>

### <a name="option-a-running-a-single-container-with-docker-cli"></a><span data-ttu-id="bc0c5-268">Opción A: ejecutando un contenedor único con CLI de Docker</span><span class="sxs-lookup"><span data-stu-id="bc0c5-268">Option A: Running a single-container with Docker CLI</span></span>

<span data-ttu-id="bc0c5-269">Puede ejecutar un contenedor de Docker mediante el comando docker run, como se muestra en la figura 5-9:</span><span class="sxs-lookup"><span data-stu-id="bc0c5-269">You can run a Docker container using the docker run command, as in Figure 5-9:</span></span>

```
  docker run -t -d -p 80:5000 cesardl/netcore-webapi-microservice-docker:first
```

![](./media/image13.png)

<span data-ttu-id="bc0c5-270">**Figura 5-9**.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-270">**Figure 5-9**.</span></span> <span data-ttu-id="bc0c5-271">Ejecución de un contenedor de Docker mediante el comando docker run</span><span class="sxs-lookup"><span data-stu-id="bc0c5-271">Running a Docker container using the docker run command</span></span>

<span data-ttu-id="bc0c5-272">En este caso, el comando enlaza el puerto interno 5000 del contenedor al puerto 80 de la máquina host.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-272">In this case, the command binds the internal port 5000 of the container to port 80 of the host machine.</span></span> <span data-ttu-id="bc0c5-273">Esto significa que el host está escuchando en el puerto 80 y reenvío al puerto 5000 en el contenedor.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-273">This means that the host is listening on port 80 and forwarding to port 5000 on the container.</span></span>

### <a name="option-b-running-a-multi-container-application"></a><span data-ttu-id="bc0c5-274">Opción B: ejecuta una aplicación de contenedor múltiples</span><span class="sxs-lookup"><span data-stu-id="bc0c5-274">Option B: Running a multi-container application</span></span>

<span data-ttu-id="bc0c5-275">En la mayoría de los escenarios de empresa, una aplicación de Docker podría estar compuesta por varios servicios, lo que significa que debe ejecutar una aplicación de contenedor de varios, como se muestra en la figura 5-10.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-275">In most enterprise scenarios, a Docker application will be composed of multiple services, which means you need to run a multi-container application, as shown in Figure 5-10.</span></span>

![](./media/image14.png)

<span data-ttu-id="bc0c5-276">**Figura 5-10**.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-276">**Figure 5-10**.</span></span> <span data-ttu-id="bc0c5-277">Máquina virtual con contenedores de Docker implementado</span><span class="sxs-lookup"><span data-stu-id="bc0c5-277">VM with Docker containers deployed</span></span>

#### <a name="running-a-multi-container-application-with-the-docker-cli"></a><span data-ttu-id="bc0c5-278">Ejecuta una aplicación de contenedor múltiples con la CLI de Docker</span><span class="sxs-lookup"><span data-stu-id="bc0c5-278">Running a multi-container application with the Docker CLI</span></span>

<span data-ttu-id="bc0c5-279">Para ejecutar una aplicación de contenedor múltiples con la CLI de Docker, puede ejecutar el docker-crear comando.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-279">To run a multi-container application with the Docker CLI, you can run the docker-compose up command.</span></span> <span data-ttu-id="bc0c5-280">Este archivo usa el compose.yml docker de comandos que haya en el nivel de solución para implementar una aplicación de contenedor de varios.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-280">This command uses the docker-compose.yml file that you have at the solution level to deploy a multi-container application.</span></span> <span data-ttu-id="bc0c5-281">Figura 5-11 muestra los resultados cuando se ejecuta el comando desde el directorio principal del proyecto, que contiene el archivo compose.yml docker.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-281">Figure 5-11 shows the results when running the command from your main project directory, which contains the docker-compose.yml file.</span></span>

![](./media/image15.png)

<span data-ttu-id="bc0c5-282">**Figura 5-11**.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-282">**Figure 5-11**.</span></span> <span data-ttu-id="bc0c5-283">En el ejemplo se produce cuando se ejecuta la redacción de docker comando</span><span class="sxs-lookup"><span data-stu-id="bc0c5-283">Example results when running the docker-compose up command</span></span>

<span data-ttu-id="bc0c5-284">Después de la docker-crear la ejecución del comando, la aplicación y sus contenedores relacionados se implementan en el host Docker, como se muestra en la representación de la máquina virtual en la figura 5-10.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-284">After the docker-compose up command runs, the application and its related containers are deployed into your Docker host, as illustrated in the VM representation in Figure 5-10.</span></span>

#### <a name="running-and-debugging-a-multi-container-application-with-visual-studio"></a><span data-ttu-id="bc0c5-285">Ejecutar y depurar una aplicación de contenedor múltiples con Visual Studio</span><span class="sxs-lookup"><span data-stu-id="bc0c5-285">Running and debugging a multi-container application with Visual Studio</span></span> 

<span data-ttu-id="bc0c5-286">Ejecuta una aplicación de contenedor múltiples mediante 2017 de Visual Studio no se puede obtener más sencilla.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-286">Running a multi-container application using Visual Studio 2017 cannot get simpler.</span></span> <span data-ttu-id="bc0c5-287">Solo no puede ejecutar la aplicación contenedora múltiples, pero es posible depurar todos sus contenedores directamente desde Visual Studio estableciendo puntos de interrupción normales.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-287">You can not only run the multi-container application, but you are able to debug all its containers directly from Visual Studio by setting regular breakpoints.</span></span>

<span data-ttu-id="bc0c5-288">Como se mencionó antes, cada vez que agregue compatibilidad con soluciones de Docker a un proyecto dentro de una solución, ese proyecto se configura en el archivo global (nivel de solución) docker-compose.yml, que le permite ejecutar o depurar la solución completa a la vez.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-288">As mentioned before, each time you add Docker solution support to a project within a solution, that project is configured in the global (solution-level) docker-compose.yml file, which lets you run or debug the whole solution at once.</span></span> <span data-ttu-id="bc0c5-289">Visual Studio inicia un contenedor para cada proyecto que tiene habilitada la compatibilidad de solución de Docker y realizar todos los pasos internos por usted (dotnet publica, compilación de docker, etcetera.).</span><span class="sxs-lookup"><span data-stu-id="bc0c5-289">Visual Studio will start one container for each project that has Docker solution support enabled, and perform all the internal steps for you (dotnet publish, docker build, etc.).</span></span>

<span data-ttu-id="bc0c5-290">La cuestión importante aquí es que, como se muestra en la figura 5-12, en Visual Studio de 2017 hay más **Docker** comando para la acción de tecla F5.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-290">The important point here is that, as shown in Figure 5-12, in Visual Studio 2017 there is an additional **Docker** command for the F5 key action.</span></span> <span data-ttu-id="bc0c5-291">Esta opción le permite ejecutar o depurar una aplicación de múltiples contenedor mediante la ejecución de todos los contenedores que se definen en los archivos de compose.yml de docker en el nivel de solución.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-291">This option lets you run or debug a multi-container application by running all the containers that are defined in the docker-compose.yml files at the solution level.</span></span> <span data-ttu-id="bc0c5-292">La capacidad de depurar las soluciones de varios contenedores significa que puede establecer varios puntos de interrupción, cada punto de interrupción en un proyecto diferente (contenedor) y, durante la depuración de Visual Studio se detendrá en los puntos de interrupción definidos en distintos proyectos y en ejecución en contenedores diferentes.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-292">The ability to debug multiple-container solutions means that you can set several breakpoints, each breakpoint in a different project (container), and while debugging from Visual Studio you will stop at breakpoints defined in different projects and running on different containers.</span></span>

![](./media/image16.png)

<span data-ttu-id="bc0c5-293">**Figura 5-12**.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-293">**Figure 5-12**.</span></span> <span data-ttu-id="bc0c5-294">Contenedor de varias aplicaciones en ejecución en Visual Studio de 2017</span><span class="sxs-lookup"><span data-stu-id="bc0c5-294">Running multi-container apps in Visual Studio 2017</span></span>

### <a name="additional-resources"></a><span data-ttu-id="bc0c5-295">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="bc0c5-295">Additional resources</span></span>

-   <span data-ttu-id="bc0c5-296">**Implementar un contenedor ASP.NET en un host remoto de Docker**
    [*https://docs.microsoft.com/azure/vs-azure-tools-docker-hosting-web-apps-in-docker*](https://docs.microsoft.com/azure/vs-azure-tools-docker-hosting-web-apps-in-docker)</span><span class="sxs-lookup"><span data-stu-id="bc0c5-296">**Deploy an ASP.NET container to a remote Docker host**
[*https://docs.microsoft.com/azure/vs-azure-tools-docker-hosting-web-apps-in-docker*](https://docs.microsoft.com/azure/vs-azure-tools-docker-hosting-web-apps-in-docker)</span></span>

### <a name="a-note-about-testing-and-deploying-with-orchestrators"></a><span data-ttu-id="bc0c5-297">Una nota acerca de cómo probar e implementar con orchestrators</span><span class="sxs-lookup"><span data-stu-id="bc0c5-297">A note about testing and deploying with orchestrators</span></span>

<span data-ttu-id="bc0c5-298">El docker redactar una y comandos de docker ejecutar (o se ejecuta y depuración de los contenedores en Visual Studio) son adecuados para probar los contenedores en el entorno de desarrollo.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-298">The docker-compose up and docker run commands (or running and debugging the containers in Visual Studio) are adequate for testing containers in your development environment.</span></span> <span data-ttu-id="bc0c5-299">Pero no debería usar este enfoque si se dirige a los clústeres de Docker y orchestrators como Docker Swarm, Mesosphere DC/OS o Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-299">But you should not use this approach if you are targeting Docker clusters and orchestrators like Docker Swarm, Mesosphere DC/OS, or Kubernetes.</span></span> <span data-ttu-id="bc0c5-300">Si está usando un clúster como [Docker Swarm modo](https://docs.docker.com/engine/swarm/) (disponible en Docker CE para Windows y Mac desde la versión 1.12), debe implementar y probar con comandos adicionales, como [crear servicio docker](https://docs.docker.com/engine/reference/commandline/service_create/) para Servicios de inicio único.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-300">If you are using a cluster like [Docker Swarm mode](https://docs.docker.com/engine/swarm/) (available in Docker CE for Windows and Mac since version 1.12), you need to deploy and test with additional commands like [docker service create](https://docs.docker.com/engine/reference/commandline/service_create/) for single services.</span></span> <span data-ttu-id="bc0c5-301">Si va a implementar una aplicación formada por varios contenedores, use [docker crear paquete](https://docs.docker.com/compose/reference/bundle/) y [docker implementar myBundleFile](https://docs.docker.com/engine/reference/commandline/deploy/) para implementar la aplicación compuesta como un *pila*.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-301">If you are deploying an application composed of several containers, you use [docker compose bundle](https://docs.docker.com/compose/reference/bundle/) and [docker deploy myBundleFile](https://docs.docker.com/engine/reference/commandline/deploy/) to deploy the composed application as a *stack*.</span></span> <span data-ttu-id="bc0c5-302">Para obtener más información, consulte la entrada de blog [Introducción a paquetes de aplicaciones experimentales distribuidos](https://blog.docker.com/2016/06/docker-app-bundle/) en la documentación de Docker.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-302">For more information, see the blog post [Introducing Experimental Distributed Application Bundles](https://blog.docker.com/2016/06/docker-app-bundle/) in the Docker documentation.</span></span> <span data-ttu-id="bc0c5-303">en el sitio de Docker.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-303">on the Docker site.</span></span>

<span data-ttu-id="bc0c5-304">Para [DC/OS](https://mesosphere.com/blog/2015/09/02/dcos-cli-command-line-tool-datacenter/) y [Kubernetes](http://kubernetes.io/docs/user-guide/deployments/) usaría también secuencias de comandos y comandos de implementación diferentes.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-304">For [DC/OS](https://mesosphere.com/blog/2015/09/02/dcos-cli-command-line-tool-datacenter/) and [Kubernetes](http://kubernetes.io/docs/user-guide/deployments/) you would use different deployment commands and scripts as well.</span></span>

![](./media/image17.png)

## <a name="step-6-test-your-docker-application-using-your-local-docker-host"></a><span data-ttu-id="bc0c5-305">Paso 6.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-305">Step 6.</span></span> <span data-ttu-id="bc0c5-306">Probar la aplicación de Docker con el host local de Docker</span><span class="sxs-lookup"><span data-stu-id="bc0c5-306">Test your Docker application using your local Docker host</span></span>

<span data-ttu-id="bc0c5-307">Este paso variarán dependiendo de lo que está haciendo la aplicación.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-307">This step will vary depending on what your application is doing.</span></span> <span data-ttu-id="bc0c5-308">En una aplicación .NET Core Web simple que se implementa como un único contenedor o un servicio, puede tener acceso al servicio, abra un explorador en el host Docker y vaya a ese sitio tal como se muestra en la figura 5-13.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-308">In a simple .NET Core Web application that is deployed as a single container or service, you can access the service by opening a browser on the Docker host and navigating to that site as shown in Figure 5-13.</span></span> <span data-ttu-id="bc0c5-309">(Si la configuración en el Dockerfile asigna el contenedor a un puerto en el host que es un valor distinto de 80, incluya la entrada de host en la URL.)</span><span class="sxs-lookup"><span data-stu-id="bc0c5-309">(If the configuration in the Dockerfile maps the container to a port on the host that is anything other than 80, include the host post in the URL.)</span></span>

![](./media/image18.png)

<span data-ttu-id="bc0c5-310">**Figura 5-13**.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-310">**Figure 5-13**.</span></span> <span data-ttu-id="bc0c5-311">Ejemplo de probar la aplicación de Docker localmente mediante localhost</span><span class="sxs-lookup"><span data-stu-id="bc0c5-311">Example of testing your Docker application locally using localhost</span></span>

<span data-ttu-id="bc0c5-312">Dirección IP del host si localhost no apunta a la Docker (de forma predeterminada, al usar Docker CE, que debería), para navegar a su servicio, utilice la dirección IP de la tarjeta de red de su equipo.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-312">If localhost is not pointing to the Docker host IP (by default, when using Docker CE, it should), to navigate to your service, use the IP address of your machine’s network card.</span></span>

<span data-ttu-id="bc0c5-313">Tenga en cuenta que esta dirección URL en el explorador usa el puerto 80 para el ejemplo de contenedor determinado que se analice.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-313">Note that this URL in the browser uses port 80 for the particular container example being discussed.</span></span> <span data-ttu-id="bc0c5-314">Sin embargo, internamente las solicitudes se se redirige al puerto 5000, porque ese era cómo se implementó con el comando docker run, tal como se describe en el paso anterior.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-314">However, internally the requests are being redirected to port 5000, because that was how it was deployed with the docker run command, as explained in a previous step.</span></span>

<span data-ttu-id="bc0c5-315">También puede probar la aplicación con el doblez desde el terminal, tal como se muestra en la figura 5-14.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-315">You can also test the application using curl from the terminal, as shown in Figure 5-14.</span></span> <span data-ttu-id="bc0c5-316">En una instalación de Docker en Windows, el valor predeterminado de IP de Host de Docker es siempre 10.0.75.1 Además de la dirección IP real de su equipo.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-316">In a Docker installation on Windows, the default Docker Host IP is always 10.0.75.1 in addition to your machine’s actual IP address.</span></span>

![](./media/image19.png)

<span data-ttu-id="bc0c5-317">**Figura 5-14**.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-317">**Figure 5-14**.</span></span> <span data-ttu-id="bc0c5-318">Ejemplo de probar la aplicación de Docker localmente mediante curl</span><span class="sxs-lookup"><span data-stu-id="bc0c5-318">Example of testing your Docker application locally using curl</span></span>

### <a name="testing-and-debugging-containers-with-visual-studio-2017"></a><span data-ttu-id="bc0c5-319">Probar y depurar contenedores con Visual Studio de 2017</span><span class="sxs-lookup"><span data-stu-id="bc0c5-319">Testing and debugging containers with Visual Studio 2017</span></span>

<span data-ttu-id="bc0c5-320">Cuando se ejecutan y depuran los contenedores con 2017 de Visual Studio, puede depurar la aplicación de .NET de la misma manera como lo haría cuando se ejecuta sin contenedores.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-320">When running and debugging the containers with Visual Studio 2017, you can debug the .NET application in much the same way as you would when running without containers.</span></span>

### <a name="testing-and-debugging-without-visual-studio"></a><span data-ttu-id="bc0c5-321">Probar y depurar sin Visual Studio</span><span class="sxs-lookup"><span data-stu-id="bc0c5-321">Testing and debugging without Visual Studio</span></span>

<span data-ttu-id="bc0c5-322">Si está desarrollando usando el enfoque de editor/CLI, contenedores de depuración es más difícil y que va a depurar mediante la generación de seguimientos.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-322">If you are developing using the editor/CLI approach, debugging containers is more difficult and you will want to debug by generating traces.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="bc0c5-323">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="bc0c5-323">Additional resources</span></span>

-   <span data-ttu-id="bc0c5-324">**Depuración de aplicaciones en un contenedor de Docker local**
    [*https://docs.microsoft.com/azure/vs-azure-tools-docker-edit-and-refresh*](https://docs.microsoft.com/azure/vs-azure-tools-docker-edit-and-refresh)</span><span class="sxs-lookup"><span data-stu-id="bc0c5-324">**Debugging apps in a local Docker container**
[*https://docs.microsoft.com/azure/vs-azure-tools-docker-edit-and-refresh*](https://docs.microsoft.com/azure/vs-azure-tools-docker-edit-and-refresh)</span></span>

-   <span data-ttu-id="bc0c5-325">**Steve Lasker. Compilar, depurar, implementar aplicaciones de ASP.NET Core con Docker.**</span><span class="sxs-lookup"><span data-stu-id="bc0c5-325">**Steve Lasker. Build, Debug, Deploy ASP.NET Core Apps with Docker.**</span></span> <span data-ttu-id="bc0c5-326">Vídeo.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-326">Video.</span></span>
    [<span data-ttu-id="bc0c5-327">*https://channel9.msdn.com/events/Visual-Studio/Visual-Studio-2017-Launch/T115*</span><span class="sxs-lookup"><span data-stu-id="bc0c5-327">*https://channel9.msdn.com/Events/Visual-Studio/Visual-Studio-2017-Launch/T115*</span></span>](https://channel9.msdn.com/Events/Visual-Studio/Visual-Studio-2017-Launch/T115)

## <a name="simplified-workflow-when-developing-containers-with-visual-studio"></a><span data-ttu-id="bc0c5-328">Flujo de trabajo simplificada al desarrollar contenedores con Visual Studio</span><span class="sxs-lookup"><span data-stu-id="bc0c5-328">Simplified workflow when developing containers with Visual Studio</span></span>

<span data-ttu-id="bc0c5-329">De hecho, el flujo de trabajo cuando se usa Visual Studio es mucho más sencilla que si se usa el enfoque de editor/CLI.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-329">Effectively, the workflow when using Visual Studio is a lot simpler than if you use the editor/CLI approach.</span></span> <span data-ttu-id="bc0c5-330">La mayoría de los pasos necesarios para Docker relacionadas con el Dockerfile y docker compose.yml archivos se ocultan o se ha simplificado con Visual Studio, tal como se muestra en la figura 5-15.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-330">Most of the steps required by Docker related to the Dockerfile and docker-compose.yml files are hidden or simplified by Visual Studio, as shown in Figure 5-15.</span></span>

![](./media/image20.png)

<span data-ttu-id="bc0c5-331">**Figura 5-15**.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-331">**Figure 5-15**.</span></span> <span data-ttu-id="bc0c5-332">Flujo de trabajo simplificada al desarrollar con Visual Studio</span><span class="sxs-lookup"><span data-stu-id="bc0c5-332">Simplified workflow when developing with Visual Studio</span></span>

<span data-ttu-id="bc0c5-333">Además, debe realizar el paso 2 (agregar compatibilidad de Docker a los proyectos de) una sola vez.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-333">In addition, you need to perform step 2 (adding Docker support to your projects) just once.</span></span> <span data-ttu-id="bc0c5-334">Por lo tanto, el flujo de trabajo es similar a las tareas de desarrollo habitual cuando se usa .NET para otros entornos de desarrollo.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-334">Therefore, the workflow is similar to your usual development tasks when using .NET for any other development.</span></span> <span data-ttu-id="bc0c5-335">Debe saber qué está sucediendo en segundo plano (el proceso de generación de imagen, qué imágenes base que usa, la implementación de contenedores, etc.) y a veces que también debe editar el archivo Dockerfile o compose.yml docker para personalizar los comportamientos.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-335">You need to know what is going on under the covers (the image build process, what base images you are using, deployment of containers, etc.) and sometimes you will also need to edit the Dockerfile or docker-compose.yml file to customize behaviors.</span></span> <span data-ttu-id="bc0c5-336">Pero se simplifica enormemente la mayoría del trabajo mediante Visual Studio, que se hace mucho más productivo.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-336">But most of the work is greatly simplified by using Visual Studio, making you a lot more productive.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="bc0c5-337">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="bc0c5-337">Additional resources</span></span>

-   <span data-ttu-id="bc0c5-338">**Steve Lasker. Desarrollo de docker de .NET con Visual Studio de 2017**
    [*https://channel9.msdn.com/Events/Visual-Studio/Visual-Studio-2017-Launch/T111*](https://channel9.msdn.com/Events/Visual-Studio/Visual-Studio-2017-Launch/T111)</span><span class="sxs-lookup"><span data-stu-id="bc0c5-338">**Steve Lasker. .NET Docker Development with Visual Studio 2017**
[*https://channel9.msdn.com/Events/Visual-Studio/Visual-Studio-2017-Launch/T111*](https://channel9.msdn.com/Events/Visual-Studio/Visual-Studio-2017-Launch/T111)</span></span>

-   <span data-ttu-id="bc0c5-339">**Jeffrey T. Fritz. Coloque una aplicación básica de .NET en un contenedor con las nuevas herramientas de Docker para Visual Studio**
    [*https://blogs.msdn.microsoft.com/webdev/2016/11/16/new-docker-tools-for-visual-studio/*](https://blogs.msdn.microsoft.com/webdev/2016/11/16/new-docker-tools-for-visual-studio/)</span><span class="sxs-lookup"><span data-stu-id="bc0c5-339">**Jeffrey T. Fritz. Put a .NET Core App in a Container with the new Docker Tools for Visual Studio**
[*https://blogs.msdn.microsoft.com/webdev/2016/11/16/new-docker-tools-for-visual-studio/*](https://blogs.msdn.microsoft.com/webdev/2016/11/16/new-docker-tools-for-visual-studio/)</span></span>

## <a name="using-powershell-commands-in-a-dockerfile-to-set-up-windows-containers"></a><span data-ttu-id="bc0c5-340">Usar comandos de PowerShell en un archivo Dockerfile para configurar los contenedores de Windows</span><span class="sxs-lookup"><span data-stu-id="bc0c5-340">Using PowerShell commands in a Dockerfile to set up Windows Containers</span></span> 

<span data-ttu-id="bc0c5-341">[Contenedores de Windows](https://msdn.microsoft.com/en-us/virtualization/windowscontainers/about/about_overview) que pueda convertir las aplicaciones de Windows existentes en las imágenes de Docker e implementarlas con las mismas herramientas que el resto del ecosistema de Docker.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-341">[Windows Containers](https://msdn.microsoft.com/en-us/virtualization/windowscontainers/about/about_overview) allow you to convert your existing Windows applications into Docker images and deploy them with the same tools as the rest of the Docker ecosystem.</span></span> <span data-ttu-id="bc0c5-342">Para utilizar los contenedores de Windows, ejecute comandos de PowerShell en el Dockerfile, como se muestra en el ejemplo siguiente:</span><span class="sxs-lookup"><span data-stu-id="bc0c5-342">To use Windows Containers, you run PowerShell commands in the Dockerfile, as shown in the following example:</span></span>

```
FROM microsoft/windowsservercore
  
LABEL Description="IIS" Vendor="Microsoft" Version="10"
  
RUN powershell -Command Add-WindowsFeature Web-Server
  
CMD [ "ping", "localhost", "-t" ]
```

<span data-ttu-id="bc0c5-343">En este caso, estamos usando una imagen base de Windows Server Core (el valor FROM) y la instalación de IIS con un comando de PowerShell (el valor de ejecución).</span><span class="sxs-lookup"><span data-stu-id="bc0c5-343">In this case, we are using a Windows Server Core base image (the FROM setting) and installing IIS with a PowerShell command (the RUN setting).</span></span> <span data-ttu-id="bc0c5-344">De forma similar, también puede usar comandos de PowerShell para configurar los componentes adicionales como ASP.NET 4.x, .NET 4.6 o cualquier otro software de Windows.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-344">In a similar way, you could also use PowerShell commands to set up additional components like ASP.NET 4.x, .NET 4.6, or any other Windows software.</span></span> <span data-ttu-id="bc0c5-345">Por ejemplo, el siguiente comando en un archivo Dockerfile configura ASP.NET 4.5:</span><span class="sxs-lookup"><span data-stu-id="bc0c5-345">For example, the following command in a Dockerfile sets up ASP.NET 4.5:</span></span>

```
RUN powershell add-windowsfeature web-asp-net45
```

### <a name="additional-resources"></a><span data-ttu-id="bc0c5-346">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="bc0c5-346">Additional resources</span></span>

-   <span data-ttu-id="bc0c5-347">**ASPNET-docker/Dockerfile.**</span><span class="sxs-lookup"><span data-stu-id="bc0c5-347">**aspnet-docker/Dockerfile.**</span></span> <span data-ttu-id="bc0c5-348">Comandos de Powershell de ejemplo para ejecutar desde dockerfiles para incluir características de Windows.</span><span class="sxs-lookup"><span data-stu-id="bc0c5-348">Example Powershell commands to run from dockerfiles to include Windows features.</span></span>
    [<span data-ttu-id="bc0c5-349">*https://github.com/Microsoft/ASPNET-docker/BLOB/Master/4.6.2/Dockerfile*</span><span class="sxs-lookup"><span data-stu-id="bc0c5-349">*https://github.com/Microsoft/aspnet-docker/blob/master/4.6.2/Dockerfile*</span></span>](https://github.com/Microsoft/aspnet-docker/blob/master/4.6.2/Dockerfile)

>[!div class="step-by-step"]
<span data-ttu-id="bc0c5-350">[Anterior] (index.md) [siguiente] (.. / net-core-single-containers-linux-windows-server-hosts/index.md)</span><span class="sxs-lookup"><span data-stu-id="bc0c5-350">[Previous] (index.md) [Next] (../net-core-single-containers-linux-windows-server-hosts/index.md)</span></span>
