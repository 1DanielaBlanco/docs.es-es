---
title: 'Cómo: Agregar la funcionalidad de límite y bloqueo a una colección'
ms.date: 03/30/2017
ms.technology: dotnet-standard
helpviewer_keywords:
- thread-safe collections, custom blocking collections
ms.assetid: 4c2492de-3876-4873-b5a1-000bb404d770
author: mairaw
ms.author: mairaw
ms.openlocfilehash: 3f52d1067a8aa907c8f1cf8b550eec82d1133b3f
ms.sourcegitcommit: 4b6490b2529707627ad77c3a43fbe64120397175
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 09/10/2018
ms.locfileid: "44261751"
---
# <a name="how-to-add-bounding-and-blocking-functionality-to-a-collection"></a><span data-ttu-id="658a8-102">Cómo: Agregar la funcionalidad de límite y bloqueo a una colección</span><span class="sxs-lookup"><span data-stu-id="658a8-102">How to: Add Bounding and Blocking Functionality to a Collection</span></span>
<span data-ttu-id="658a8-103">En este ejemplo se muestra cómo agregar la funcionalidad de límite y bloqueo a una clase de colección personalizada. Para ello, se implementa la interfaz <xref:System.Collections.Concurrent.IProducerConsumerCollection%601?displayProperty=nameWithType> en la clase y, después, se usa una instancia de clase como mecanismo de almacenamiento interno para <xref:System.Collections.Concurrent.BlockingCollection%601?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="658a8-103">This example shows how to add bounding and blocking functionality to a custom collection class by implementing the <xref:System.Collections.Concurrent.IProducerConsumerCollection%601?displayProperty=nameWithType> interface in the class, and then using a class instance as the internal storage mechanism for a <xref:System.Collections.Concurrent.BlockingCollection%601?displayProperty=nameWithType>.</span></span> <span data-ttu-id="658a8-104">Para obtener más información acerca de la funcionalidad de límite y bloqueo, consulte [Información general sobre BlockingCollection](../../../../docs/standard/collections/thread-safe/blockingcollection-overview.md).</span><span class="sxs-lookup"><span data-stu-id="658a8-104">For more information about bounding and blocking, see [BlockingCollection Overview](../../../../docs/standard/collections/thread-safe/blockingcollection-overview.md).</span></span>  
  
## <a name="example"></a><span data-ttu-id="658a8-105">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="658a8-105">Example</span></span>  
 <span data-ttu-id="658a8-106">La clase de colección personalizada es una cola de prioridad básica en la que los niveles de prioridad se representan como una matriz de objetos <xref:System.Collections.Concurrent.ConcurrentQueue%601?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="658a8-106">The custom collection class is a basic priority queue in which the priority levels are represented as an array of <xref:System.Collections.Concurrent.ConcurrentQueue%601?displayProperty=nameWithType> objects.</span></span> <span data-ttu-id="658a8-107">No se realiza ningún orden adicional en cada cola.</span><span class="sxs-lookup"><span data-stu-id="658a8-107">No additional ordering is performed within each queue.</span></span>  
  
 <span data-ttu-id="658a8-108">En el código de cliente, se inician tres tareas.</span><span class="sxs-lookup"><span data-stu-id="658a8-108">In the client code, three tasks are started.</span></span> <span data-ttu-id="658a8-109">La primera tarea se limita a sondear las pulsaciones de teclado para habilitar la cancelación en cualquier momento durante la ejecución.</span><span class="sxs-lookup"><span data-stu-id="658a8-109">The first task just polls for keyboard strokes to enable cancellation at any point during execution.</span></span> <span data-ttu-id="658a8-110">La segunda tarea es el subproceso de productor que agrega nuevos elementos a la colección de bloqueo y proporciona a cada elemento una prioridad basándose en un valor aleatorio.</span><span class="sxs-lookup"><span data-stu-id="658a8-110">The second task is the producer thread; it adds new items to the blocking collection and gives each item a priority based on a random value.</span></span> <span data-ttu-id="658a8-111">La tercera tarea quita elementos de la colección en cuanto estén disponibles.</span><span class="sxs-lookup"><span data-stu-id="658a8-111">The third task removes items from the collection as they become available.</span></span>  
  
 <span data-ttu-id="658a8-112">Puede ajustar el comportamiento de la aplicación haciendo que uno de los subprocesos se ejecute más rápido que el otro.</span><span class="sxs-lookup"><span data-stu-id="658a8-112">You can adjust the behavior of the application by making one of the threads run faster than the other.</span></span> <span data-ttu-id="658a8-113">Si el productor se ejecuta más rápido, observará la funcionalidad de límite porque la colección de bloqueo impide que los elementos se agreguen si ya contiene el número de elementos que se especifican en el constructor.</span><span class="sxs-lookup"><span data-stu-id="658a8-113">If the producer runs faster, you will notice the bounding functionality as the blocking collection prevents items from being added if it already contains the number of items that is specified in the constructor.</span></span> <span data-ttu-id="658a8-114">Si el consumidor se ejecuta más rápido, observará la funcionalidad de bloqueo porque el consumidor espera que se agregue un nuevo elemento.</span><span class="sxs-lookup"><span data-stu-id="658a8-114">If the consumer runs faster, you will notice the blocking functionality as the consumer waits for a new item to be added.</span></span>  
  
 [!code-csharp[CDS_BlockingCollection#06](../../../../samples/snippets/csharp/VS_Snippets_Misc/cds_blockingcollection/cs/prodcon.cs#06)]  
  
 <span data-ttu-id="658a8-115">De forma predeterminada, el almacenamiento de <xref:System.Collections.Concurrent.BlockingCollection%601?displayProperty=nameWithType> es <xref:System.Collections.Concurrent.ConcurrentQueue%601?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="658a8-115">By default, the storage for a <xref:System.Collections.Concurrent.BlockingCollection%601?displayProperty=nameWithType> is <xref:System.Collections.Concurrent.ConcurrentQueue%601?displayProperty=nameWithType>.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="658a8-116">Vea también</span><span class="sxs-lookup"><span data-stu-id="658a8-116">See also</span></span>

- [<span data-ttu-id="658a8-117">Colecciones seguras para subprocesos</span><span class="sxs-lookup"><span data-stu-id="658a8-117">Thread-Safe Collections</span></span>](../../../../docs/standard/collections/thread-safe/index.md)
