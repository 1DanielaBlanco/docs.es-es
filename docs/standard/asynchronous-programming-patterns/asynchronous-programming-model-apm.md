---
title: Modelo de programación asincrónica (APM)
ms.date: 03/30/2017
ms.technology: dotnet-standard
helpviewer_keywords:
- ending asynchronous operations
- starting asynchronous operations
- beginning asynchronous operations
- asynchronous programming, ending operations
- asynchronous programming
- stopping asynchronous operations
- asynchronous programming, beginning operations
ms.assetid: c9b3501e-6bc6-40f9-8efd-4b6d9e39ccf0
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 5cd2fa6219f39a8506d865d85e1ce5f84d22a92f
ms.sourcegitcommit: 4b6490b2529707627ad77c3a43fbe64120397175
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 09/10/2018
ms.locfileid: "44269038"
---
# <a name="asynchronous-programming-model-apm"></a><span data-ttu-id="2f23a-102">Modelo de programación asincrónica (APM)</span><span class="sxs-lookup"><span data-stu-id="2f23a-102">Asynchronous Programming Model (APM)</span></span>
<span data-ttu-id="2f23a-103">Una operación asincrónica que usa el patrón de diseño <xref:System.IAsyncResult> se implementa como dos métodos con nombre \**Begin\*\*\*OperationName* y \**End\*\*\*OperationName* que comienzan y terminan la operación asincrónica *OperationName* respectivamente.</span><span class="sxs-lookup"><span data-stu-id="2f23a-103">An asynchronous operation that uses the <xref:System.IAsyncResult> design pattern is implemented as two methods named \**Begin\*\*\*OperationName* and \**End\*\*\*OperationName* that begin and end the asynchronous operation *OperationName* respectively.</span></span> <span data-ttu-id="2f23a-104">Por ejemplo, la clase <xref:System.IO.FileStream> ofrece los métodos <xref:System.IO.FileStream.BeginRead%2A> y <xref:System.IO.FileStream.EndRead%2A> para leer bytes de un archivo de manera asincrónica.</span><span class="sxs-lookup"><span data-stu-id="2f23a-104">For example, the <xref:System.IO.FileStream> class provides the <xref:System.IO.FileStream.BeginRead%2A> and <xref:System.IO.FileStream.EndRead%2A> methods to asynchronously read bytes from a file.</span></span> <span data-ttu-id="2f23a-105">Estos métodos implementan la versión asincrónica del método <xref:System.IO.FileStream.Read%2A> .</span><span class="sxs-lookup"><span data-stu-id="2f23a-105">These methods implement the asynchronous version of the <xref:System.IO.FileStream.Read%2A> method.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2f23a-106">A partir de .NET Framework 4, la biblioteca TPL (Task Parallel Library, biblioteca de procesamiento paralelo basado en tareas) ofrece un nuevo modelo para programación asincrónica y paralela.</span><span class="sxs-lookup"><span data-stu-id="2f23a-106">Starting with the .NET Framework 4, the Task Parallel Library provides a new model for asynchronous and parallel programming.</span></span> <span data-ttu-id="2f23a-107">Para obtener más información, vea [Task Parallel Library (TPL)](../../../docs/standard/parallel-programming/task-parallel-library-tpl.md) y [Task-based Asynchronous Pattern (TAP)](../../../docs/standard/asynchronous-programming-patterns/task-based-asynchronous-pattern-tap.md).</span><span class="sxs-lookup"><span data-stu-id="2f23a-107">For more information, see [Task Parallel Library (TPL)](../../../docs/standard/parallel-programming/task-parallel-library-tpl.md) and [Task-based Asynchronous Pattern (TAP)](../../../docs/standard/asynchronous-programming-patterns/task-based-asynchronous-pattern-tap.md)).</span></span>  
  
 <span data-ttu-id="2f23a-108">Después de llamar a *Begin\*\*\*OperationName*, una aplicación puede seguir ejecutando instrucciones en el subproceso de llamada mientras la operación asincrónica tiene lugar en un subproceso diferente.</span><span class="sxs-lookup"><span data-stu-id="2f23a-108">After calling \**Begin\*\*\*OperationName*, an application can continue executing instructions on the calling thread while the asynchronous operation takes place on a different thread.</span></span> <span data-ttu-id="2f23a-109">Por cada llamada a \**Begin\*\*\*OperationName*, la aplicación debe llamar a \**End\*\*\*OperationName* para obtener los resultados de la operación.</span><span class="sxs-lookup"><span data-stu-id="2f23a-109">For each call to \**Begin\*\*\*OperationName*, the application should also call \**End\*\*\*OperationName* to get the results of the operation.</span></span>  
  
## <a name="beginning-an-asynchronous-operation"></a><span data-ttu-id="2f23a-110">Comenzar una operación asincrónica</span><span class="sxs-lookup"><span data-stu-id="2f23a-110">Beginning an Asynchronous Operation</span></span>  
 <span data-ttu-id="2f23a-111">El método \**Begin\*\*\*OperationName* comienza la operación asincrónica *OperationName* y devuelve un objeto que implementa la interfaz <xref:System.IAsyncResult>.</span><span class="sxs-lookup"><span data-stu-id="2f23a-111">The \**Begin\*\*\*OperationName* method begins asynchronous operation *OperationName* and returns an object that implements the <xref:System.IAsyncResult> interface.</span></span> <span data-ttu-id="2f23a-112">Los objetos<xref:System.IAsyncResult> almacenan información sobre una operación asincrónica.</span><span class="sxs-lookup"><span data-stu-id="2f23a-112"><xref:System.IAsyncResult> objects store information about an asynchronous operation.</span></span> <span data-ttu-id="2f23a-113">En la tabla siguiente se muestra información sobre una operación asincrónica.</span><span class="sxs-lookup"><span data-stu-id="2f23a-113">The following table shows information about an asynchronous operation.</span></span>  
  
|<span data-ttu-id="2f23a-114">Miembro</span><span class="sxs-lookup"><span data-stu-id="2f23a-114">Member</span></span>|<span data-ttu-id="2f23a-115">Descripción</span><span class="sxs-lookup"><span data-stu-id="2f23a-115">Description</span></span>|  
|------------|-----------------|  
|<xref:System.IAsyncResult.AsyncState%2A>|<span data-ttu-id="2f23a-116">Objeto opcional específico de la aplicación que contiene información sobre la operación asincrónica.</span><span class="sxs-lookup"><span data-stu-id="2f23a-116">An optional application-specific object that contains information about the asynchronous operation.</span></span>|  
|<xref:System.IAsyncResult.AsyncWaitHandle%2A>|<span data-ttu-id="2f23a-117">Un <xref:System.Threading.WaitHandle> que se puede usar para bloquear la ejecución de la aplicación hasta que se complete la operación asincrónica.</span><span class="sxs-lookup"><span data-stu-id="2f23a-117">A <xref:System.Threading.WaitHandle> that can be used to block application execution until the asynchronous operation completes.</span></span>|  
|<xref:System.IAsyncResult.CompletedSynchronously%2A>|<span data-ttu-id="2f23a-118">Un valor que indica si la operación asincrónica se completó en el subproceso usado para llamar a \**Begin\*\*\*OperationName* en lugar de completarse en otro subproceso <xref:System.Threading.ThreadPool>.</span><span class="sxs-lookup"><span data-stu-id="2f23a-118">A value that indicates whether the asynchronous operation completed on the thread used to call \**Begin\*\*\*OperationName* instead of completing on a separate <xref:System.Threading.ThreadPool> thread.</span></span>|  
|<xref:System.IAsyncResult.IsCompleted%2A>|<span data-ttu-id="2f23a-119">Un valor que indica si se ha completado la operación asincrónica.</span><span class="sxs-lookup"><span data-stu-id="2f23a-119">A value that indicates whether the asynchronous operation has completed.</span></span>|  
  
 <span data-ttu-id="2f23a-120">Un método \**Begin\*\*\*OperationName* toma los parámetros declarados en la firma de la versión sincrónica del método que se pasan por valor o por referencia.</span><span class="sxs-lookup"><span data-stu-id="2f23a-120">A \**Begin\*\*\*OperationName* method takes any parameters declared in the signature of the synchronous version of the method that are passed by value or by reference.</span></span> <span data-ttu-id="2f23a-121">Los parámetros out no forman parte de la firma del método \**Begin\*\*\*OperationName*.</span><span class="sxs-lookup"><span data-stu-id="2f23a-121">Any out parameters are not part of the \**Begin\*\*\*OperationName* method signature.</span></span> <span data-ttu-id="2f23a-122">La firma del método \**Begin\*\*\*OperationName* también incluye dos parámetros más.</span><span class="sxs-lookup"><span data-stu-id="2f23a-122">The \**Begin\*\*\*OperationName* method signature also includes two additional parameters.</span></span> <span data-ttu-id="2f23a-123">El primero de estos define un delegado <xref:System.AsyncCallback> que hace referencia a un método al que se llama cuando se completa la operación asincrónica.</span><span class="sxs-lookup"><span data-stu-id="2f23a-123">The first of these defines an <xref:System.AsyncCallback> delegate that references a method that is called when the asynchronous operation completes.</span></span> <span data-ttu-id="2f23a-124">El llamador puede especificar `null` (`Nothing` en Visual Basic) si no quiere un método invocado cuando finalice la operación.</span><span class="sxs-lookup"><span data-stu-id="2f23a-124">The caller can specify `null` (`Nothing` in Visual Basic) if it does not want a method invoked when the operation completes.</span></span> <span data-ttu-id="2f23a-125">El segundo parámetro adicional es un objeto definido por el usuario.</span><span class="sxs-lookup"><span data-stu-id="2f23a-125">The second additional parameter is a user-defined object.</span></span> <span data-ttu-id="2f23a-126">Este objeto se puede usar para pasar información de estado específica de la aplicación al método invocado cuando finaliza la operación asincrónica.</span><span class="sxs-lookup"><span data-stu-id="2f23a-126">This object can be used to pass application-specific state information to the method invoked when the asynchronous operation completes.</span></span> <span data-ttu-id="2f23a-127">Si un método \**Begin\*\*\*OperationName* toma más parámetros específicos de operación, como una matriz de bytes para almacenar los bytes leídos de un archivo, el <xref:System.AsyncCallback> y el objeto de estado de la aplicación son los últimos parámetros de la firma del método \**Begin\*\*\*OperationName*.</span><span class="sxs-lookup"><span data-stu-id="2f23a-127">If a \**Begin\*\*\*OperationName* method takes additional operation-specific parameters, such as a byte array to store bytes read from a file, the <xref:System.AsyncCallback> and application state object are the last parameters in the \**Begin\*\*\*OperationName* method signature.</span></span>  
  
 <span data-ttu-id="2f23a-128">\**Begin\*\*\*OperationName* devuelve el control inmediatamente al subproceso de llamada.</span><span class="sxs-lookup"><span data-stu-id="2f23a-128">\**Begin\*\*\*OperationName* returns control to the calling thread immediately.</span></span> <span data-ttu-id="2f23a-129">Si el método \**Begin\*\*\*OperationName* genera excepciones, las excepciones se generan antes de iniciarse la operación asincrónica.</span><span class="sxs-lookup"><span data-stu-id="2f23a-129">If the \**Begin\*\*\*OperationName* method throws exceptions, the exceptions are thrown before the asynchronous operation is started.</span></span> <span data-ttu-id="2f23a-130">Si el método \**Begin\*\*\*OperationName* genera excepciones, no se invoca el método de devolución de llamada.</span><span class="sxs-lookup"><span data-stu-id="2f23a-130">If the \**Begin\*\*\*OperationName* method throws exceptions, the callback method is not invoked.</span></span>  
  
## <a name="ending-an-asynchronous-operation"></a><span data-ttu-id="2f23a-131">Finalizar una operación asincrónica</span><span class="sxs-lookup"><span data-stu-id="2f23a-131">Ending an Asynchronous Operation</span></span>  
 <span data-ttu-id="2f23a-132">El método \**End\*\*\*OperationName* finaliza la operación asincrónica *OperationName*.</span><span class="sxs-lookup"><span data-stu-id="2f23a-132">The \**End\*\*\*OperationName* method ends asynchronous operation *OperationName*.</span></span> <span data-ttu-id="2f23a-133">El valor devuelto del método \**End\*\*\*OperationName* es del mismo tipo devuelto por su homólogo sincrónico y es específico de la operación asincrónica.</span><span class="sxs-lookup"><span data-stu-id="2f23a-133">The return value of the \**End\*\*\*OperationName* method is the same type returned by its synchronous counterpart and is specific to the asynchronous operation.</span></span> <span data-ttu-id="2f23a-134">Por ejemplo, el método <xref:System.IO.FileStream.EndRead%2A> devuelve el número de bytes leídos de un <xref:System.IO.FileStream> y el método <xref:System.Net.Dns.EndGetHostByName%2A> devuelve un objeto <xref:System.Net.IPHostEntry> que contiene información sobre un equipo host.</span><span class="sxs-lookup"><span data-stu-id="2f23a-134">For example, the <xref:System.IO.FileStream.EndRead%2A> method returns the number of bytes read from a <xref:System.IO.FileStream> and the <xref:System.Net.Dns.EndGetHostByName%2A> method returns an <xref:System.Net.IPHostEntry> object that contains information about a host computer.</span></span> <span data-ttu-id="2f23a-135">El método \**End\*\*\*OperationName* toma los parámetros out o ref declarados en la firma de la versión sincrónica del método.</span><span class="sxs-lookup"><span data-stu-id="2f23a-135">The \**End\*\*\*OperationName* method takes any out or ref parameters declared in the signature of the synchronous version of the method.</span></span> <span data-ttu-id="2f23a-136">Además de los parámetros del método sincrónico, el método \**End\*\*\*OperationName* incluye también un parámetro <xref:System.IAsyncResult>.</span><span class="sxs-lookup"><span data-stu-id="2f23a-136">In addition to the parameters from the synchronous method, the \**End\*\*\*OperationName* method also includes an <xref:System.IAsyncResult> parameter.</span></span> <span data-ttu-id="2f23a-137">Los llamadores deben pasar la instancia devuelta por la llamada correspondiente a \**Begin\*\*\*OperationName*.</span><span class="sxs-lookup"><span data-stu-id="2f23a-137">Callers must pass the instance returned by the corresponding call to \**Begin\*\*\*OperationName*.</span></span>  
  
 <span data-ttu-id="2f23a-138">Si la operación asincrónica representada por el objeto <xref:System.IAsyncResult> no ha finalizado cuando se llama a \**End\*\*\*OperationName*, \**End\*\*\*OperationName* bloquea el subproceso de llamada hasta que finalice la operación asincrónica.</span><span class="sxs-lookup"><span data-stu-id="2f23a-138">If the asynchronous operation represented by the <xref:System.IAsyncResult> object has not completed when \**End\*\*\*OperationName* is called, \**End\*\*\*OperationName* blocks the calling thread until the asynchronous operation is complete.</span></span> <span data-ttu-id="2f23a-139">Las excepciones generadas por la operación asincrónica se generan desde el método \**End\*\*\*OperationName*.</span><span class="sxs-lookup"><span data-stu-id="2f23a-139">Exceptions thrown by the asynchronous operation are thrown from the \**End\*\*\*OperationName* method.</span></span> <span data-ttu-id="2f23a-140">El efecto de llamar al método \**End\*\*\*OperationName* varias veces con el mismo <xref:System.IAsyncResult> no está definido.</span><span class="sxs-lookup"><span data-stu-id="2f23a-140">The effect of calling the \**End\*\*\*OperationName* method multiple times with the same <xref:System.IAsyncResult> is not defined.</span></span> <span data-ttu-id="2f23a-141">Del mismo modo, tampoco se ha definido la llamada al método \**End\*\*\*OperationName* con un <xref:System.IAsyncResult> que no fue devuelto por Begin relacionado.</span><span class="sxs-lookup"><span data-stu-id="2f23a-141">Likewise, calling the \**End\*\*\*OperationName* method with an <xref:System.IAsyncResult> that was not returned by the related Begin method is also not defined.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2f23a-142">En cualquiera de los escenarios sin definir, los implementadores deben considerar generar <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="2f23a-142">For either of the undefined scenarios, implementers should consider throwing <xref:System.InvalidOperationException>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2f23a-143">Los implementadores de este patrón de diseño deben notificar al llamador que ha completado la operación asincrónica estableciendo <xref:System.IAsyncResult.IsCompleted%2A> en true, llamando al método de devolución de llamada asincrónica (si se especificó) y señalizando el <xref:System.IAsyncResult.AsyncWaitHandle%2A>.</span><span class="sxs-lookup"><span data-stu-id="2f23a-143">Implementers of this design pattern should notify the caller that the asynchronous operation completed by setting <xref:System.IAsyncResult.IsCompleted%2A> to true, calling the asynchronous callback method (if one was specified) and signaling the <xref:System.IAsyncResult.AsyncWaitHandle%2A>.</span></span>  
  
 <span data-ttu-id="2f23a-144">Los desarrolladores de aplicaciones tienen varias opciones de diseño para tener acceso a los resultados de la operación asincrónica.</span><span class="sxs-lookup"><span data-stu-id="2f23a-144">Application developers have several design choices for accessing the results of the asynchronous operation.</span></span> <span data-ttu-id="2f23a-145">La opción correcta depende de si la aplicación tiene instrucciones que se pueden ejecutar mientras se completa la operación.</span><span class="sxs-lookup"><span data-stu-id="2f23a-145">The correct choice depends on whether the application has instructions that can execute while the operation completes.</span></span> <span data-ttu-id="2f23a-146">Si una aplicación no puede realizar ningún trabajo adicional hasta que recibe los resultados de la operación asincrónica, debe bloquearse la aplicación hasta que los resultados estén disponibles.</span><span class="sxs-lookup"><span data-stu-id="2f23a-146">If an application cannot perform any additional work until it receives the results of the asynchronous operation, the application must block until the results are available.</span></span> <span data-ttu-id="2f23a-147">Para bloquear hasta que finalice una operación asincrónica, puede usar uno de los siguientes enfoques:</span><span class="sxs-lookup"><span data-stu-id="2f23a-147">To block until an asynchronous operation completes, you can use one of the following approaches:</span></span>  
  
-   <span data-ttu-id="2f23a-148">Llame a \**End\*\*\*OperationName* desde el subproceso principal de la aplicación, bloqueando la ejecución de la aplicación hasta que finalice la operación.</span><span class="sxs-lookup"><span data-stu-id="2f23a-148">Call \**End\*\*\*OperationName* from the application’s main thread, blocking application execution until the operation is complete.</span></span> <span data-ttu-id="2f23a-149">Para ver un ejemplo que ilustre esta técnica, consulte [Bloquear la ejecución de una aplicación al finalizar una operación asincrónica](../../../docs/standard/asynchronous-programming-patterns/blocking-application-execution-by-ending-an-async-operation.md).</span><span class="sxs-lookup"><span data-stu-id="2f23a-149">For an example that illustrates this technique, see [Blocking Application Execution by Ending an Async Operation](../../../docs/standard/asynchronous-programming-patterns/blocking-application-execution-by-ending-an-async-operation.md).</span></span>  
  
-   <span data-ttu-id="2f23a-150">Use el <xref:System.IAsyncResult.AsyncWaitHandle%2A> para bloquear la ejecución de aplicaciones hasta que se completen una o más operaciones.</span><span class="sxs-lookup"><span data-stu-id="2f23a-150">Use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> to block application execution until one or more operations are complete.</span></span> <span data-ttu-id="2f23a-151">Para ver un ejemplo que ilustre esta técnica, consulte [Blocking Application Execution Using an AsyncWaitHandle](../../../docs/standard/asynchronous-programming-patterns/blocking-application-execution-using-an-asyncwaithandle.md).</span><span class="sxs-lookup"><span data-stu-id="2f23a-151">For an example that illustrates this technique, see [Blocking Application Execution Using an AsyncWaitHandle](../../../docs/standard/asynchronous-programming-patterns/blocking-application-execution-using-an-asyncwaithandle.md).</span></span>  
  
 <span data-ttu-id="2f23a-152">Las aplicaciones que no necesiten bloquear mientras se completa la operación asincrónica pueden usar uno de los siguientes métodos:</span><span class="sxs-lookup"><span data-stu-id="2f23a-152">Applications that do not need to block while the asynchronous operation completes can use one of the following approaches:</span></span>  
  
-   <span data-ttu-id="2f23a-153">Sondee el estado de finalización de la operación activando la propiedad <xref:System.IAsyncResult.IsCompleted%2A> periódicamente y llamando a \**End\*\*\*OperationName* cuando finalice la operación.</span><span class="sxs-lookup"><span data-stu-id="2f23a-153">Poll for operation completion status by checking the <xref:System.IAsyncResult.IsCompleted%2A> property periodically and calling \**End\*\*\*OperationName* when the operation is complete.</span></span> <span data-ttu-id="2f23a-154">Para ver un ejemplo que ilustre esta técnica, consulte [Sondear el estado de una operación asincrónica](../../../docs/standard/asynchronous-programming-patterns/polling-for-the-status-of-an-asynchronous-operation.md).</span><span class="sxs-lookup"><span data-stu-id="2f23a-154">For an example that illustrates this technique, see [Polling for the Status of an Asynchronous Operation](../../../docs/standard/asynchronous-programming-patterns/polling-for-the-status-of-an-asynchronous-operation.md).</span></span>  
  
-   <span data-ttu-id="2f23a-155">Use un delegado <xref:System.AsyncCallback> para especificar un método que se debe invocar cuando finalice la operación.</span><span class="sxs-lookup"><span data-stu-id="2f23a-155">Use an <xref:System.AsyncCallback> delegate to specify a method to be invoked when the operation is complete.</span></span> <span data-ttu-id="2f23a-156">Para ver un ejemplo que ilustre esta técnica, consulte [Utilizar un delegado AsyncCallback para finalizar una operación asincrónica](../../../docs/standard/asynchronous-programming-patterns/using-an-asynccallback-delegate-to-end-an-asynchronous-operation.md).</span><span class="sxs-lookup"><span data-stu-id="2f23a-156">For an example that illustrates this technique, see [Using an AsyncCallback Delegate to End an Asynchronous Operation](../../../docs/standard/asynchronous-programming-patterns/using-an-asynccallback-delegate-to-end-an-asynchronous-operation.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2f23a-157">Vea también</span><span class="sxs-lookup"><span data-stu-id="2f23a-157">See also</span></span>

- [<span data-ttu-id="2f23a-158">Modelo asincrónico basado en eventos (EAP)</span><span class="sxs-lookup"><span data-stu-id="2f23a-158">Event-based Asynchronous Pattern (EAP)</span></span>](../../../docs/standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-eap.md)  
- [<span data-ttu-id="2f23a-159">Llamada a métodos sincrónicos de forma asincrónica</span><span class="sxs-lookup"><span data-stu-id="2f23a-159">Calling Synchronous Methods Asynchronously</span></span>](../../../docs/standard/asynchronous-programming-patterns/calling-synchronous-methods-asynchronously.md)  
- [<span data-ttu-id="2f23a-160">Utilizar un delegado AsyncCallback y un objeto State</span><span class="sxs-lookup"><span data-stu-id="2f23a-160">Using an AsyncCallback Delegate and State Object</span></span>](../../../docs/standard/asynchronous-programming-patterns/using-an-asynccallback-delegate-and-state-object.md)
