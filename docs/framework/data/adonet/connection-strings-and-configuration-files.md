---
title: "Cadenas de conexión y archivos de configuración"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
ms.assetid: 37df2641-661e-407a-a3fb-7bf9540f01e8
caps.latest.revision: "4"
author: JennieHubbard
ms.author: jhubbard
manager: jhubbard
ms.openlocfilehash: fe56dc279471f77a3f9ae014f65faaa99a113624
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/21/2017
---
# <a name="connection-strings-and-configuration-files"></a><span data-ttu-id="62b4b-102">Cadenas de conexión y archivos de configuración</span><span class="sxs-lookup"><span data-stu-id="62b4b-102">Connection Strings and Configuration Files</span></span>
<span data-ttu-id="62b4b-103">La incrustación de cadenas de conexión en el código de la aplicación puede producir vulnerabilidades en la seguridad y problemas de mantenimiento.</span><span class="sxs-lookup"><span data-stu-id="62b4b-103">Embedding connection strings in your application's code can lead to security vulnerabilities and maintenance problems.</span></span> <span data-ttu-id="62b4b-104">Las cadenas de conexión sin cifrar compiladas en el código de origen de una aplicación pueden verse mediante la [Ildasm.exe (Desensamblador de IL)](../../../../docs/framework/tools/ildasm-exe-il-disassembler.md) herramienta.</span><span class="sxs-lookup"><span data-stu-id="62b4b-104">Unencrypted connection strings compiled into an application's source code can be viewed using the [Ildasm.exe (IL Disassembler)](../../../../docs/framework/tools/ildasm-exe-il-disassembler.md) tool.</span></span> <span data-ttu-id="62b4b-105">Además, si la cadena de conexión cambia en algún momento, será necesario compilar de nuevo la aplicación.</span><span class="sxs-lookup"><span data-stu-id="62b4b-105">Moreover, if the connection string ever changes, your application must be recompiled.</span></span> <span data-ttu-id="62b4b-106">Por estas razones, se recomienda almacenar las cadenas de conexión en un archivo de configuración de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="62b4b-106">For these reasons, we recommend storing connection strings in an application configuration file.</span></span>  
  
## <a name="working-with-application-configuration-files"></a><span data-ttu-id="62b4b-107">Trabajar con archivos de configuración de la aplicación</span><span class="sxs-lookup"><span data-stu-id="62b4b-107">Working with Application Configuration Files</span></span>  
 <span data-ttu-id="62b4b-108">Los archivos de configuración de la aplicación contienen valores específicos de una aplicación determinada.</span><span class="sxs-lookup"><span data-stu-id="62b4b-108">Application configuration files contain settings that are specific to a particular application.</span></span> <span data-ttu-id="62b4b-109">Por ejemplo, una aplicación ASP.NET puede tener uno o más **web.config** archivos y una aplicación de Windows pueden tener un elemento opcional **app.config** archivo.</span><span class="sxs-lookup"><span data-stu-id="62b4b-109">For example, an ASP.NET application can have one or more **web.config** files, and a Windows application can have an optional **app.config** file.</span></span> <span data-ttu-id="62b4b-110">Los archivos de configuración comparten elementos comunes, aunque su nombre y ubicación varían en función del host de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="62b4b-110">Configuration files share common elements, although the name and location of a configuration file vary depending on the application's host.</span></span>  
  
### <a name="the-connectionstrings-section"></a><span data-ttu-id="62b4b-111">Sección connectionStrings</span><span class="sxs-lookup"><span data-stu-id="62b4b-111">The connectionStrings Section</span></span>  
 <span data-ttu-id="62b4b-112">Las cadenas de conexión se pueden almacenar como pares de clave/valor en el **connectionStrings** sección de la **configuración** elemento de un archivo de configuración de aplicación.</span><span class="sxs-lookup"><span data-stu-id="62b4b-112">Connection strings can be stored as key/value pairs in the **connectionStrings** section of the **configuration** element of an application configuration file.</span></span> <span data-ttu-id="62b4b-113">Los elementos secundarios incluyen **agregar**, **borrar**, y **quitar**.</span><span class="sxs-lookup"><span data-stu-id="62b4b-113">Child elements include **add**, **clear**, and **remove**.</span></span>  
  
 <span data-ttu-id="62b4b-114">El siguiente fragmento del archivo de configuración muestra el esquema y la sintaxis para almacenar una cadena de conexión.</span><span class="sxs-lookup"><span data-stu-id="62b4b-114">The following configuration file fragment demonstrates the schema and syntax for storing a connection string.</span></span> <span data-ttu-id="62b4b-115">El **nombre** atributo es un nombre que se proporciona para identificar de forma única una cadena de conexión para que se puede recuperar en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="62b4b-115">The **name** attribute is a name that you provide to uniquely identify a connection string so that it can be retrieved at run time.</span></span> <span data-ttu-id="62b4b-116">El **providerName** es el nombre invariable del proveedor de datos de .NET Framework, que está registrado en el archivo machine.config.</span><span class="sxs-lookup"><span data-stu-id="62b4b-116">The **providerName** is the invariant name of the .NET Framework data provider, which is registered in the machine.config file.</span></span>  
  
```xml  
<?xml version='1.0' encoding='utf-8'?>  
  <configuration>  
    <connectionStrings>  
      <clear />  
      <add name="Name"   
       providerName="System.Data.ProviderName"   
       connectionString="Valid Connection String;" />  
    </connectionStrings>  
  </configuration>  
```  
  
> [!NOTE]
>  <span data-ttu-id="62b4b-117">Puede guardar parte de la cadena de conexión en un archivo de configuración y usar la clase <xref:System.Data.Common.DbConnectionStringBuilder> para completarla en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="62b4b-117">You can save part of a connection string in a configuration file and use the <xref:System.Data.Common.DbConnectionStringBuilder> class to complete it at run time.</span></span> <span data-ttu-id="62b4b-118">Esto resulta útil en escenarios en los que no se conocen los elementos de la cadena de conexión por anticipado o cuando no desea guardar información confidencial en un archivo de configuración.</span><span class="sxs-lookup"><span data-stu-id="62b4b-118">This is useful in scenarios where you do not know elements of the connection string ahead of time, or when you do not want to save sensitive information in a configuration file.</span></span> <span data-ttu-id="62b4b-119">Para obtener más información, consulte [generadores de cadenas de conexión](../../../../docs/framework/data/adonet/connection-string-builders.md).</span><span class="sxs-lookup"><span data-stu-id="62b4b-119">For more information, see [Connection String Builders](../../../../docs/framework/data/adonet/connection-string-builders.md).</span></span>  
  
### <a name="using-external-configuration-files"></a><span data-ttu-id="62b4b-120">Uso de archivos de configuración externos</span><span class="sxs-lookup"><span data-stu-id="62b4b-120">Using External Configuration Files</span></span>  
 <span data-ttu-id="62b4b-121">Los archivos de configuración externos son archivos independientes que contienen un fragmento de un archivo de configuración compuesto de una sola sección.</span><span class="sxs-lookup"><span data-stu-id="62b4b-121">External configuration files are separate files that contain a fragment of a configuration file consisting of a single section.</span></span> <span data-ttu-id="62b4b-122">El archivo de configuración principal hace referencia al archivo de configuración externo.</span><span class="sxs-lookup"><span data-stu-id="62b4b-122">The external configuration file is then referenced by the main configuration file.</span></span> <span data-ttu-id="62b4b-123">Almacenar el **connectionStrings** sección en un archivo físicamente independiente resulta útil en situaciones donde se pueden editar las cadenas de conexión una vez implementada la aplicación.</span><span class="sxs-lookup"><span data-stu-id="62b4b-123">Storing the **connectionStrings** section in a physically separate file is useful in situations where connection strings may be edited after the application is deployed.</span></span> <span data-ttu-id="62b4b-124">Por ejemplo, si se modifican los archivos de configuración, ASP.NET reinicia de forma predeterminada el dominio de la aplicación, lo que provoca la pérdida de la información de estado.</span><span class="sxs-lookup"><span data-stu-id="62b4b-124">For example, the standard ASP.NET behavior is to restart an application domain when configuration files are modified, which results in state information being lost.</span></span> <span data-ttu-id="62b4b-125">Sin embargo, la modificación de un archivo de configuración externo no provoca el reinicio de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="62b4b-125">However, modifying an external configuration file does not cause an application restart.</span></span> <span data-ttu-id="62b4b-126">Los archivos de configuración externos no se limitan a ASP.NET; también se pueden utilizar en aplicaciones Windows.</span><span class="sxs-lookup"><span data-stu-id="62b4b-126">External configuration files are not limited to ASP.NET; they can also be used by Windows applications.</span></span> <span data-ttu-id="62b4b-127">Además, la seguridad y permisos de acceso a los archivos se pueden usar para restringir el acceso a los archivos de configuración externos.</span><span class="sxs-lookup"><span data-stu-id="62b4b-127">In addition, file access security and permissions can be used to restrict access to external configuration files.</span></span> <span data-ttu-id="62b4b-128">El trabajo con archivos de configuración externos en tiempo de ejecución es transparente y no requiere código especial.</span><span class="sxs-lookup"><span data-stu-id="62b4b-128">Working with external configuration files at run time is transparent, and requires no special coding.</span></span>  
  
 <span data-ttu-id="62b4b-129">Para almacenar cadenas de conexión en un archivo de configuración externo, cree un archivo independiente que contiene únicamente el **connectionStrings** sección.</span><span class="sxs-lookup"><span data-stu-id="62b4b-129">To store connection strings in an external configuration file, create a separate file that contains only the **connectionStrings** section.</span></span> <span data-ttu-id="62b4b-130">No incluya elementos, secciones ni atributos adicionales.</span><span class="sxs-lookup"><span data-stu-id="62b4b-130">Do not include any additional elements, sections, or attributes.</span></span> <span data-ttu-id="62b4b-131">En este ejemplo se muestra la sintaxis de un archivo de configuración externo.</span><span class="sxs-lookup"><span data-stu-id="62b4b-131">This example shows the syntax for an external configuration file.</span></span>  
  
```xml  
<connectionStrings>  
  <add name="Name"   
   providerName="System.Data.ProviderName"   
   connectionString="Valid Connection String;" />  
</connectionStrings>  
```  
  
 <span data-ttu-id="62b4b-132">En el archivo de configuración de la aplicación principal, use la **configSource** atributo para especificar el nombre completo y la ubicación del archivo externo.</span><span class="sxs-lookup"><span data-stu-id="62b4b-132">In the main application configuration file, you use the **configSource** attribute to specify the fully qualified name and location of the external file.</span></span> <span data-ttu-id="62b4b-133">En este ejemplo se hace referencia a un archivo de configuración externo denominado `connections.config`.</span><span class="sxs-lookup"><span data-stu-id="62b4b-133">This example refers to an external configuration file named `connections.config`.</span></span>  
  
```xml  
<?xml version='1.0' encoding='utf-8'?>  
<configuration>  
    <connectionStrings configSource="connections.config"/>  
</configuration>  
```  
  
## <a name="retrieving-connection-strings-at-run-time"></a><span data-ttu-id="62b4b-134">Recuperar cadenas de conexión en tiempo de ejecución</span><span class="sxs-lookup"><span data-stu-id="62b4b-134">Retrieving Connection Strings at Run Time</span></span>  
 <span data-ttu-id="62b4b-135">.NET Framework 2.0 incorpora nuevas clases en el espacio de nombres <xref:System.Configuration> para simplificar la recuperación de las cadenas de conexión de los archivos de configuración en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="62b4b-135">The .NET Framework 2.0 introduced new classes in the <xref:System.Configuration> namespace to simplify retrieving connection strings from configuration files at run time.</span></span> <span data-ttu-id="62b4b-136">La cadena de conexión se puede recuperar mediante programación con el nombre de la cadena o el nombre de proveedor.</span><span class="sxs-lookup"><span data-stu-id="62b4b-136">You can programmatically retrieve a connection string by name or by provider name.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="62b4b-137">El **machine.config** archivo también contiene un **connectionStrings** sección, que contiene las cadenas de conexión utilizadas por Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="62b4b-137">The **machine.config** file also contains a **connectionStrings** section, which contains connection strings used by Visual Studio.</span></span> <span data-ttu-id="62b4b-138">Al recuperar cadenas de conexión mediante el nombre del proveedor de la **app.config** archivo en una aplicación de Windows, las cadenas de conexión **machine.config** obtener cargar primero y, a continuación, las entradas de **app.config**. Agregar **borrar** inmediatamente después de la **connectionStrings** elemento quita todas las referencias heredadas de la estructura de datos en la memoria, por lo que solo las cadenas de conexión definen en la variable local **app.config** se consideran archivos.</span><span class="sxs-lookup"><span data-stu-id="62b4b-138">When retrieving connection strings by provider name from the **app.config** file in a Windows application, the connection strings in **machine.config** get loaded first, and then the entries from **app.config**. Adding **clear** immediately after the **connectionStrings** element removes all inherited references from the data structure in memory, so that only the connection strings defined in the local **app.config** file are considered.</span></span>  
  
### <a name="working-with-the-configuration-classes"></a><span data-ttu-id="62b4b-139">Trabajar con clases de configuración</span><span class="sxs-lookup"><span data-stu-id="62b4b-139">Working with the Configuration Classes</span></span>  
 <span data-ttu-id="62b4b-140">A partir de .NET Framework 2.0, se usa el elemento <xref:System.Configuration.ConfigurationManager> al trabajar con archivos de configuración en el equipo local, reemplazando al elemento desusado <xref:System.Configuration.ConfigurationSettings>.</span><span class="sxs-lookup"><span data-stu-id="62b4b-140">Starting with the .NET Framework 2.0, <xref:System.Configuration.ConfigurationManager> is used when working with configuration files on the local computer, replacing the deprecated <xref:System.Configuration.ConfigurationSettings>.</span></span> <span data-ttu-id="62b4b-141"><xref:System.Web.Configuration.WebConfigurationManager> se usa para trabajar con archivos de configuración de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="62b4b-141"><xref:System.Web.Configuration.WebConfigurationManager> is used to work with ASP.NET configuration files.</span></span> <span data-ttu-id="62b4b-142">Está diseñado para trabajar con archivos de configuración en un servidor Web y permite el acceso mediante programación a secciones del archivo de configuración como **system.web**.</span><span class="sxs-lookup"><span data-stu-id="62b4b-142">It is designed to work with configuration files on a Web server, and allows programmatic access to configuration file sections such as **system.web**.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="62b4b-143">El acceso a los archivos de configuración en tiempo de ejecución requiere la concesión de permisos al llamador; los permisos necesarios dependen del tipo de aplicación, del archivo de configuración y de la ubicación.</span><span class="sxs-lookup"><span data-stu-id="62b4b-143">Accessing configuration files at run time requires granting permissions to the caller; the required permissions depend on the type of application, configuration file, and location.</span></span> <span data-ttu-id="62b4b-144">Para obtener más información, consulte [usando las clases de configuración](http://msdn.microsoft.com/library/98d2b386-baf6-4a17-974b-76e3b4c87acc) y <xref:System.Web.Configuration.WebConfigurationManager> para las aplicaciones ASP.NET, y <xref:System.Configuration.ConfigurationManager> para aplicaciones de Windows.</span><span class="sxs-lookup"><span data-stu-id="62b4b-144">For more information, see [Using the Configuration Classes](http://msdn.microsoft.com/library/98d2b386-baf6-4a17-974b-76e3b4c87acc) and <xref:System.Web.Configuration.WebConfigurationManager> for ASP.NET applications, and <xref:System.Configuration.ConfigurationManager> for Windows applications.</span></span>  
  
 <span data-ttu-id="62b4b-145">Puede usar <xref:System.Configuration.ConnectionStringSettingsCollection> para recuperar cadenas de conexión de archivos de configuración de aplicación.</span><span class="sxs-lookup"><span data-stu-id="62b4b-145">You can use the <xref:System.Configuration.ConnectionStringSettingsCollection> to retrieve connection strings from application configuration files.</span></span> <span data-ttu-id="62b4b-146">Contiene una colección de <xref:System.Configuration.ConnectionStringSettings> objetos, cada uno de los cuales representa una única entrada en la **connectionStrings** sección.</span><span class="sxs-lookup"><span data-stu-id="62b4b-146">It contains a collection of <xref:System.Configuration.ConnectionStringSettings> objects, each of which represents a single entry in the **connectionStrings** section.</span></span> <span data-ttu-id="62b4b-147">Sus propiedades se asignan a los atributos de cadenas de conexión, lo que permite recuperar una cadena de conexión mediante la especificación de su nombre o del nombre del proveedor.</span><span class="sxs-lookup"><span data-stu-id="62b4b-147">Its properties map to connection string attributes, allowing you to retrieve a connection string by specifying the name or the provider name.</span></span>  
  
|<span data-ttu-id="62b4b-148">Propiedad</span><span class="sxs-lookup"><span data-stu-id="62b4b-148">Property</span></span>|<span data-ttu-id="62b4b-149">Descripción</span><span class="sxs-lookup"><span data-stu-id="62b4b-149">Description</span></span>|  
|--------------|-----------------|  
|<xref:System.Configuration.ConnectionStringSettings.Name%2A>|<span data-ttu-id="62b4b-150">Nombre de la cadena de conexión.</span><span class="sxs-lookup"><span data-stu-id="62b4b-150">The name of the connection string.</span></span> <span data-ttu-id="62b4b-151">Se asigna a la **nombre** atributo.</span><span class="sxs-lookup"><span data-stu-id="62b4b-151">Maps to the **name** attribute.</span></span>|  
|<xref:System.Configuration.ConnectionStringSettings.ProviderName%2A>|<span data-ttu-id="62b4b-152">Nombre completo del proveedor.</span><span class="sxs-lookup"><span data-stu-id="62b4b-152">The fully qualified provider name.</span></span> <span data-ttu-id="62b4b-153">Se asigna a la **providerName** atributo.</span><span class="sxs-lookup"><span data-stu-id="62b4b-153">Maps to the **providerName** attribute.</span></span>|  
|<xref:System.Configuration.ConnectionStringSettings.ConnectionString%2A>|<span data-ttu-id="62b4b-154">La cadena de conexión.</span><span class="sxs-lookup"><span data-stu-id="62b4b-154">The connection string.</span></span> <span data-ttu-id="62b4b-155">Se asigna a la **connectionString** atributo.</span><span class="sxs-lookup"><span data-stu-id="62b4b-155">Maps to the **connectionString** attribute.</span></span>|  
  
### <a name="example-listing-all-connection-strings"></a><span data-ttu-id="62b4b-156">Ejemplo: mostrar todas las cadenas de conexión</span><span class="sxs-lookup"><span data-stu-id="62b4b-156">Example: Listing All Connection Strings</span></span>  
 <span data-ttu-id="62b4b-157">Este ejemplo recorre en iteración la colección `ConnectionStringSettings` y muestra las propiedades <xref:System.Configuration.ConnectionStringSettings.Name%2A>, <xref:System.Configuration.ConnectionStringSettings.ProviderName%2A> y <xref:System.Configuration.ConnectionStringSettings.ConnectionString%2A> en la ventana de la consola.</span><span class="sxs-lookup"><span data-stu-id="62b4b-157">This example iterates through the `ConnectionStringSettings` collection and displays the <xref:System.Configuration.ConnectionStringSettings.Name%2A>, <xref:System.Configuration.ConnectionStringSettings.ProviderName%2A>, and <xref:System.Configuration.ConnectionStringSettings.ConnectionString%2A> properties in the console window.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="62b4b-158">System.Configuration.dll no se incluye en todos los tipos de proyectos y es posible que deba establecer una referencia a este elemento para usar las clases de configuración.</span><span class="sxs-lookup"><span data-stu-id="62b4b-158">System.Configuration.dll is not included in all project types, and you may need to set a reference to it in order to use the configuration classes.</span></span> <span data-ttu-id="62b4b-159">El nombre y la ubicación de un archivo de configuración de aplicación determinado varían en función del tipo de aplicación y del proceso de hospedaje.</span><span class="sxs-lookup"><span data-stu-id="62b4b-159">The name and location of a particular application configuration file varies by the type of application and the hosting process.</span></span>  
  
 [!code-csharp[DataWorks ConnectionStringSettings.RetrieveFromConfig#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfig/CS/source.cs#1)]
 [!code-vb[DataWorks ConnectionStringSettings.RetrieveFromConfig#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfig/VB/source.vb#1)]  
  
### <a name="example-retrieving-a-connection-string-by-name"></a><span data-ttu-id="62b4b-160">Ejemplo: recuperar una cadena de conexión por su nombre</span><span class="sxs-lookup"><span data-stu-id="62b4b-160">Example: Retrieving a Connection String by Name</span></span>  
 <span data-ttu-id="62b4b-161">El siguiente ejemplo muestra cómo recuperar una cadena de conexión de un archivo de configuración mediante la especificación del nombre.</span><span class="sxs-lookup"><span data-stu-id="62b4b-161">This example demonstrates how to retrieve a connection string from a configuration file by specifying its name.</span></span> <span data-ttu-id="62b4b-162">El código crea un objeto <xref:System.Configuration.ConnectionStringSettings>, de forma que el parámetro de entrada proporcionado coincida con el nombre de <xref:System.Configuration.ConfigurationManager.ConnectionStrings%2A>.</span><span class="sxs-lookup"><span data-stu-id="62b4b-162">The code creates a <xref:System.Configuration.ConnectionStringSettings> object, matching the supplied input parameter to the <xref:System.Configuration.ConfigurationManager.ConnectionStrings%2A> name.</span></span> <span data-ttu-id="62b4b-163">Si no se encuentra una coincidencia de nombre, la función devuelve `null` (`Nothing` en Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="62b4b-163">If no matching name is found, the function returns `null` (`Nothing` in Visual Basic).</span></span>  
  
 [!code-csharp[DataWorks ConnectionStringSettings.RetrieveFromConfigByName#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfigByName/CS/source.cs#1)]
 [!code-vb[DataWorks ConnectionStringSettings.RetrieveFromConfigByName#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfigByName/VB/source.vb#1)]  
  
### <a name="example-retrieving-a-connection-string-by-provider-name"></a><span data-ttu-id="62b4b-164">Ejemplo: recuperar una cadena de conexión por el nombre de proveedor</span><span class="sxs-lookup"><span data-stu-id="62b4b-164">Example: Retrieving a Connection String by Provider Name</span></span>  
 <span data-ttu-id="62b4b-165">En este ejemplo se muestra cómo recuperar una cadena de conexión especificando el nombre invariable de proveedor en el formato *System.Data.ProviderName*.</span><span class="sxs-lookup"><span data-stu-id="62b4b-165">This example demonstrates how to retrieve a connection string by specifying the provider-invariant name in the format *System.Data.ProviderName*.</span></span> <span data-ttu-id="62b4b-166">El código recorre en iteración <xref:System.Configuration.ConnectionStringSettingsCollection> y devuelve la cadena de conexión del primer valor de <xref:System.Configuration.ConnectionStringSettings.ProviderName%2A> encontrado.</span><span class="sxs-lookup"><span data-stu-id="62b4b-166">The code iterates through the <xref:System.Configuration.ConnectionStringSettingsCollection> and returns the connection string for the first <xref:System.Configuration.ConnectionStringSettings.ProviderName%2A> found.</span></span> <span data-ttu-id="62b4b-167">Si no se encuentra el nombre del proveedor, la función devuelve `null` (`Nothing` en Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="62b4b-167">If the provider name is not found, the function returns `null` (`Nothing` in Visual Basic).</span></span>  
  
 [!code-csharp[DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider/CS/source.cs#1)]
 [!code-vb[DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider/VB/source.vb#1)]  
  
## <a name="encrypting-configuration-file-sections-using-protected-configuration"></a><span data-ttu-id="62b4b-168">Cifrar secciones del archivo de configuración mediante una configuración protegida</span><span class="sxs-lookup"><span data-stu-id="62b4b-168">Encrypting Configuration File Sections Using Protected Configuration</span></span>  
 <span data-ttu-id="62b4b-169">ASP.NET 2.0 incorpora una nueva característica denominada *configuración protegida*, que permite cifrar información confidencial en un archivo de configuración.</span><span class="sxs-lookup"><span data-stu-id="62b4b-169">ASP.NET 2.0 introduced a new feature, called *protected configuration*, that enables you to encrypt sensitive information in a configuration file.</span></span> <span data-ttu-id="62b4b-170">Si bien se ha diseñado principalmente para ASP.NET, la configuración protegida también se puede usar para cifrar secciones del archivo de configuración en aplicaciones Windows.</span><span class="sxs-lookup"><span data-stu-id="62b4b-170">Although primarily designed for ASP.NET, protected configuration can also be used to encrypt configuration file sections in Windows applications.</span></span> <span data-ttu-id="62b4b-171">Para obtener una descripción detallada de las capacidades de configuración protegida, vea [Encrypting Configuration Information Using Protected Configuration](http://msdn.microsoft.com/library/51cdfe5b-9d82-458c-94ff-c551c4f38ed1).</span><span class="sxs-lookup"><span data-stu-id="62b4b-171">For a detailed description of the protected configuration capabilities, see [Encrypting Configuration Information Using Protected Configuration](http://msdn.microsoft.com/library/51cdfe5b-9d82-458c-94ff-c551c4f38ed1).</span></span>  
  
 <span data-ttu-id="62b4b-172">Fragmento de archivo de configuración siguiente muestra la **connectionStrings** sección después de que se ha cifrado.</span><span class="sxs-lookup"><span data-stu-id="62b4b-172">The following configuration file fragment shows the **connectionStrings** section after it has been encrypted.</span></span> <span data-ttu-id="62b4b-173">El **configProtectionProvider** especifica el proveedor de configuración protegida que se utiliza para cifrar y descifrar las cadenas de conexión.</span><span class="sxs-lookup"><span data-stu-id="62b4b-173">The **configProtectionProvider** specifies the protected configuration provider used to encrypt and decrypt the connection strings.</span></span> <span data-ttu-id="62b4b-174">El **EncryptedData** sección contiene el texto cifrado.</span><span class="sxs-lookup"><span data-stu-id="62b4b-174">The **EncryptedData** section contains the cipher text.</span></span>  
  
```xml  
<connectionStrings configProtectionProvider="DataProtectionConfigurationProvider">  
  <EncryptedData>  
    <CipherData>  
      <CipherValue>AQAAANCMnd8BFdERjHoAwE/Cl+sBAAAAH2... </CipherValue>  
    </CipherData>  
  </EncryptedData>  
</connectionStrings>  
```  
  
 <span data-ttu-id="62b4b-175">Cuando se recupera la cadena de conexión cifrada en tiempo de ejecución, .NET Framework usa el proveedor especificado para descifrar el **CipherValue** y ponerla a disposición de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="62b4b-175">When the encrypted connection string is retrieved at run time, the .NET Framework uses the specified provider to decrypt the **CipherValue** and make it available to your application.</span></span> <span data-ttu-id="62b4b-176">No es necesario escribir ningún código adicional para administrar el proceso de descifrado.</span><span class="sxs-lookup"><span data-stu-id="62b4b-176">You do not need to write any additional code to manage the decryption process.</span></span>  
  
### <a name="protected-configuration-providers"></a><span data-ttu-id="62b4b-177">Proveedores de configuración protegida</span><span class="sxs-lookup"><span data-stu-id="62b4b-177">Protected Configuration Providers</span></span>  
 <span data-ttu-id="62b4b-178">Los proveedores de configuración protegida se registran en el **configProtectedData** sección de la **machine.config** de archivos en el equipo local, como se muestra en el siguiente fragmento, que se muestra en los dos proveedores de configuración protegida que se suministra con .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="62b4b-178">Protected configuration providers are registered in the **configProtectedData** section of the **machine.config** file on the local computer, as shown in the following fragment, which shows the two protected configuration providers supplied with the .NET Framework.</span></span> <span data-ttu-id="62b4b-179">Los valores que se muestran se han truncado para facilitar la lectura.</span><span class="sxs-lookup"><span data-stu-id="62b4b-179">The values shown here have been truncated for readability.</span></span>  
  
```xml  
<configProtectedData defaultProvider="RsaProtectedConfigurationProvider">  
  <providers>  
    <add name="RsaProtectedConfigurationProvider"   
      type="System.Configuration.RsaProtectedConfigurationProvider, ... />  
    <add name="DataProtectionConfigurationProvider"   
      type="System.Configuration.DpapiProtectedConfigurationProvider, ... />  
  </providers>  
</configProtectedData>  
```  
  
 Puede configurar proveedores de configuración protegida adicionales agregándolos a la **machine.config** archivo. Asimismo, puede crear su propio proveedor de configuración protegida heredando de la clase base abstracta <xref:System.Configuration.ProtectedConfigurationProvider>. <span data-ttu-id="62b4b-182">En la tabla siguiente se describen los dos archivos de configuración incluidos en .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="62b4b-182">The following table describes the two configuration files included with the .NET Framework.</span></span>  
  
|<span data-ttu-id="62b4b-183">Proveedor</span><span class="sxs-lookup"><span data-stu-id="62b4b-183">Provider</span></span>|<span data-ttu-id="62b4b-184">Descripción</span><span class="sxs-lookup"><span data-stu-id="62b4b-184">Description</span></span>|  
|--------------|-----------------|  
|<!--zz<xref:System.Configuration.RSAProtectedConfigurationProvider>-->`System.Configuration.RSAProtectedConfigurationProvider`|<span data-ttu-id="62b4b-185">Usa el algoritmo de cifrado RSA para cifrar y descifrar datos.</span><span class="sxs-lookup"><span data-stu-id="62b4b-185">Uses the RSA encryption algorithm to encrypt and decrypt data.</span></span> <span data-ttu-id="62b4b-186">Los algoritmos RSA se pueden usar para el cifrado de clave pública y para firmas digitales.</span><span class="sxs-lookup"><span data-stu-id="62b4b-186">The RSA algorithm can be used for both public key encryption and digital signatures.</span></span> <span data-ttu-id="62b4b-187">También se conoce como cifrado de "clave pública" o asimétrico, ya que usa dos claves diferentes.</span><span class="sxs-lookup"><span data-stu-id="62b4b-187">It is also known as "public key" or asymmetrical encryption because it employs two different keys.</span></span> <span data-ttu-id="62b4b-188">Puede usar el [herramienta de registro de IIS de ASP.NET (Aspnet_regiis.exe)](http://msdn.microsoft.com/library/6491c41e-e2b0-481f-9863-db3614d5f96b) para cifrar secciones de un archivo Web.config y administrar las claves de cifrado.</span><span class="sxs-lookup"><span data-stu-id="62b4b-188">You can use the [ASP.NET IIS Registration Tool (Aspnet_regiis.exe)](http://msdn.microsoft.com/library/6491c41e-e2b0-481f-9863-db3614d5f96b) to encrypt sections in a Web.config file and manage the encryption keys.</span></span> <span data-ttu-id="62b4b-189">ASP.NET descifra el archivo de configuración cuando lo procesa.</span><span class="sxs-lookup"><span data-stu-id="62b4b-189">ASP.NET decrypts the configuration file when it processes the file.</span></span> <span data-ttu-id="62b4b-190">La identidad de la aplicación ASP.NET debe tener acceso de lectura a la clave de cifrado utilizada para cifrar y descifrar las secciones cifradas.</span><span class="sxs-lookup"><span data-stu-id="62b4b-190">The identity of the ASP.NET application must have read access to the encryption key that is used to encrypt and decrypt the encrypted sections.</span></span>|  
|<!--zz<xref:System.Configuration.DPAPIProtectedConfigurationProvider>-->`System.Configuration.DPAPIProtectedConfigurationProvider`|<span data-ttu-id="62b4b-191">Usa la API de protección de datos (DPAPI) de Windows para cifrar y descifrar las secciones de configuración.</span><span class="sxs-lookup"><span data-stu-id="62b4b-191">Uses the Windows Data Protection API (DPAPI) to encrypt configuration sections.</span></span> <span data-ttu-id="62b4b-192">Usa los servicios criptográficos integrados de Windows y se puede configurar para la protección específica de equipo o para la protección específica de cuenta de usuario.</span><span class="sxs-lookup"><span data-stu-id="62b4b-192">It uses the Windows built-in cryptographic services and can be configured for either machine-specific or user-account-specific protection.</span></span> <span data-ttu-id="62b4b-193">La protección específica de equipo resulta útil cuando varias aplicaciones del mismo servidor deben compartir información.</span><span class="sxs-lookup"><span data-stu-id="62b4b-193">Machine-specific protection is useful for multiple applications on the same server that need to share information.</span></span> <span data-ttu-id="62b4b-194">La protección específica de cuenta de usuario se puede utilizar para los servicios que se ejecutan con una identidad de usuario concreta, como un entorno de hospedaje compartido.</span><span class="sxs-lookup"><span data-stu-id="62b4b-194">User-account-specific protection can be used with services that run with a specific user identity, such as a shared hosting environment.</span></span> <span data-ttu-id="62b4b-195">Cada aplicación se ejecuta con una identidad independiente que limita el acceso a recursos como los archivos y las bases de datos.</span><span class="sxs-lookup"><span data-stu-id="62b4b-195">Each application runs under a separate identity which restricts access to resources such as files and databases.</span></span>|  
  
 <span data-ttu-id="62b4b-196">Ambos proveedores proporcionan cifrado de datos de alta seguridad.</span><span class="sxs-lookup"><span data-stu-id="62b4b-196">Both providers offer strong encryption of data.</span></span> <span data-ttu-id="62b4b-197">No obstante, si prevé usar el mismo archivo de configuración de cifrado en varios servidores como, por ejemplo, una granja de servidores web, solo `RsaProtectedConfigurationProvider` permite exportar las claves de cifrado usadas para cifrar los datos e importarlas a otro servidor.</span><span class="sxs-lookup"><span data-stu-id="62b4b-197">However, if you are planning to use the same encrypted configuration file on multiple servers, such as a Web farm, only the `RsaProtectedConfigurationProvider` enables you to export the encryption keys used to encrypt the data and import them on another server.</span></span> <span data-ttu-id="62b4b-198">Para obtener más información, consulte [importar y exportar protegido configuración contenedores de claves RSA](http://msdn.microsoft.com/library/f3022b39-f17f-48c1-b067-025eab0ce8bc).</span><span class="sxs-lookup"><span data-stu-id="62b4b-198">For more information, see [Importing and Exporting Protected Configuration RSA Key Containers](http://msdn.microsoft.com/library/f3022b39-f17f-48c1-b067-025eab0ce8bc).</span></span>  
  
### <a name="using-the-configuration-classes"></a><span data-ttu-id="62b4b-199">Uso de clases de configuración</span><span class="sxs-lookup"><span data-stu-id="62b4b-199">Using the Configuration Classes</span></span>  
 <span data-ttu-id="62b4b-200">El espacio de nombres <xref:System.Configuration> proporciona clases para trabajar con valores de configuración mediante programación.</span><span class="sxs-lookup"><span data-stu-id="62b4b-200">The <xref:System.Configuration> namespace provides classes to work with configuration settings programmatically.</span></span> <span data-ttu-id="62b4b-201">La clase <xref:System.Configuration.ConfigurationManager> proporciona acceso a los archivos de configuración de equipo, aplicación y usuario.</span><span class="sxs-lookup"><span data-stu-id="62b4b-201">The <xref:System.Configuration.ConfigurationManager> class provides access to machine, application, and user configuration files.</span></span> <span data-ttu-id="62b4b-202">Si va a crear una aplicación de ASP.NET, puede usar el <xref:System.Web.Configuration.WebConfigurationManager> (clase), que proporciona la misma funcionalidad, mientras que permite obtener acceso a configuración que son únicos para las aplicaciones de ASP.NET, como los que se encuentra en  **\< System.Web >**.</span><span class="sxs-lookup"><span data-stu-id="62b4b-202">If you are creating an ASP.NET application, you can use the <xref:System.Web.Configuration.WebConfigurationManager> class, which provides the same functionality while also allowing you to access settings that are unique to ASP.NET applications, such as those found in **\<system.web>**.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="62b4b-203">El espacio de nombres <xref:System.Security.Cryptography> contiene clases que proporcionan opciones adicionales para cifrar y descifrar datos.</span><span class="sxs-lookup"><span data-stu-id="62b4b-203">The <xref:System.Security.Cryptography> namespace contains classes that provide additional options for encrypting and decrypting data.</span></span> <span data-ttu-id="62b4b-204">Use estas clases si requiere servicios criptográficos que no están disponibles cuando se usa la configuración protegida.</span><span class="sxs-lookup"><span data-stu-id="62b4b-204">Use these classes if you require cryptographic services that are not available using protected configuration.</span></span> <span data-ttu-id="62b4b-205">Algunas de estas clases son contenedores de Microsoft CryptoAPI no administrado, mientras que otras son simplemente implementaciones administradas.</span><span class="sxs-lookup"><span data-stu-id="62b4b-205">Some of these classes are wrappers for the unmanaged Microsoft CryptoAPI, while others are purely managed implementations.</span></span> <span data-ttu-id="62b4b-206">Para obtener más información, consulte [servicios criptográficos](http://msdn.microsoft.com/en-us/68a1e844-c63c-44af-9247-f6716eb23781).</span><span class="sxs-lookup"><span data-stu-id="62b4b-206">For more information, see [Cryptographic Services](http://msdn.microsoft.com/en-us/68a1e844-c63c-44af-9247-f6716eb23781).</span></span>  
  
### <a name="appconfig-example"></a><span data-ttu-id="62b4b-207">Ejemplo de App.config</span><span class="sxs-lookup"><span data-stu-id="62b4b-207">App.config Example</span></span>  
 <span data-ttu-id="62b4b-208">En este ejemplo se muestra cómo alternar el cifrado el **connectionStrings** sección un **app.config** archivo para una aplicación de Windows.</span><span class="sxs-lookup"><span data-stu-id="62b4b-208">This example demonstrates how to toggle encrypting the **connectionStrings** section in an **app.config** file for a Windows application.</span></span> <span data-ttu-id="62b4b-209">En este ejemplo, el procedimiento recibe el nombre de la aplicación como argumento, por ejemplo, "MyApplication.exe".</span><span class="sxs-lookup"><span data-stu-id="62b4b-209">In this example, the procedure takes the name of the application as an argument, for example, "MyApplication.exe".</span></span> <span data-ttu-id="62b4b-210">El **app.config** archivo, a continuación, se cifra y se copia a la carpeta que contiene el ejecutable con el nombre "MyApplication.exe.config".</span><span class="sxs-lookup"><span data-stu-id="62b4b-210">The **app.config** file will then be encrypted and copied to the folder that contains the executable under the name of "MyApplication.exe.config".</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="62b4b-211">La cadena de conexión solo se puede descifrar en el equipo donde se ha cifrado.</span><span class="sxs-lookup"><span data-stu-id="62b4b-211">The connection string can only be decrypted on the computer on which it was encrypted.</span></span>  
  
 <span data-ttu-id="62b4b-212">El código usa el <xref:System.Configuration.ConfigurationManager.OpenExeConfiguration%2A> método para abrir el **app.config** archivo para edición y el <xref:System.Configuration.ConfigurationManager.GetSection%2A> método devuelve el **connectionStrings** sección.</span><span class="sxs-lookup"><span data-stu-id="62b4b-212">The code uses the <xref:System.Configuration.ConfigurationManager.OpenExeConfiguration%2A> method to open the **app.config** file for editing, and the <xref:System.Configuration.ConfigurationManager.GetSection%2A> method returns the **connectionStrings** section.</span></span> <span data-ttu-id="62b4b-213">A continuación, el código comprueba la propiedad <xref:System.Configuration.SectionInformation.IsProtected%2A> y llama a <xref:System.Configuration.SectionInformation.ProtectSection%2A> para cifrar la sección si no está cifrada.</span><span class="sxs-lookup"><span data-stu-id="62b4b-213">The code then checks the <xref:System.Configuration.SectionInformation.IsProtected%2A> property, calling the <xref:System.Configuration.SectionInformation.ProtectSection%2A> to encrypt the section if it is not encrypted.</span></span> <span data-ttu-id="62b4b-214">Para descifrar la sección se llama al método <xref:System.Configuration.SectionInformation.UnprotectSection%2A>.</span><span class="sxs-lookup"><span data-stu-id="62b4b-214">The <xref:System.Configuration.SectionInformation.UnprotectSection%2A> method is invoked to decrypt the section.</span></span> <span data-ttu-id="62b4b-215">El método <xref:System.Configuration.Configuration.Save%2A> completa la operación y guarda los cambios.</span><span class="sxs-lookup"><span data-stu-id="62b4b-215">The <xref:System.Configuration.Configuration.Save%2A> method completes the operation and saves the changes.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="62b4b-216">Para ejecutar el código, debe establecer una referencia al archivo `System.Configuration.dll` del proyecto.</span><span class="sxs-lookup"><span data-stu-id="62b4b-216">You must set a reference to `System.Configuration.dll` in your project for the code to run.</span></span>  
  
 [!code-csharp[DataWorks ConnectionStrings.Encrypt#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStrings.Encrypt/CS/source.cs#1)]
 [!code-vb[DataWorks ConnectionStrings.Encrypt#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStrings.Encrypt/VB/source.vb#1)]  
  
### <a name="webconfig-example"></a><span data-ttu-id="62b4b-217">Ejemplo de Web.config</span><span class="sxs-lookup"><span data-stu-id="62b4b-217">Web.config Example</span></span>  
 <span data-ttu-id="62b4b-218">Este ejemplo usa el método <xref:System.Web.Configuration.WebConfigurationManager.OpenWebConfiguration%2A> de `WebConfigurationManager`.</span><span class="sxs-lookup"><span data-stu-id="62b4b-218">This example uses the <xref:System.Web.Configuration.WebConfigurationManager.OpenWebConfiguration%2A> method of the `WebConfigurationManager`.</span></span> <span data-ttu-id="62b4b-219">Tenga en cuenta que en este caso puede indicar la ruta de acceso relativa a la **Web.config** archivo mediante una tilde.</span><span class="sxs-lookup"><span data-stu-id="62b4b-219">Note that in this case you can supply the relative path to the **Web.config** file by using a tilde.</span></span> <span data-ttu-id="62b4b-220">El código requiere una referencia a la clase `System.Web.Configuration`.</span><span class="sxs-lookup"><span data-stu-id="62b4b-220">The code requires a reference to the `System.Web.Configuration` class.</span></span>  
  
 [!code-csharp[DataWorks ConnectionStringsWeb.Encrypt#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStringsWeb.Encrypt/CS/source.cs#1)]
 [!code-vb[DataWorks ConnectionStringsWeb.Encrypt#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStringsWeb.Encrypt/VB/source.vb#1)]  
  
 <span data-ttu-id="62b4b-221">Para obtener más información, proteger las aplicaciones ASP.NET, vea [NIB: seguridad de ASP.NET](http://msdn.microsoft.com/en-us/04b37532-18d9-40b4-8e5f-ee09a70b311d) y [prácticas de seguridad de ASP.NET 2.0 de un vistazo](http://go.microsoft.com/fwlink/?LinkId=59997) en el centro de desarrollo de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="62b4b-221">For more information securing ASP.NET applications, see [NIB: ASP.NET Security](http://msdn.microsoft.com/en-us/04b37532-18d9-40b4-8e5f-ee09a70b311d) and [ASP.NET 2.0 Security Practices at a Glance](http://go.microsoft.com/fwlink/?LinkId=59997) on the ASP.NET Developer Center.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="62b4b-222">Vea también</span><span class="sxs-lookup"><span data-stu-id="62b4b-222">See Also</span></span>  
 [<span data-ttu-id="62b4b-223">Generadores de cadenas de conexión</span><span class="sxs-lookup"><span data-stu-id="62b4b-223">Connection String Builders</span></span>](../../../../docs/framework/data/adonet/connection-string-builders.md)  
 [<span data-ttu-id="62b4b-224">Proteger la información de conexión</span><span class="sxs-lookup"><span data-stu-id="62b4b-224">Protecting Connection Information</span></span>](../../../../docs/framework/data/adonet/protecting-connection-information.md)  
 [<span data-ttu-id="62b4b-225">Utilizar las clases de configuración</span><span class="sxs-lookup"><span data-stu-id="62b4b-225">Using the Configuration Classes</span></span>](http://msdn.microsoft.com/library/98d2b386-baf6-4a17-974b-76e3b4c87acc)  
 [<span data-ttu-id="62b4b-226">Configurar aplicaciones</span><span class="sxs-lookup"><span data-stu-id="62b4b-226">Configuring Apps</span></span>](../../../../docs/framework/configure-apps/index.md)  
 [<span data-ttu-id="62b4b-227">Administración de sitios Web ASP.NET</span><span class="sxs-lookup"><span data-stu-id="62b4b-227">ASP.NET Web Site Administration</span></span>](http://msdn.microsoft.com/library/1298034b-5f7d-464d-abd1-ad9e6b3eeb7e)  
 [<span data-ttu-id="62b4b-228">Proveedores administrados de ADO.NET y Centro para desarrolladores de DataSet</span><span class="sxs-lookup"><span data-stu-id="62b4b-228">ADO.NET Managed Providers and DataSet Developer Center</span></span>](http://go.microsoft.com/fwlink/?LinkId=217917)
