---
title: Desarrollo de canalizaciones
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- add-in pipeline [.NET Framework], segments
- activation path for add-ins [.NET Framework]
- add-in pipeline [.NET Framework], activation path
- communication pipeline for add-ins [.NET Framework]
- add-in pipeline [.NET Framework], about
- add-ins [.NET Framework], pipeline development
ms.assetid: 932788f2-b87d-44cf-82f9-04492a8b2722
caps.latest.revision: "31"
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 33646bbd7b0043cb5fc036b9b11aa4cf37cd537f
ms.sourcegitcommit: c0dd436f6f8f44dc80dc43b07f6841a00b74b23f
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/19/2018
---
# <a name="pipeline-development"></a><span data-ttu-id="e77d5-102">Desarrollo de canalizaciones</span><span class="sxs-lookup"><span data-stu-id="e77d5-102">Pipeline Development</span></span>
<span data-ttu-id="e77d5-103">La canalización de complementos es la ruta de acceso de los segmentos de canalización que la aplicación host y su complemento deben utilizar para comunicarse entre sí.</span><span class="sxs-lookup"><span data-stu-id="e77d5-103">The add-in pipeline is the path of pipeline segments that the host application and its add-in must use to communicate with each other.</span></span>  
  
 <span data-ttu-id="e77d5-104">En la siguiente ilustración se muestra la canalización de comunicación y sus segmentos.</span><span class="sxs-lookup"><span data-stu-id="e77d5-104">The following illustration shows the communication pipeline and its segments.</span></span>  
  
 <span data-ttu-id="e77d5-105">![Agregar &#45; en el modelo de canalización. ] (../../../docs/framework/add-ins/media/addin1.png "AddIn1")</span><span class="sxs-lookup"><span data-stu-id="e77d5-105">![Add&#45;in pipeline model.](../../../docs/framework/add-ins/media/addin1.png "AddIn1")</span></span>  
<span data-ttu-id="e77d5-106">Canalización de complementos</span><span class="sxs-lookup"><span data-stu-id="e77d5-106">Add-in pipeline</span></span>  
  
 <span data-ttu-id="e77d5-107">La aplicación host se encuentra en un extremo de la canalización y el complemento está en el otro extremo.</span><span class="sxs-lookup"><span data-stu-id="e77d5-107">The host application is at one end of the pipeline and the add-in is at the other end.</span></span> <span data-ttu-id="e77d5-108">Comenzando desde cada extremo y desplazándose hacia el centro, la aplicación host y el complemento tienen una clase base abstracta que define una vista del modelo de objetos que ambos comparten.</span><span class="sxs-lookup"><span data-stu-id="e77d5-108">Starting from each end and moving toward the middle, both the host application and the add-in have an abstract base class that defines a view of the object model that they both share.</span></span> <span data-ttu-id="e77d5-109">Estos tipos (clases) constituyen el segmento de canalización de la vista de complemento y la vista de host del segmento de canalización de complementos.</span><span class="sxs-lookup"><span data-stu-id="e77d5-109">These types (classes) make up the add-in view pipeline segment and the host view of the add-in pipeline segment.</span></span> <span data-ttu-id="e77d5-110">El segmento de canalización del complemento de vista a menudo contiene más de una clase abstracta, pero la clase que hereda de se conoce como la base de complemento.</span><span class="sxs-lookup"><span data-stu-id="e77d5-110">The add-in view pipeline segment often contains more than one abstract class but the class that the add-in inherits from is known as the add-in base.</span></span>  
  
 <span data-ttu-id="e77d5-111">El segmento de canalización del adaptador de complemento de conversión y la conversión de segmento de canalización de adaptador de host el flujo de tipos entre los segmentos de canalización de la vista y el segmento de canalización del contrato.</span><span class="sxs-lookup"><span data-stu-id="e77d5-111">The add-in-side adapter pipeline segment and the host-side adapter pipeline segment convert the flow of types between their view pipeline segments and the contract pipeline segment.</span></span> <span data-ttu-id="e77d5-112">El segmento central de la canalización es un contrato que se deriva de la <xref:System.AddIn.Contract.IContract> interfaz.</span><span class="sxs-lookup"><span data-stu-id="e77d5-112">The central segment of the pipeline is a contract that is derived from the <xref:System.AddIn.Contract.IContract> interface.</span></span> <span data-ttu-id="e77d5-113">Este contrato define los métodos que la aplicación host y su complemento a utilizar.</span><span class="sxs-lookup"><span data-stu-id="e77d5-113">This contract defines the methods that the host application and its add-in will both use.</span></span>  
  
 <span data-ttu-id="e77d5-114">Si carga el host y el complemento en dominios de aplicación independientes, tiene un límite de aislamiento que separa el ámbito de la aplicación host del ámbito del complemento.</span><span class="sxs-lookup"><span data-stu-id="e77d5-114">If you load the host and the add-in into separate application domains, you have an isolation boundary that separates the scope of the host application from the scope of the add-in.</span></span> <span data-ttu-id="e77d5-115">El contrato es el único ensamblado que se carga en el host y los dominios de aplicación del complemento.</span><span class="sxs-lookup"><span data-stu-id="e77d5-115">The contract is the only assembly that is loaded in both the host and add-in application domains.</span></span> <span data-ttu-id="e77d5-116">El host y el complemento de cada solo hacer referencia a la vista de los métodos de contrato.</span><span class="sxs-lookup"><span data-stu-id="e77d5-116">The host and the add-in each refer only to their view of the contract methods.</span></span> <span data-ttu-id="e77d5-117">Por lo tanto, se separan mediante una capa de abstracción del contrato.</span><span class="sxs-lookup"><span data-stu-id="e77d5-117">Therefore, they are separated by a layer of abstraction from the contract.</span></span>  
  
 <span data-ttu-id="e77d5-118">Para desarrollar segmentos de canalización, debe crear una estructura de directorios que se va a contener.</span><span class="sxs-lookup"><span data-stu-id="e77d5-118">To develop pipeline segments, you must create a directory structure that will contain them.</span></span> <span data-ttu-id="e77d5-119">Para obtener más información sobre los requisitos de desarrollo y directrices de ámbito, consulte [requisitos del desarrollo de canalizaciones](http://msdn.microsoft.com/library/ef9fa986-e80b-43e1-868b-247f4c1d9da5).</span><span class="sxs-lookup"><span data-stu-id="e77d5-119">For more information about development requirements and scope guidelines, see [Pipeline Development Requirements](http://msdn.microsoft.com/library/ef9fa986-e80b-43e1-868b-247f4c1d9da5).</span></span>  
  
 <span data-ttu-id="e77d5-120">En la siguiente ilustración se muestra los tipos que conforman los segmentos de canalización.</span><span class="sxs-lookup"><span data-stu-id="e77d5-120">The following illustration shows the types that make up the pipeline segments.</span></span> <span data-ttu-id="e77d5-121">Los nombres de los tipos que se muestra en la ilustración son arbitrarios, pero todos los tipos excepto el host y el host de vista de los atributos de complemento requieren para que puedan ser detectados por los métodos que crear un almacén de información.</span><span class="sxs-lookup"><span data-stu-id="e77d5-121">The names of the types shown in the illustration are arbitrary, but all types except for the host and the host view of the add-in require attributes so they can be discovered by methods that construct an information store.</span></span>  
  
 <span data-ttu-id="e77d5-122">![Agregar &#45; en el modelo con atributos requeridos en tipos. ] (../../../docs/framework/add-ins/media/addin-model.png "AddIn_Model")</span><span class="sxs-lookup"><span data-stu-id="e77d5-122">![Add&#45;in model with required attributes on types.](../../../docs/framework/add-ins/media/addin-model.png "AddIn_Model")</span></span>  
<span data-ttu-id="e77d5-123">Canalización de complementos con tipos</span><span class="sxs-lookup"><span data-stu-id="e77d5-123">Add-in pipeline with types</span></span>  
  
 <span data-ttu-id="e77d5-124">La tabla siguiente describen los segmentos de canalización para activar un complemento.</span><span class="sxs-lookup"><span data-stu-id="e77d5-124">The following table describes the pipeline segments for activating an add-in.</span></span> <span data-ttu-id="e77d5-125">Para obtener más información acerca de estos segmentos, vea [contratos, vistas y adaptadores](http://msdn.microsoft.com/library/a6460173-9507-4b87-8c07-d4ee245d715c).</span><span class="sxs-lookup"><span data-stu-id="e77d5-125">For more information about these segments, see [Contracts, Views, and Adapters](http://msdn.microsoft.com/library/a6460173-9507-4b87-8c07-d4ee245d715c).</span></span>  
  
|<span data-ttu-id="e77d5-126">Segmento de la canalización</span><span class="sxs-lookup"><span data-stu-id="e77d5-126">Pipeline segment</span></span>|<span data-ttu-id="e77d5-127">Descripción</span><span class="sxs-lookup"><span data-stu-id="e77d5-127">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="e77d5-128">Host</span><span class="sxs-lookup"><span data-stu-id="e77d5-128">Host</span></span>|<span data-ttu-id="e77d5-129">El ensamblado de aplicación que crea una instancia de un complemento.</span><span class="sxs-lookup"><span data-stu-id="e77d5-129">The application assembly that creates an instance of an add-in.</span></span>|  
|<span data-ttu-id="e77d5-130">Vista de host del complemento</span><span class="sxs-lookup"><span data-stu-id="e77d5-130">Host view of the add-in</span></span>|<span data-ttu-id="e77d5-131">Representa la vista de la aplicación host de los tipos de objeto y los métodos que se utilizan para comunicarse con el complemento.</span><span class="sxs-lookup"><span data-stu-id="e77d5-131">Represents the host application's view of the object types and methods used to communicate with the add-in.</span></span> <span data-ttu-id="e77d5-132">La vista de host es una interfaz o clase base abstracta.</span><span class="sxs-lookup"><span data-stu-id="e77d5-132">The host view is an abstract base class or interface.</span></span>|  
|<span data-ttu-id="e77d5-133">Adaptador de host</span><span class="sxs-lookup"><span data-stu-id="e77d5-133">Host-side adapter</span></span>|<span data-ttu-id="e77d5-134">Un ensamblado con una o más clases que adapta los métodos al contrato y viceversa.</span><span class="sxs-lookup"><span data-stu-id="e77d5-134">An assembly with one or more classes that adapts methods to and from the contract.</span></span><br /><br /> <span data-ttu-id="e77d5-135">Este segmento de la canalización se identifica mediante el <xref:System.AddIn.Pipeline.HostAdapterAttribute> atributo.</span><span class="sxs-lookup"><span data-stu-id="e77d5-135">This pipeline segment is identified by using the <xref:System.AddIn.Pipeline.HostAdapterAttribute> attribute.</span></span><br /><br /> <span data-ttu-id="e77d5-136">No se admiten ensamblados de varios módulos.</span><span class="sxs-lookup"><span data-stu-id="e77d5-136">Multi-module assemblies are not supported.</span></span>|  
|<span data-ttu-id="e77d5-137">Contrato</span><span class="sxs-lookup"><span data-stu-id="e77d5-137">Contract</span></span>|<span data-ttu-id="e77d5-138">Una interfaz que se deriva de la <xref:System.AddIn.Contract.IContract> interfaz que define el protocolo para la comunicación entre el host y su complemento.</span><span class="sxs-lookup"><span data-stu-id="e77d5-138">An interface that is derived from the <xref:System.AddIn.Contract.IContract> interface and that defines the protocol for communicating types between the host and its add-in.</span></span><br /><br /> <span data-ttu-id="e77d5-139">Este segmento de la canalización se identifica estableciendo la <xref:System.AddIn.Pipeline.AddInContractAttribute> atributo.</span><span class="sxs-lookup"><span data-stu-id="e77d5-139">This pipeline segment is identified by setting the <xref:System.AddIn.Pipeline.AddInContractAttribute> attribute.</span></span>|  
|<span data-ttu-id="e77d5-140">Adaptador de conversión</span><span class="sxs-lookup"><span data-stu-id="e77d5-140">Add-in-side adapter</span></span>|<span data-ttu-id="e77d5-141">Un ensamblado con una o más clases que adapta los métodos al contrato y viceversa.</span><span class="sxs-lookup"><span data-stu-id="e77d5-141">An assembly with one or more classes that adapts methods to and from the contract.</span></span><br /><br /> <span data-ttu-id="e77d5-142">Este segmento de la canalización se identifica mediante el <xref:System.AddIn.Pipeline.AddInAdapterAttribute> atributo.</span><span class="sxs-lookup"><span data-stu-id="e77d5-142">This pipeline segment is identified by using the <xref:System.AddIn.Pipeline.AddInAdapterAttribute> attribute.</span></span><br /><br /> <span data-ttu-id="e77d5-143">Cada ensamblado en el directorio de adaptador de complemento en el lado que contiene un tipo que tiene un <xref:System.AddIn.Pipeline.AddInAdapterAttribute> atributo se carga en dominio de aplicación del complemento.</span><span class="sxs-lookup"><span data-stu-id="e77d5-143">Each assembly in the add-in-side adapter directory that contains a type that has an <xref:System.AddIn.Pipeline.AddInAdapterAttribute> attribute is loaded into the add-in's application domain.</span></span><br /><br /> <span data-ttu-id="e77d5-144">Cada ensamblado en el directorio de lado de complemento se carga en su propio dominio de aplicación.</span><span class="sxs-lookup"><span data-stu-id="e77d5-144">Each assembly in the add-in-side directory is loaded in its own application domain.</span></span><br /><br /> <span data-ttu-id="e77d5-145">No se admiten ensamblados de varios módulos</span><span class="sxs-lookup"><span data-stu-id="e77d5-145">Multi-module assemblies are not supported</span></span>|  
|<span data-ttu-id="e77d5-146">Vista de complemento</span><span class="sxs-lookup"><span data-stu-id="e77d5-146">Add-in view</span></span>|<span data-ttu-id="e77d5-147">Un ensamblado que representa la vista del complemento de los tipos de objetos y métodos que se usan para comunicarse con el host.</span><span class="sxs-lookup"><span data-stu-id="e77d5-147">An assembly that represents the add-in's view of the object types and methods that are used to communicate with the host.</span></span> <span data-ttu-id="e77d5-148">La vista del complemento es una interfaz o clase base abstracta.</span><span class="sxs-lookup"><span data-stu-id="e77d5-148">The add-in view is an abstract base class or interface.</span></span><br /><br /> <span data-ttu-id="e77d5-149">Este segmento de la canalización se identifica mediante el <xref:System.AddIn.Pipeline.AddInBaseAttribute> atributo.</span><span class="sxs-lookup"><span data-stu-id="e77d5-149">This pipeline segment is identified by using the <xref:System.AddIn.Pipeline.AddInBaseAttribute> attribute.</span></span><br /><br /> <span data-ttu-id="e77d5-150">Cada ensamblado en el directorio AddInViews que contiene un tipo que tiene un <xref:System.AddIn.Pipeline.AddInBaseAttribute> atributo se carga en dominio de aplicación del complemento.</span><span class="sxs-lookup"><span data-stu-id="e77d5-150">Each assembly in the AddInViews directory that contains a type that has an <xref:System.AddIn.Pipeline.AddInBaseAttribute> attribute is loaded into the add-in's application domain.</span></span>|  
|<span data-ttu-id="e77d5-151">Complemento</span><span class="sxs-lookup"><span data-stu-id="e77d5-151">Add-in</span></span>|<span data-ttu-id="e77d5-152">Un tipo con instancias que realiza un servicio para el host.</span><span class="sxs-lookup"><span data-stu-id="e77d5-152">An instantiated type that performs a service for the host.</span></span>|  
  
## <a name="pipeline-activation-path"></a><span data-ttu-id="e77d5-153">Ruta de activación de canalización</span><span class="sxs-lookup"><span data-stu-id="e77d5-153">Pipeline Activation Path</span></span>  
 <span data-ttu-id="e77d5-154">En la siguiente ilustración muestra la activación de tipos cuando se activa un complemento.</span><span class="sxs-lookup"><span data-stu-id="e77d5-154">The following illustration shows the activation of types when an add-in is activated.</span></span> <span data-ttu-id="e77d5-155">También se muestra la transferencia de objetos para el host, como los resultados de un cálculo o una colección de objetos.</span><span class="sxs-lookup"><span data-stu-id="e77d5-155">It also shows the passing of objects to the host, such as the results of a calculation or a collection of objects.</span></span> <span data-ttu-id="e77d5-156">Este es el escenario más típico.</span><span class="sxs-lookup"><span data-stu-id="e77d5-156">This is the most typical scenario.</span></span>  
  
 <span data-ttu-id="e77d5-157">![Agregar &#45; en el modelo con ruta de activación. ] (../../../docs/framework/add-ins/media/addin6.png "AddIn6")</span><span class="sxs-lookup"><span data-stu-id="e77d5-157">![Add&#45;in model with activation path.](../../../docs/framework/add-ins/media/addin6.png "AddIn6")</span></span>  
<span data-ttu-id="e77d5-158">Ruta de acceso de activación desde el complemento al host</span><span class="sxs-lookup"><span data-stu-id="e77d5-158">Activation path from the add-in to the host</span></span>  
  
 <span data-ttu-id="e77d5-159">La ruta de acceso de activación de la canalización se produce como sigue:</span><span class="sxs-lookup"><span data-stu-id="e77d5-159">The activation path of the pipeline occurs as follows:</span></span>  
  
1.  <span data-ttu-id="e77d5-160">La aplicación host activa el complemento con el <xref:System.AddIn.Hosting.AddInToken.Activate%2A> método.</span><span class="sxs-lookup"><span data-stu-id="e77d5-160">The host application activates the add-in with the <xref:System.AddIn.Hosting.AddInToken.Activate%2A> method.</span></span>  
  
2.  <span data-ttu-id="e77d5-161">La vista del complemento, complemento, adaptador de complemento de conversión y los ensamblados de contrato se cargan en dominio de aplicación del complemento.</span><span class="sxs-lookup"><span data-stu-id="e77d5-161">The add-in, add-in view, add-in-side adapter, and the contract assemblies are loaded into the add-in's application domain.</span></span>  
  
3.  <span data-ttu-id="e77d5-162">Se crea una instancia del adaptador de complemento de conversión mediante la vista de complemento (con la clase identificada por la <xref:System.AddIn.Pipeline.AddInBaseAttribute> atributo) como su constructor.</span><span class="sxs-lookup"><span data-stu-id="e77d5-162">An instance of the add-in-side adapter is created using the add-in view (with the class identified by the <xref:System.AddIn.Pipeline.AddInBaseAttribute> attribute) as its constructor.</span></span> <span data-ttu-id="e77d5-163">El adaptador de conversión hereda del contrato.</span><span class="sxs-lookup"><span data-stu-id="e77d5-163">The add-in-side adapter inherits from the contract.</span></span>  
  
4.  <span data-ttu-id="e77d5-164">El adaptador de complemento de conversión, que se escribe como el contrato, se pasa a través del límite de aislamiento (opcional) al constructor del adaptador del host.</span><span class="sxs-lookup"><span data-stu-id="e77d5-164">The add-in-side adapter, which is typed as the contract, is passed across the (optional) isolation boundary to the host-side adapter's constructor.</span></span>  
  
5.  <span data-ttu-id="e77d5-165">La vista de host del adaptador de complemento, del host y los ensamblados de contrato se cargan en el dominio de aplicación del host.</span><span class="sxs-lookup"><span data-stu-id="e77d5-165">The host view of the add-in, host-side adapter, and the contract assemblies are loaded into the host's application domain.</span></span>  
  
6.  <span data-ttu-id="e77d5-166">Se crea una instancia del adaptador del host utilizando el contrato como su constructor.</span><span class="sxs-lookup"><span data-stu-id="e77d5-166">An instance of the host-side adapter is created using the contract as its constructor.</span></span> <span data-ttu-id="e77d5-167">El adaptador del host hereda de la vista de host del complemento.</span><span class="sxs-lookup"><span data-stu-id="e77d5-167">The host-side adapter inherits from the host view of the add-in.</span></span>  
  
7.  <span data-ttu-id="e77d5-168">El host tiene el complemento, que se escribe ver del complemento, el host, y puede seguir llamando a sus métodos.</span><span class="sxs-lookup"><span data-stu-id="e77d5-168">The host has the add-in, which is typed as the host view of the add-in, and can continue calling its methods.</span></span>  
  
## <a name="walkthroughs"></a><span data-ttu-id="e77d5-169">Tutoriales</span><span class="sxs-lookup"><span data-stu-id="e77d5-169">Walkthroughs</span></span>  
 <span data-ttu-id="e77d5-170">Hay tres temas del tutorial que describen cómo crear canalizaciones mediante Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="e77d5-170">There are three walkthrough topics that describe how to create pipelines using Visual Studio:</span></span>  
  
-   [<span data-ttu-id="e77d5-171">Tutorial: Creación de una aplicación extensible</span><span class="sxs-lookup"><span data-stu-id="e77d5-171">Walkthrough: Creating an Extensible Application</span></span>](../../../docs/framework/add-ins/walkthrough-create-extensible-app.md)  
  
     <span data-ttu-id="e77d5-172">Describe un complemento de calculadora que realiza la suma, resta, multiplicación y división cálculos para el host.</span><span class="sxs-lookup"><span data-stu-id="e77d5-172">Describes a calculator add-in that performs addition, subtraction, multiplication, and divsion calculations for the host.</span></span>  
  
-   [<span data-ttu-id="e77d5-173">Tutorial: Habilitar la compatibilidad con versiones anteriores como los cambios de Host</span><span class="sxs-lookup"><span data-stu-id="e77d5-173">Walkthrough: Enabling Backward Compatibility as Your Host Changes</span></span>](http://msdn.microsoft.com/library/6fa15bb5-8f04-407d-bd7d-675dc043c848)  
  
     <span data-ttu-id="e77d5-174">Describe un complemento de calculadora con capacidades de cálculo mejoradas y cómo mantener la compatibilidad con el primer complemento de calculadora.</span><span class="sxs-lookup"><span data-stu-id="e77d5-174">Describes a calculator add-in with enhanced calculation capabilities, and how to maintain compatibility with the first calculator add-in.</span></span>  
  
-   [<span data-ttu-id="e77d5-175">Tutorial: Pasar colecciones entre Hosts y complementos</span><span class="sxs-lookup"><span data-stu-id="e77d5-175">Walkthrough: Passing Collections Between Hosts and Add-Ins</span></span>](http://msdn.microsoft.com/library/b532c604-548e-4fab-b11c-377257dd0ee5)  
  
     <span data-ttu-id="e77d5-176">Describe cómo pasar colecciones de datos a través de la canalización utilizando un escenario de almacén de libros.</span><span class="sxs-lookup"><span data-stu-id="e77d5-176">Describes how to pass data collections over the pipeline using a book store scenario.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e77d5-177">Vea también</span><span class="sxs-lookup"><span data-stu-id="e77d5-177">See Also</span></span>  
 [<span data-ttu-id="e77d5-178">Escenarios de canalización del complemento</span><span class="sxs-lookup"><span data-stu-id="e77d5-178">Add-in Pipeline Scenarios</span></span>](http://msdn.microsoft.com/library/feb70e0b-8734-494c-aeaf-b567f014043e)  
 [<span data-ttu-id="e77d5-179">Complementos y extensibilidad</span><span class="sxs-lookup"><span data-stu-id="e77d5-179">Add-ins and Extensibility</span></span>](../../../docs/framework/add-ins/index.md)
