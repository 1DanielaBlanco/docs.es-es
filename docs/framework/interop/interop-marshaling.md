---
title: "Serialización de interoperabilidad"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- marshaling, COM interop
- interop marshaling
- interop marshaling, about interop marshaling
ms.assetid: 115f7a2f-d422-4605-ab36-13a8dd28142a
caps.latest.revision: "22"
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 5bfd5ca9d42c654882c77efafed82aec7e4f0c9b
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 12/22/2017
---
# <a name="interop-marshaling"></a><span data-ttu-id="5acae-102">Serialización de interoperabilidad</span><span class="sxs-lookup"><span data-stu-id="5acae-102">Interop Marshaling</span></span>
<a name="top"></a> <span data-ttu-id="5acae-103">La serialización de interoperabilidad rige cómo se pasan los datos en argumentos de método y valores devueltos entre la memoria administrada y la no administrada durante las llamadas.</span><span class="sxs-lookup"><span data-stu-id="5acae-103">Interop marshaling governs how data is passed in method arguments and return values between managed and unmanaged memory during calls.</span></span> <span data-ttu-id="5acae-104">La serialización de interoperabilidad es una actividad en tiempo de ejecución realizada por el servicio de serialización de Common Language Runtime.</span><span class="sxs-lookup"><span data-stu-id="5acae-104">Interop marshaling is a run-time activity performed by the common language runtime's marshaling service.</span></span>  
  
 <span data-ttu-id="5acae-105">La mayoría de los tipos de datos tienen representaciones comunes tanto en la memoria administrada como en la no administrada.</span><span class="sxs-lookup"><span data-stu-id="5acae-105">Most data types have common representations in both managed and unmanaged memory.</span></span> <span data-ttu-id="5acae-106">El administrador de serialización de interoperabilidad controla esos tipos automáticamente.</span><span class="sxs-lookup"><span data-stu-id="5acae-106">The interop marshaler handles these types for you.</span></span> <span data-ttu-id="5acae-107">El resto de tipos pueden ser ambiguos o no estar representados en la memoria administrada.</span><span class="sxs-lookup"><span data-stu-id="5acae-107">Other types can be ambiguous or not represented at all in managed memory.</span></span>  
  
 <span data-ttu-id="5acae-108">Un tipo ambiguo puede tener varias representaciones no administradas que se asignan a un solo tipo administrado, o bien no tener información de tipos, como el tamaño de una matriz.</span><span class="sxs-lookup"><span data-stu-id="5acae-108">An ambiguous type can have either multiple unmanaged representations that map to a single managed type, or missing type information, such as the size of an array.</span></span> <span data-ttu-id="5acae-109">Para los tipos ambiguos, el administrador de serialización proporciona una representación predeterminada y varias representaciones alternativas si existen.</span><span class="sxs-lookup"><span data-stu-id="5acae-109">For ambiguous types, the marshaler provides a default representation and alternative representations where multiple representations exist.</span></span> <span data-ttu-id="5acae-110">Se pueden proporcionar instrucciones explícitas al administrador de serialización sobre cómo serializar un tipo ambiguo.</span><span class="sxs-lookup"><span data-stu-id="5acae-110">You can supply explicit instructions to the marshaler on how it is to marshal an ambiguous type.</span></span>  
  
 <span data-ttu-id="5acae-111">Esta información general contiene las siguientes secciones:</span><span class="sxs-lookup"><span data-stu-id="5acae-111">This overview contains the following sections:</span></span>  
  
-   [<span data-ttu-id="5acae-112">Modelos de invocación de plataforma e interoperabilidad COM</span><span class="sxs-lookup"><span data-stu-id="5acae-112">Platform Invoke and COM Interop Models</span></span>](#platform_invoke_and_com_interop_models)  
  
-   [<span data-ttu-id="5acae-113">Serialización y contenedores COM</span><span class="sxs-lookup"><span data-stu-id="5acae-113">Marshaling and COM Apartments</span></span>](#marshaling_and_com_apartments)  
  
-   [<span data-ttu-id="5acae-114">Serialización de llamadas remotas</span><span class="sxs-lookup"><span data-stu-id="5acae-114">Marshaling Remote Calls</span></span>](#marshaling_remote_calls)  
  
-   [<span data-ttu-id="5acae-115">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="5acae-115">Related Topics</span></span>](#related_topics)  
  
-   [<span data-ttu-id="5acae-116">Referencia</span><span class="sxs-lookup"><span data-stu-id="5acae-116">Reference</span></span>](#reference)  
  
<a name="platform_invoke_and_com_interop_models"></a>   
## <a name="platform-invoke-and-com-interop-models"></a><span data-ttu-id="5acae-117">Modelos de invocación de plataforma e interoperabilidad COM</span><span class="sxs-lookup"><span data-stu-id="5acae-117">Platform Invoke and COM Interop Models</span></span>  
 <span data-ttu-id="5acae-118">Common Language Runtime proporciona dos mecanismos para interoperar con código no administrado:</span><span class="sxs-lookup"><span data-stu-id="5acae-118">The common language runtime provides two mechanisms for interoperating with unmanaged code:</span></span>  
  
-   <span data-ttu-id="5acae-119">Invocación de plataforma, que permite al código administrado llamar a funciones exportadas desde una biblioteca no administrada.</span><span class="sxs-lookup"><span data-stu-id="5acae-119">Platform invoke, which enables managed code to call functions exported from an unmanaged library.</span></span>  
  
-   <span data-ttu-id="5acae-120">Interoperabilidad COM, que permite al código administrado interactuar con modelos de objetos componentes (COM) a través de interfaces.</span><span class="sxs-lookup"><span data-stu-id="5acae-120">COM interop, which enables managed code to interact with Component Object Model (COM) objects through interfaces.</span></span>  
  
 <span data-ttu-id="5acae-121">Tanto la invocación de plataforma como la interoperabilidad COM usan serialización de interoperabilidad para mover con precisión los argumentos de método desde el llamador al destinatario y viceversa, si es necesario.</span><span class="sxs-lookup"><span data-stu-id="5acae-121">Both platform invoke and COM interop use interop marshaling to accurately move method arguments between caller and callee and back, if required.</span></span> <span data-ttu-id="5acae-122">Como se muestra en la siguiente ilustración, una llamada al método de invocación de plataforma fluye desde el código administrado al no administrado y nunca en sentido contrario, excepto cuando hay [funciones de devolución de llamada](../../../docs/framework/interop/callback-functions.md) implicadas.</span><span class="sxs-lookup"><span data-stu-id="5acae-122">As the following illustration shows, a platform invoke method call flows from managed to unmanaged code and never the other way, except when [callback functions](../../../docs/framework/interop/callback-functions.md) are involved.</span></span> <span data-ttu-id="5acae-123">Aunque las llamadas de invocación de plataforma solo pueden realizarse desde código administrado a código no administrado, los datos pueden fluir en ambas direcciones como parámetros de entrada o salida.</span><span class="sxs-lookup"><span data-stu-id="5acae-123">Even though platform invoke calls can flow only from managed to unmanaged code, data can flow in both directions as input or output parameters.</span></span> <span data-ttu-id="5acae-124">Las llamadas a métodos de interoperabilidad COM pueden fluir en ambas direcciones.</span><span class="sxs-lookup"><span data-stu-id="5acae-124">COM interop method calls can flow in either direction.</span></span>  
  
 <span data-ttu-id="5acae-125">![Invocación de plataforma](../../../docs/framework/interop/media/interopmarshaling.png "interopmarshaling")</span><span class="sxs-lookup"><span data-stu-id="5acae-125">![Platform invoke](../../../docs/framework/interop/media/interopmarshaling.png "interopmarshaling")</span></span>  
<span data-ttu-id="5acae-126">Flujo de llamadas de invocación de plataforma e interoperabilidad COM</span><span class="sxs-lookup"><span data-stu-id="5acae-126">Platform invoke and COM interop call flow</span></span>  
  
 <span data-ttu-id="5acae-127">En el nivel más bajo, ambos mecanismos usan el mismo servicio de serialización de interoperabilidad; sin embargo, hay determinados tipos de datos que solo se admiten en la interoperabilidad COM o en la invocación de plataforma.</span><span class="sxs-lookup"><span data-stu-id="5acae-127">At the lowest level, both mechanisms use the same interop marshaling service; however, certain data types are supported exclusively by COM interop or platform invoke.</span></span> <span data-ttu-id="5acae-128">Para obtener más información, vea [Comportamiento de serialización predeterminado](../../../docs/framework/interop/default-marshaling-behavior.md).</span><span class="sxs-lookup"><span data-stu-id="5acae-128">For details, see [Default Marshaling Behavior](../../../docs/framework/interop/default-marshaling-behavior.md).</span></span>  
  
 [<span data-ttu-id="5acae-129">Volver al principio</span><span class="sxs-lookup"><span data-stu-id="5acae-129">Back to top</span></span>](#top)  
  
<a name="marshaling_and_com_apartments"></a>   
## <a name="marshaling-and-com-apartments"></a><span data-ttu-id="5acae-130">Serialización y apartamentos COM</span><span class="sxs-lookup"><span data-stu-id="5acae-130">Marshaling and COM Apartments</span></span>  
 <span data-ttu-id="5acae-131">El administrador de serialización de interoperabilidad serializa datos entre el montón de Common Language Runtime y el montón no administrado.</span><span class="sxs-lookup"><span data-stu-id="5acae-131">The interop marshaler marshals data between the common language runtime heap and the unmanaged heap.</span></span> <span data-ttu-id="5acae-132">La serialización se produce siempre que el llamador y el destinatario no pueden operar en la misma instancia de datos.</span><span class="sxs-lookup"><span data-stu-id="5acae-132">Marshaling occurs whenever the caller and callee cannot operate on the same instance of data.</span></span> <span data-ttu-id="5acae-133">El administrador de serialización de interoperabilidad permite al llamador y al destinatario operar en los mismos datos, incluso aunque tengan su propia copia de los datos.</span><span class="sxs-lookup"><span data-stu-id="5acae-133">The interop marshaler makes it possible for the caller and callee to appear to be operating on the same data even if they have their own copy of the data.</span></span>  
  
 <span data-ttu-id="5acae-134">COM también dispone de un administrador de serialización que serializa datos entre apartamentos COM o diferentes procesos COM.</span><span class="sxs-lookup"><span data-stu-id="5acae-134">COM also has a marshaler that marshals data between COM apartments or different COM processes.</span></span> <span data-ttu-id="5acae-135">Al realizar llamadas entre código administrado y no administrado en el mismo apartamento COM, el administrador de serialización de interoperabilidad es el único administrador de serialización implicado.</span><span class="sxs-lookup"><span data-stu-id="5acae-135">When calling between managed and unmanaged code within the same COM apartment, the interop marshaler is the only marshaler involved.</span></span> <span data-ttu-id="5acae-136">Al realizar llamadas entre código administrado y código no administrado en un apartamento COM diferente o en un proceso diferente, están implicados tanto el administrador de serialización de interoperabilidad como el administrador de serialización de COM.</span><span class="sxs-lookup"><span data-stu-id="5acae-136">When calling between managed code and unmanaged code in a different COM apartment or a different process, both the interop marshaler and the COM marshaler are involved.</span></span>  
  
### <a name="com-clients-and-managed-servers"></a><span data-ttu-id="5acae-137">Clientes COM y servidores administrados</span><span class="sxs-lookup"><span data-stu-id="5acae-137">COM Clients and Managed Servers</span></span>  
 <span data-ttu-id="5acae-138">Un servidor administrado exportado con una biblioteca de tipos registrada por la [herramienta de registro de ensamblados (Regasm.exe)](../../../docs/framework/tools/regasm-exe-assembly-registration-tool.md) tiene una entrada del Registro `ThreadingModel` establecida en `Both`.</span><span class="sxs-lookup"><span data-stu-id="5acae-138">An exported managed server with a type library registered by the [Regasm.exe (Assembly Registration Tool)](../../../docs/framework/tools/regasm-exe-assembly-registration-tool.md) has a `ThreadingModel` registry entry set to `Both`.</span></span> <span data-ttu-id="5acae-139">Este valor indica que el servidor puede activarse en un contenedor uniproceso (STA) o en un contenedor multiproceso (MTA).</span><span class="sxs-lookup"><span data-stu-id="5acae-139">This value indicates that the server can be activated in a single-threaded apartment (STA) or a multithreaded apartment (MTA).</span></span> <span data-ttu-id="5acae-140">El objeto de servidor se crea en el mismo apartamento que su llamador, como se muestra en la tabla siguiente.</span><span class="sxs-lookup"><span data-stu-id="5acae-140">The server object is created in the same apartment as its caller, as shown in the following table.</span></span>  
  
|<span data-ttu-id="5acae-141">Cliente COM</span><span class="sxs-lookup"><span data-stu-id="5acae-141">COM client</span></span>|<span data-ttu-id="5acae-142">Servidor .NET</span><span class="sxs-lookup"><span data-stu-id="5acae-142">.NET server</span></span>|<span data-ttu-id="5acae-143">Requisitos de serialización</span><span class="sxs-lookup"><span data-stu-id="5acae-143">Marshaling requirements</span></span>|  
|----------------|-----------------|-----------------------------|  
|<span data-ttu-id="5acae-144">STA</span><span class="sxs-lookup"><span data-stu-id="5acae-144">STA</span></span>|<span data-ttu-id="5acae-145">`Both` se convierte en STA.</span><span class="sxs-lookup"><span data-stu-id="5acae-145">`Both` becomes STA.</span></span>|<span data-ttu-id="5acae-146">Serialización en mismo apartamento.</span><span class="sxs-lookup"><span data-stu-id="5acae-146">Same-apartment marshaling.</span></span>|  
|<span data-ttu-id="5acae-147">MTA</span><span class="sxs-lookup"><span data-stu-id="5acae-147">MTA</span></span>|<span data-ttu-id="5acae-148">`Both` se convierte en MTA.</span><span class="sxs-lookup"><span data-stu-id="5acae-148">`Both` becomes MTA.</span></span>|<span data-ttu-id="5acae-149">Serialización en mismo apartamento.</span><span class="sxs-lookup"><span data-stu-id="5acae-149">Same-apartment marshaling.</span></span>|  
  
 <span data-ttu-id="5acae-150">Dado que el cliente y el servidor están en el mismo apartamento, el servicio de serialización de interoperabilidad controla automáticamente toda la serialización de datos.</span><span class="sxs-lookup"><span data-stu-id="5acae-150">Because the client and server are in the same apartment, the interop marshaling service automatically handles all data marshaling.</span></span> <span data-ttu-id="5acae-151">La ilustración siguiente muestra cómo opera el servicio de serialización de interoperabilidad entre montones administrados y no administrados dentro del mismo apartamento de estilo COM.</span><span class="sxs-lookup"><span data-stu-id="5acae-151">The following illustration shows the interop marshaling service operating between managed and unmanaged heaps within the same COM-style apartment.</span></span>  
  
 <span data-ttu-id="5acae-152">![Serialización de interoperabilidad](../../../docs/framework/interop/media/interopheap.gif "interopheap")</span><span class="sxs-lookup"><span data-stu-id="5acae-152">![Interop marshaling](../../../docs/framework/interop/media/interopheap.gif "interopheap")</span></span>  
<span data-ttu-id="5acae-153">Proceso de serialización en el mismo apartamento</span><span class="sxs-lookup"><span data-stu-id="5acae-153">Same-apartment marshaling process</span></span>  
  
 <span data-ttu-id="5acae-154">Si planea exportar un servidor administrado, tenga en cuenta que el cliente COM determina el apartamento del servidor.</span><span class="sxs-lookup"><span data-stu-id="5acae-154">If you plan to export a managed server, be aware that the COM client determines the apartment of the server.</span></span> <span data-ttu-id="5acae-155">Un servidor administrado llamado por un cliente COM inicializado en un MTA debe garantizar la seguridad de subprocesos.</span><span class="sxs-lookup"><span data-stu-id="5acae-155">A managed server called by a COM client initialized in an MTA must ensure thread safety.</span></span>  
  
### <a name="managed-clients-and-com-servers"></a><span data-ttu-id="5acae-156">Clientes administrados y servidores COM</span><span class="sxs-lookup"><span data-stu-id="5acae-156">Managed Clients and COM Servers</span></span>  
 <span data-ttu-id="5acae-157">La configuración predeterminada para apartamentos de cliente administrado es MTA; sin embargo, el tipo de aplicación del cliente .NET puede cambiar la configuración predeterminada.</span><span class="sxs-lookup"><span data-stu-id="5acae-157">The default setting for managed client apartments is MTA; however, the application type of the .NET client can change the default setting.</span></span> <span data-ttu-id="5acae-158">Por ejemplo, una configuración de apartamento de cliente [!INCLUDE[vbprvblong](../../../includes/vbprvblong-md.md)] es STA.</span><span class="sxs-lookup"><span data-stu-id="5acae-158">For example, a [!INCLUDE[vbprvblong](../../../includes/vbprvblong-md.md)] client apartment setting is STA.</span></span> <span data-ttu-id="5acae-159">Puede usar <xref:System.STAThreadAttribute?displayProperty=nameWithType>, <xref:System.MTAThreadAttribute?displayProperty=nameWithType>, la propiedad <xref:System.Threading.Thread.ApartmentState%2A?displayProperty=nameWithType> o la propiedad <xref:System.Web.UI.Page.AspCompatMode%2A?displayProperty=nameWithType> para examinar y cambiar la configuración de apartamento de un cliente administrado.</span><span class="sxs-lookup"><span data-stu-id="5acae-159">You can use the <xref:System.STAThreadAttribute?displayProperty=nameWithType>, the <xref:System.MTAThreadAttribute?displayProperty=nameWithType>, the <xref:System.Threading.Thread.ApartmentState%2A?displayProperty=nameWithType> property, or the <xref:System.Web.UI.Page.AspCompatMode%2A?displayProperty=nameWithType> property to examine and change the apartment setting of a managed client.</span></span>  
  
 <span data-ttu-id="5acae-160">El autor del componente establece la afinidad del subproceso de un servidor COM.</span><span class="sxs-lookup"><span data-stu-id="5acae-160">The author of the component sets the thread affinity of a COM server.</span></span> <span data-ttu-id="5acae-161">En la tabla siguiente se muestran las combinaciones de configuraciones de apartamentos para clientes .NET y servidores COM.</span><span class="sxs-lookup"><span data-stu-id="5acae-161">The following table shows the combinations of apartment settings for .NET clients and COM servers.</span></span> <span data-ttu-id="5acae-162">También se muestran los requisitos de serialización resultantes para las combinaciones.</span><span class="sxs-lookup"><span data-stu-id="5acae-162">It also shows the resulting marshaling requirements for the combinations.</span></span>  
  
|<span data-ttu-id="5acae-163">Cliente .NET</span><span class="sxs-lookup"><span data-stu-id="5acae-163">.NET client</span></span>|<span data-ttu-id="5acae-164">Servidor COM</span><span class="sxs-lookup"><span data-stu-id="5acae-164">COM server</span></span>|<span data-ttu-id="5acae-165">Requisitos de serialización</span><span class="sxs-lookup"><span data-stu-id="5acae-165">Marshaling requirements</span></span>|  
|-----------------|----------------|-----------------------------|  
|<span data-ttu-id="5acae-166">MTA (valor predeterminado)</span><span class="sxs-lookup"><span data-stu-id="5acae-166">MTA (default)</span></span>|<span data-ttu-id="5acae-167">MTA</span><span class="sxs-lookup"><span data-stu-id="5acae-167">MTA</span></span><br /><br /> <span data-ttu-id="5acae-168">STA</span><span class="sxs-lookup"><span data-stu-id="5acae-168">STA</span></span>|<span data-ttu-id="5acae-169">Serialización de interoperabilidad.</span><span class="sxs-lookup"><span data-stu-id="5acae-169">Interop marshaling.</span></span><br /><br /> <span data-ttu-id="5acae-170">Serialización de interoperabilidad y COM.</span><span class="sxs-lookup"><span data-stu-id="5acae-170">Interop and COM marshaling.</span></span>|  
|<span data-ttu-id="5acae-171">STA</span><span class="sxs-lookup"><span data-stu-id="5acae-171">STA</span></span>|<span data-ttu-id="5acae-172">MTA</span><span class="sxs-lookup"><span data-stu-id="5acae-172">MTA</span></span><br /><br /> <span data-ttu-id="5acae-173">STA</span><span class="sxs-lookup"><span data-stu-id="5acae-173">STA</span></span>|<span data-ttu-id="5acae-174">Serialización de interoperabilidad y COM.</span><span class="sxs-lookup"><span data-stu-id="5acae-174">Interop and COM marshaling.</span></span><br /><br /> <span data-ttu-id="5acae-175">Serialización de interoperabilidad.</span><span class="sxs-lookup"><span data-stu-id="5acae-175">Interop marshaling.</span></span>|  
  
 <span data-ttu-id="5acae-176">Cuando un cliente administrado y un servidor no administrado están en el mismo apartamento, el servicio de serialización de interoperabilidad controla toda la serialización de datos.</span><span class="sxs-lookup"><span data-stu-id="5acae-176">When a managed client and unmanaged server are in the same apartment, the interop marshaling service handles all data marshaling.</span></span> <span data-ttu-id="5acae-177">Sin embargo, cuando el cliente y el servidor se inicializan en apartamentos diferentes, también es necesaria la serialización de COM.</span><span class="sxs-lookup"><span data-stu-id="5acae-177">However, when client and server are initialized in different apartments, COM marshaling is also required.</span></span> <span data-ttu-id="5acae-178">La ilustración siguiente muestra los elementos de una llamada entre apartamentos.</span><span class="sxs-lookup"><span data-stu-id="5acae-178">The following illustration shows the elements of a cross-apartment call.</span></span>  
  
 <span data-ttu-id="5acae-179">![Serialización COM](../../../docs/framework/interop/media/singleprocessmultapt.gif "singleprocessmultapt")</span><span class="sxs-lookup"><span data-stu-id="5acae-179">![COM marshaling](../../../docs/framework/interop/media/singleprocessmultapt.gif "singleprocessmultapt")</span></span>  
<span data-ttu-id="5acae-180">Llamada entre apartamentos entre un cliente .NET y un objeto COM</span><span class="sxs-lookup"><span data-stu-id="5acae-180">Cross-apartment call between a .NET client and COM object</span></span>  
  
 <span data-ttu-id="5acae-181">Para una serialización entre apartamentos, puede hacer lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="5acae-181">For cross-apartment marshaling, you can do the following:</span></span>  
  
-   <span data-ttu-id="5acae-182">Aceptar la sobrecarga que supone la serialización entre apartamentos, que solo es apreciable cuando hay muchas llamadas que cruzan el límite.</span><span class="sxs-lookup"><span data-stu-id="5acae-182">Accept the overhead of the cross-apartment marshaling, which is noticeable only when there are many calls across the boundary.</span></span> <span data-ttu-id="5acae-183">Debe registrar la biblioteca de tipos del componente COM para que las llamadas crucen correctamente el límite del apartamento.</span><span class="sxs-lookup"><span data-stu-id="5acae-183">You must register the type library of the COM component for calls to successfully cross the apartment boundary.</span></span>  
  
-   <span data-ttu-id="5acae-184">Establecer el subproceso de cliente en STA o MTA para alterar el subproceso principal.</span><span class="sxs-lookup"><span data-stu-id="5acae-184">Alter the main thread by setting the client thread to STA or MTA.</span></span> <span data-ttu-id="5acae-185">Por ejemplo, si el cliente de C# llama a muchos componentes COM de STA, puede evitar la serialización entre apartamentos si establece el subproceso principal en STA.</span><span class="sxs-lookup"><span data-stu-id="5acae-185">For example, if your C# client calls many STA COM components, you can avoid cross-apartment marshaling by setting the main thread to STA.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="5acae-186">Una vez que se establece el subproceso de un cliente C# en STA, las llamadas a componentes COM de MTA requerirán la serialización entre apartamentos.</span><span class="sxs-lookup"><span data-stu-id="5acae-186">Once the thread of a C# client is set to STA, calls to MTA COM components will require cross-apartment marshaling.</span></span>  
  
 <span data-ttu-id="5acae-187">Para obtener instrucciones sobre cómo seleccionar explícitamente un modelo de contenedor, vea [Subprocesamiento administrado y no administrado](http://msdn.microsoft.com/en-us/db425c20-4b2f-4433-bf96-76071c7881e5).</span><span class="sxs-lookup"><span data-stu-id="5acae-187">For instructions on explicitly selecting an apartment model, see [Managed and Unmanaged Threading](http://msdn.microsoft.com/en-us/db425c20-4b2f-4433-bf96-76071c7881e5).</span></span>  
  
 [<span data-ttu-id="5acae-188">Volver al principio</span><span class="sxs-lookup"><span data-stu-id="5acae-188">Back to top</span></span>](#top)  
  
<a name="marshaling_remote_calls"></a>   
## <a name="marshaling-remote-calls"></a><span data-ttu-id="5acae-189">Serialización de llamadas remotas</span><span class="sxs-lookup"><span data-stu-id="5acae-189">Marshaling Remote Calls</span></span>  
 <span data-ttu-id="5acae-190">Al igual que con la serialización entre apartamentos, la serialización de COM participa en todas las llamadas entre código administrado y no administrado siempre que los objetos residan en procesos independientes.</span><span class="sxs-lookup"><span data-stu-id="5acae-190">As with cross-apartment marshaling, COM marshaling is involved in each call between managed and unmanaged code whenever the objects reside in separate processes.</span></span> <span data-ttu-id="5acae-191">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="5acae-191">For example:</span></span>  
  
-   <span data-ttu-id="5acae-192">Un cliente COM que invoca a un servidor administrado en un host remoto usa COM distribuido (DCOM).</span><span class="sxs-lookup"><span data-stu-id="5acae-192">A COM client that invokes a managed server on a remote host uses distributed COM (DCOM).</span></span>  
  
-   <span data-ttu-id="5acae-193">Un cliente administrado que invoca a un servidor COM en un host remoto usa DCOM.</span><span class="sxs-lookup"><span data-stu-id="5acae-193">A managed client that invokes a COM server on a remote host uses DCOM.</span></span>  
  
 <span data-ttu-id="5acae-194">En la ilustración siguiente se muestra cómo la serialización de interoperabilidad y la serialización de COM proporcionan canales de comunicación a través de procesos y límites de hosts.</span><span class="sxs-lookup"><span data-stu-id="5acae-194">The following illustration shows how interop marshaling and COM marshaling provide communications channels across process and host boundaries.</span></span>  
  
 <span data-ttu-id="5acae-195">![Serialización COM](../../../docs/framework/interop/media/interophost.gif "interophost")</span><span class="sxs-lookup"><span data-stu-id="5acae-195">![COM marshaling](../../../docs/framework/interop/media/interophost.gif "interophost")</span></span>  
<span data-ttu-id="5acae-196">Serialización entre procesos</span><span class="sxs-lookup"><span data-stu-id="5acae-196">Cross-process marshaling</span></span>  
  
### <a name="preserving-identity"></a><span data-ttu-id="5acae-197">Conservar la identidad</span><span class="sxs-lookup"><span data-stu-id="5acae-197">Preserving Identity</span></span>  
 <span data-ttu-id="5acae-198">Common Language Runtime conserva la identidad de las referencias administradas y no administradas.</span><span class="sxs-lookup"><span data-stu-id="5acae-198">The common language runtime preserves the identity of managed and unmanaged references.</span></span> <span data-ttu-id="5acae-199">En la siguiente ilustración se muestra el flujo de referencias directas no administradas (fila superior) y de referencias directas administradas (fila inferior) entre procesos y límites de hosts.</span><span class="sxs-lookup"><span data-stu-id="5acae-199">The following illustration shows the flow of direct unmanaged references (top row) and direct managed references (bottom row) across process and host boundaries.</span></span>  
  
 <span data-ttu-id="5acae-200">![Contenedor CCW y contenedor RCW](../../../docs/framework/interop/media/interopdirectref.gif "interopdirectref")</span><span class="sxs-lookup"><span data-stu-id="5acae-200">![COM callable wrapper and runtime callable wrapper](../../../docs/framework/interop/media/interopdirectref.gif "interopdirectref")</span></span>  
<span data-ttu-id="5acae-201">Paso de referencia entre límites de hosts y procesos</span><span class="sxs-lookup"><span data-stu-id="5acae-201">Reference passing across process and host boundaries</span></span>  
  
 <span data-ttu-id="5acae-202">En esta ilustración:</span><span class="sxs-lookup"><span data-stu-id="5acae-202">In this illustration:</span></span>  
  
-   <span data-ttu-id="5acae-203">Un cliente no administrado obtiene una referencia a un objeto COM de un objeto administrado que obtiene esta referencia de un host remoto.</span><span class="sxs-lookup"><span data-stu-id="5acae-203">An unmanaged client gets a reference to a COM object from a managed object that gets this reference from a remote host.</span></span> <span data-ttu-id="5acae-204">El mecanismo de comunicación remota es DCOM.</span><span class="sxs-lookup"><span data-stu-id="5acae-204">The remoting mechanism is DCOM.</span></span>  
  
-   <span data-ttu-id="5acae-205">Un cliente administrado obtiene una referencia a un objeto administrado de un objeto COM que obtiene esta referencia de un host remoto.</span><span class="sxs-lookup"><span data-stu-id="5acae-205">A managed client gets a reference to a managed object from a COM object that gets this reference from a remote host.</span></span> <span data-ttu-id="5acae-206">El mecanismo de comunicación remota es DCOM.</span><span class="sxs-lookup"><span data-stu-id="5acae-206">The remoting mechanism is DCOM.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="5acae-207">La biblioteca de tipos exportada del servidor administrado debe estar registrada.</span><span class="sxs-lookup"><span data-stu-id="5acae-207">The exported type library of the managed server must be registered.</span></span>  
  
 <span data-ttu-id="5acae-208">El número de límites de procesos entre llamador y destinatario es irrelevante; la misma referencia directa se produce para las llamadas en proceso y fuera de proceso.</span><span class="sxs-lookup"><span data-stu-id="5acae-208">The number of process boundaries between caller and callee is irrelevant; the same direct referencing occurs for in-process and out-of-process calls.</span></span>  
  
### <a name="managed-remoting"></a><span data-ttu-id="5acae-209">Comunicación remota administrada</span><span class="sxs-lookup"><span data-stu-id="5acae-209">Managed Remoting</span></span>  
 <span data-ttu-id="5acae-210">El runtime también proporciona comunicación remota administrada que puede usarse para establecer un canal de comunicaciones entre objetos administrados a través varios procesos y límites de hosts.</span><span class="sxs-lookup"><span data-stu-id="5acae-210">The runtime also provides managed remoting, which you can use to establish a communications channel between managed objects across process and host boundaries.</span></span> <span data-ttu-id="5acae-211">La comunicación remota administrada puede alojar un firewall entre los componentes de la comunicación, como se muestra en la ilustración siguiente.</span><span class="sxs-lookup"><span data-stu-id="5acae-211">Managed remoting can accommodate a firewall between the communicating components, as the following illustration shows.</span></span>  
  
 <span data-ttu-id="5acae-212">![SOAP o TcpChannel](../../../docs/framework/interop/media/interopremotesoap.gif "interopremotesoap")</span><span class="sxs-lookup"><span data-stu-id="5acae-212">![SOAP or TcpChannel](../../../docs/framework/interop/media/interopremotesoap.gif "interopremotesoap")</span></span>  
<span data-ttu-id="5acae-213">Llamadas remotas a través de firewalls que usan SOAP o la clase TcpChannel</span><span class="sxs-lookup"><span data-stu-id="5acae-213">Remote calls across firewalls using SOAP or the TcpChannel class</span></span>  
  
 <span data-ttu-id="5acae-214">Algunas llamadas no administradas pueden canalizarse mediante SOAP, como las llamadas entre [componentes con servicio](http://msdn.microsoft.com/en-us/f109ee24-81ad-4d99-9892-51ac6f34978c) y COM.</span><span class="sxs-lookup"><span data-stu-id="5acae-214">Some unmanaged calls can be channeled through SOAP, such as the calls between [serviced components](http://msdn.microsoft.com/en-us/f109ee24-81ad-4d99-9892-51ac6f34978c) and COM.</span></span>  
  
 [<span data-ttu-id="5acae-215">Volver al principio</span><span class="sxs-lookup"><span data-stu-id="5acae-215">Back to top</span></span>](#top)  
  
<a name="related_topics"></a>   
## <a name="related-topics"></a><span data-ttu-id="5acae-216">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="5acae-216">Related Topics</span></span>  
  
|<span data-ttu-id="5acae-217">Título</span><span class="sxs-lookup"><span data-stu-id="5acae-217">Title</span></span>|<span data-ttu-id="5acae-218">Descripción</span><span class="sxs-lookup"><span data-stu-id="5acae-218">Description</span></span>|  
|-----------|-----------------|  
|[<span data-ttu-id="5acae-219">Comportamiento predeterminado del cálculo de referencias</span><span class="sxs-lookup"><span data-stu-id="5acae-219">Default Marshaling Behavior</span></span>](../../../docs/framework/interop/default-marshaling-behavior.md)|<span data-ttu-id="5acae-220">Describe las reglas que usa el servicio de serialización de interoperabilidad para serializar datos.</span><span class="sxs-lookup"><span data-stu-id="5acae-220">Describes the rules that the interop marshaling service uses to marshal data.</span></span>|  
|[<span data-ttu-id="5acae-221">Serialización de datos con invocación de plataforma</span><span class="sxs-lookup"><span data-stu-id="5acae-221">Marshaling Data with Platform Invoke</span></span>](../../../docs/framework/interop/marshaling-data-with-platform-invoke.md)|<span data-ttu-id="5acae-222">Describe cómo se declaran parámetros de método y se pasan argumentos a funciones exportadas por bibliotecas no administradas.</span><span class="sxs-lookup"><span data-stu-id="5acae-222">Describes how to declare method parameters and pass arguments to functions exported by unmanaged libraries.</span></span>|  
|[<span data-ttu-id="5acae-223">Serialización de datos con la interoperabilidad COM</span><span class="sxs-lookup"><span data-stu-id="5acae-223">Marshaling Data with COM Interop</span></span>](../../../docs/framework/interop/marshaling-data-with-com-interop.md)|<span data-ttu-id="5acae-224">Describe cómo se personalizan los contenedores COM para alterar el comportamiento de la serialización.</span><span class="sxs-lookup"><span data-stu-id="5acae-224">Describes how to customize COM wrappers to alter marshaling behavior.</span></span>|  
|[<span data-ttu-id="5acae-225">Cómo: Migrar código administrado DCOM a WCF</span><span class="sxs-lookup"><span data-stu-id="5acae-225">How to: Migrate Managed-Code DCOM to WCF</span></span>](../../../docs/framework/interop/how-to-migrate-managed-code-dcom-to-wcf.md)|<span data-ttu-id="5acae-226">Describe cómo se migra de DCOM a WCF.</span><span class="sxs-lookup"><span data-stu-id="5acae-226">Describes how to migrate from DCOM to WCF.</span></span>|  
|[<span data-ttu-id="5acae-227">Asignar resultados HRESULT y excepciones</span><span class="sxs-lookup"><span data-stu-id="5acae-227">How to: Map HRESULTs and Exceptions</span></span>](../../../docs/framework/interop/how-to-map-hresults-and-exceptions.md)|<span data-ttu-id="5acae-228">Describe cómo se asignan excepciones personalizadas a valores HRESULT y proporciona la asignación completa de cada HRESULT a su clase de excepción comparable en .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="5acae-228">Describes how to map custom exceptions to HRESULTs and provides the complete mapping from each HRESULT to its comparable exception class in the .NET Framework.</span></span>|  
|[<span data-ttu-id="5acae-229">Interoperar mediante tipos genéricos</span><span class="sxs-lookup"><span data-stu-id="5acae-229">Interoperating Using Generic Types</span></span>](http://msdn.microsoft.com/en-us/26b88e03-085b-4b53-94ba-a5a9c709ce58)|<span data-ttu-id="5acae-230">Describe qué acciones se admiten al usar tipos genéricos para la interoperabilidad COM.</span><span class="sxs-lookup"><span data-stu-id="5acae-230">Describes which actions are supported when using generic types for COM interoperability.</span></span>|  
|<span data-ttu-id="5acae-231">[Interoperating with Unmanaged Code](../../../docs/framework/interop/index.md) (Interoperar con código no administrado)</span><span class="sxs-lookup"><span data-stu-id="5acae-231">[Interoperating with Unmanaged Code](../../../docs/framework/interop/index.md)</span></span>|<span data-ttu-id="5acae-232">Describe los servicios de interoperabilidad proporcionados por Common Language Runtime.</span><span class="sxs-lookup"><span data-stu-id="5acae-232">Describes interoperability services provided by the common language runtime.</span></span>|  
|[<span data-ttu-id="5acae-233">Interoperabilidad COM avanzada</span><span class="sxs-lookup"><span data-stu-id="5acae-233">Advanced COM Interoperability</span></span>](http://msdn.microsoft.com/en-us/3ada36e5-2390-4d70-b490-6ad8de92f2fb)|<span data-ttu-id="5acae-234">Proporciona vínculos a más información sobre la incorporación de componentes COM en una aplicación de .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="5acae-234">Provides links to more information about incorporating COM components into your .NET Framework application.</span></span>|  
|[<span data-ttu-id="5acae-235">Consideraciones de diseño para interoperaciones</span><span class="sxs-lookup"><span data-stu-id="5acae-235">Design Considerations for Interoperation</span></span>](http://msdn.microsoft.com/en-us/b59637f6-fe35-40d6-ae72-901e7a707689)|<span data-ttu-id="5acae-236">Proporciona sugerencias para escribir componentes COM integrados.</span><span class="sxs-lookup"><span data-stu-id="5acae-236">Provides tips for writing integrated COM components.</span></span>|  
  
 [<span data-ttu-id="5acae-237">Volver al principio</span><span class="sxs-lookup"><span data-stu-id="5acae-237">Back to top</span></span>](#top)  
  
<a name="reference"></a>   
## <a name="reference"></a><span data-ttu-id="5acae-238">Referencia</span><span class="sxs-lookup"><span data-stu-id="5acae-238">Reference</span></span>  
 <xref:System.Runtime.InteropServices?displayProperty=nameWithType>  
  
 [<span data-ttu-id="5acae-239">Volver al principio</span><span class="sxs-lookup"><span data-stu-id="5acae-239">Back to top</span></span>](#top)
