---
title: Retraso absoluto
ms.date: 03/30/2017
ms.assetid: b483139a-39bb-4560-8003-8969a8fc2cd1
ms.openlocfilehash: 30719a4340b738a7462584c4dca00f6d5d90ac72
ms.sourcegitcommit: efff8f331fd9467f093f8ab8d23a203d6ecb5b60
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/03/2018
ms.locfileid: "43486107"
---
# <a name="absolute-delay"></a><span data-ttu-id="cca13-102">Retraso absoluto</span><span class="sxs-lookup"><span data-stu-id="cca13-102">Absolute Delay</span></span>
<span data-ttu-id="cca13-103">El escenario principal de este ejemplo es el retraso hasta un valor de <xref:System.DateTime> especificado utilizando temporizadores duraderos en una aplicación de flujo de trabajo.</span><span class="sxs-lookup"><span data-stu-id="cca13-103">The main scenario for this sample is to delay until a specified <xref:System.DateTime> using durable timers in a workflow application.</span></span> <span data-ttu-id="cca13-104">Esto es diferente a utilizar la actividad <xref:System.Activities.Statements.Delay> integrada, ya que en este caso solo se permitirá el retraso para un valor de <xref:System.TimeSpan> (o número de minutos/segundos) determinado.</span><span class="sxs-lookup"><span data-stu-id="cca13-104">This is different from using the built-in <xref:System.Activities.Statements.Delay> activity as this will only allow you to delay for a given <xref:System.TimeSpan> (or number of minutes/seconds).</span></span>  
  
 <span data-ttu-id="cca13-105">A continuación se enumeran algunos escenarios de la vida real en los que se puede desear realizar esta distinción:</span><span class="sxs-lookup"><span data-stu-id="cca13-105">Some real-life scenarios in which you may want to make this distinction include the following:</span></span>  
  
1.  <span data-ttu-id="cca13-106">Desea retrasar el envío de un mensaje de correo durante 30 segundos para asegurarse de que no ha cometido errores.</span><span class="sxs-lookup"><span data-stu-id="cca13-106">You want to delay sending a mail for 30 seconds to make sure you didn’t make any errors.</span></span>  
  
2.  <span data-ttu-id="cca13-107">Está realizando horas extraordinarias y desea retrasar todos sus mensajes de correo hasta el horario laboral normal (por ejemplo, 8 a.m.).</span><span class="sxs-lookup"><span data-stu-id="cca13-107">You are working overtime and want to delay all of your mails until normal business hours (such as 8 am).</span></span>  
  
## <a name="demonstrates"></a><span data-ttu-id="cca13-108">Demostraciones</span><span class="sxs-lookup"><span data-stu-id="cca13-108">Demonstrates</span></span>  
  
1.  <span data-ttu-id="cca13-109"><xref:System.Activities.Statements.DurableTimerExtension> para implementar retraso absoluto</span><span class="sxs-lookup"><span data-stu-id="cca13-109"><xref:System.Activities.Statements.DurableTimerExtension> for implementing Absolute Delay</span></span>  
  
2.  <span data-ttu-id="cca13-110">Configurar la persistencia utilizando <xref:System.Activities.WorkflowApplication> para temporizadores duraderos</span><span class="sxs-lookup"><span data-stu-id="cca13-110">Setting up persistence using <xref:System.Activities.WorkflowApplication> for Durable Timers</span></span>  
  
3.  <span data-ttu-id="cca13-111">Uso de <xref:System.Activities.NativeActivity%601> para utilizar puntos de extensibilidad</span><span class="sxs-lookup"><span data-stu-id="cca13-111">Use of <xref:System.Activities.NativeActivity%601> for using Extensibility points</span></span>  
  
4.  <span data-ttu-id="cca13-112">Uso de <xref:System.Activities.CodeActivity%601> en la actividad SendEmail.</span><span class="sxs-lookup"><span data-stu-id="cca13-112">Use of <xref:System.Activities.CodeActivity%601> in the SendEmail activity</span></span>  
  
5.  <xref:System.Activities.Statements.Delay>  
  
6.  <span data-ttu-id="cca13-113">Flujo de trabajo de solo XAML</span><span class="sxs-lookup"><span data-stu-id="cca13-113">XAML-only workflow</span></span>  
  
 <span data-ttu-id="cca13-114">En este ejemplo se muestra cómo crear una actividad personalizada que toma un valor de <xref:System.DateTime> y utiliza temporizadores duraderos para registrar la duración del retraso.</span><span class="sxs-lookup"><span data-stu-id="cca13-114">This sample demonstrates how to create a custom activity which takes in a <xref:System.DateTime> and uses durable timers to register the delay duration.</span></span> <span data-ttu-id="cca13-115">Cuando se utilizan temporizadores duraderos, se debe usar una actividad <xref:System.Activities.NativeActivity> para crear un marcador, ya que será necesario registrar este marcador con la extensión de temporizador.</span><span class="sxs-lookup"><span data-stu-id="cca13-115">When using durable timers, you must use a <xref:System.Activities.NativeActivity> to create a bookmark, as you will need to register this bookmark with the timer extension.</span></span> <span data-ttu-id="cca13-116">En este ejemplo, cuando el temporizador duradero expire, se llamará al método `OnTimerExpired`.</span><span class="sxs-lookup"><span data-stu-id="cca13-116">In this sample, when the durable timer expires, the `OnTimerExpired` method will be called.</span></span> <span data-ttu-id="cca13-117">Asegúrese de que está agregando la extensión de temporizador en el evento <xref:System.Activities.NativeActivity%601.CacheMetadata%2A> para tener la garantía de que está proporcionando esta información al runtime.</span><span class="sxs-lookup"><span data-stu-id="cca13-117">Make sure that you are adding the timer extension in the <xref:System.Activities.NativeActivity%601.CacheMetadata%2A> event to ensure you are providing the runtime with this information.</span></span> <span data-ttu-id="cca13-118">El otro único detalle de la implementación es que necesitará implementar la lógica para convertir de <xref:System.DateTime> a <xref:System.TimeSpan>, ya que los temporizadores duraderos solo toman un valor de <xref:System.DateTime>.</span><span class="sxs-lookup"><span data-stu-id="cca13-118">The only other implementation detail is that you will need to implement logic to convert from <xref:System.DateTime> to <xref:System.TimeSpan>, as durable timers only take in a <xref:System.DateTime>.</span></span> <span data-ttu-id="cca13-119">Observe que esto implica la existencia de un lapso pequeño en la precisión.</span><span class="sxs-lookup"><span data-stu-id="cca13-119">Do note that there is a small lapse in accuracy by doing</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="cca13-120">Hay una ligera pérdida de precisión al convertir de <xref:System.DateTime> a <xref:System.TimeSpan>.</span><span class="sxs-lookup"><span data-stu-id="cca13-120">There is a small loss of accuracy by converting from <xref:System.DateTime> to <xref:System.TimeSpan>.</span></span>  
  
 <span data-ttu-id="cca13-121">En este ejemplo también se muestra cómo activar la persistencia para un elemento <xref:System.Activities.WorkflowApplication>.</span><span class="sxs-lookup"><span data-stu-id="cca13-121">This sample also demonstrates how to turn on persistence for a <xref:System.Activities.WorkflowApplication>.</span></span> <span data-ttu-id="cca13-122">En este ejemplo concreto, utilizaremos temporizadores duraderos en los que los datos de flujo de trabajo se descargarán en la base de datos de persistencia durante el tiempo de inactividad mientras se espera que el temporizador expire.</span><span class="sxs-lookup"><span data-stu-id="cca13-122">For this particular sample, we will be using durable timers in which the workflow data will be unloaded into the persistence database during the idle time while waiting for timer to expire.</span></span> <span data-ttu-id="cca13-123">Esta implementación también se puede utilizar para otras acciones de persistencia.</span><span class="sxs-lookup"><span data-stu-id="cca13-123">This implementation can also be used for other persistence actions.</span></span> <span data-ttu-id="cca13-124">En este ejemplo, se muestra cómo configurar la cadena de conexión de persistencia con SQL Server y cómo crear el almacén de instancias para conservar los datos de las instancias de flujo de trabajo.</span><span class="sxs-lookup"><span data-stu-id="cca13-124">This sample shows how to set up the persistence connection string with SQL Server, and how to create the instance store in order to persist the data for workflow instances.</span></span> <span data-ttu-id="cca13-125">Se proporciona lógica sobre cómo reanudar el flujo de trabajo una vez producido un evento que hace que la instancia de flujo de trabajo se pueda ejecutar.</span><span class="sxs-lookup"><span data-stu-id="cca13-125">Logic is provided on how to resume the workflow once an event is raised which makes the workflow instance runnable.</span></span>  
  
 <span data-ttu-id="cca13-126">Paso a paso a través de este ejemplo, verá el tiempo en el que el retraso integrado comienza y finaliza, que a su vez producirá que se envíe un mensaje de correo electrónico.</span><span class="sxs-lookup"><span data-stu-id="cca13-126">As you step through this sample, you will see the time in which the built-in delay begins and completes, which in turn will cause an email message to be sent.</span></span> <span data-ttu-id="cca13-127">A partir de ese momento, la actividad AbsoluteDelay se detendrá hasta un valor de <xref:System.DateTime> especificado (o 0 segundos si el valor de <xref:System.DateTime> ha expirado), produciéndose a su vez el envío de un mensaje de correo electrónico tras la expiración.</span><span class="sxs-lookup"><span data-stu-id="cca13-127">From there, the AbsoluteDelay activity will halt until a specified <xref:System.DateTime> (or 0 seconds if the <xref:System.DateTime> has expired) which in turn will send out an email upon expiration.</span></span> <span data-ttu-id="cca13-128">De este modo, se mostrarán los dos casos de uso diferentes de la funcionalidad de la actividad <xref:System.Activities.Statements.Delay> integrada frente al uso de una actividad AbsoluteDelay.</span><span class="sxs-lookup"><span data-stu-id="cca13-128">This will show the two different use cases of the built-in <xref:System.Activities.Statements.Delay> functionality versus using an AbsoluteDelay activity.</span></span>  
  
#### <a name="to-set-up-build-and-run-the-sample"></a><span data-ttu-id="cca13-129">Configurar, compilar y ejecutar el ejemplo</span><span class="sxs-lookup"><span data-stu-id="cca13-129">To set up, build, and run the sample</span></span>  
  
1.  <span data-ttu-id="cca13-130">Asegúrese de que tiene instalado en su equipo SQL Server Express (o posterior).</span><span class="sxs-lookup"><span data-stu-id="cca13-130">Ensure you have SQL Server Express (or higher) installed on your machine</span></span>  
  
2.  <span data-ttu-id="cca13-131">Ejecute setup.cmd (desde WF/Basic/Services/AbsoluteDelay/CS) en un símbolo del sistema de [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)] para crear la base de datos AbsoluteDelaySampleDB, el esquema de persistencia y la lógica de persistencia.</span><span class="sxs-lookup"><span data-stu-id="cca13-131">Run setup.cmd (from WF/Basic/Services/AbsoluteDelay/CS) in a [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)] command prompt to create the AbsoluteDelaySampleDB database, create the persistence schema and create the persistence logic.</span></span>  
  
3.  <span data-ttu-id="cca13-132">Abra la solución en [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cca13-132">Open the solution in [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)].</span></span>  
  
4.  <span data-ttu-id="cca13-133">Especifique la duración de la actividad Delay.</span><span class="sxs-lookup"><span data-stu-id="cca13-133">Specify the Duration in the Delay activity.</span></span>  
  
5.  <span data-ttu-id="cca13-134">Especifique el valor de ExpirationTime de la actividad AbsoluteDelay.</span><span class="sxs-lookup"><span data-stu-id="cca13-134">Specify the ExpirationTime in the AbsoluteDelay activity.</span></span>  
  
6.  <span data-ttu-id="cca13-135">Actualice los campos SendMailTo, SendMailFrom, SendMailSubject, SendMailBody y SmtpHost en la actividad SendMail.</span><span class="sxs-lookup"><span data-stu-id="cca13-135">Update the SendMailTo, SendMailFrom, SendMailSubject, SendMailBody, and SmtpHost fields in the SendMail activity.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="cca13-136">Si no especifica un host de SMTP válido, la aplicación producirá una excepción SMTP.</span><span class="sxs-lookup"><span data-stu-id="cca13-136">If you do not enter a valid SMTP host, the application will throw a SMTP exception.</span></span>  
  
7.  <span data-ttu-id="cca13-137">Compile la solución seleccionando **compilar**, **compilar solución**.</span><span class="sxs-lookup"><span data-stu-id="cca13-137">Build the solution by selecting **Build**, **Build Solution**.</span></span>  
  
8.  <span data-ttu-id="cca13-138">Ejecute la solución presionando **F5**.</span><span class="sxs-lookup"><span data-stu-id="cca13-138">Run the solution by pressing **F5**.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="cca13-139">Puede que los ejemplos ya estén instalados en su equipo.</span><span class="sxs-lookup"><span data-stu-id="cca13-139">The samples may already be installed on your machine.</span></span> <span data-ttu-id="cca13-140">Compruebe el siguiente directorio (predeterminado) antes de continuar.</span><span class="sxs-lookup"><span data-stu-id="cca13-140">Check for the following (default) directory before continuing.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  <span data-ttu-id="cca13-141">Si no existe este directorio, vaya a [Windows Communication Foundation (WCF) y Windows Workflow Foundation (WF) Samples para .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) para descargar todos los Windows Communication Foundation (WCF) y [!INCLUDE[wf1](../../../../includes/wf1-md.md)] ejemplos.</span><span class="sxs-lookup"><span data-stu-id="cca13-141">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="cca13-142">Este ejemplo se encuentra en el siguiente directorio.</span><span class="sxs-lookup"><span data-stu-id="cca13-142">This sample is located in the following directory.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WF\Basic\Services\AbsoluteDelay`
