---
title: Patrón de autoconfirmación
ms.date: 03/30/2017
ms.assetid: 668aec65-78d3-4636-9c7b-deed643a18f9
ms.openlocfilehash: a032c05743b64fe58b0b187328b5216080ba6e19
ms.sourcegitcommit: a885cc8c3e444ca6471348893d5373c6e9e49a47
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/06/2018
ms.locfileid: "43864060"
---
# <a name="auto-confirm-pattern"></a><span data-ttu-id="f5b1c-102">Patrón de autoconfirmación</span><span class="sxs-lookup"><span data-stu-id="f5b1c-102">Auto-Confirm Pattern</span></span>
<span data-ttu-id="f5b1c-103">Este ejemplo consta de tres escenarios que se ejecutan para mostrar una actividad `AutoConfirmScope` personalizada.</span><span class="sxs-lookup"><span data-stu-id="f5b1c-103">This sample consists of three scenarios that run illustrating a custom `AutoConfirmScope` activity.</span></span> <span data-ttu-id="f5b1c-104">En el primer ejemplo se muestra la ejecución correcta de una secuencia de cuatro actividades de compensación, donde las actividades segunda y tercera están anidadas en una actividad `AutoConfirmScope`.</span><span class="sxs-lookup"><span data-stu-id="f5b1c-104">The first sample shows the successful execution of a sequence of four compensable activities where the second and third are nested in an `AutoConfirmScope`.</span></span> <span data-ttu-id="f5b1c-105">En el segundo ejemplo se muestra la misma secuencia, con una excepción que se produce después de la ejecución de la cuarta actividad <xref:System.Activities.Statements.CompensableActivity>.</span><span class="sxs-lookup"><span data-stu-id="f5b1c-105">The second sample shows the same sequence with an exception occurring after the execution of the fourth <xref:System.Activities.Statements.CompensableActivity>.</span></span> <span data-ttu-id="f5b1c-106">En el tercer escenario se muestra la misma secuencia, con una excepción que se produce en la actividad `AutoConfirmScope` después de que se complete la segunda actividad <xref:System.Activities.Statements.CompensableActivity>.</span><span class="sxs-lookup"><span data-stu-id="f5b1c-106">The third scenario shows the same sequence with an exception occurring in the `AutoConfirmScope` after the second <xref:System.Activities.Statements.CompensableActivity> completes.</span></span>  
  
 <span data-ttu-id="f5b1c-107">El ejemplo muestra el patrón de autoconfirmación, donde todas las actividades de compensación secundarias se confirman al completarse correctamente el ámbito.</span><span class="sxs-lookup"><span data-stu-id="f5b1c-107">The sample demonstrates the auto-confirm pattern where all child compensable activities are confirmed upon successful completion of the scope.</span></span> <span data-ttu-id="f5b1c-108">Este patrón define la duración de todas las actividades de compensación secundarias, puesto que ya no se pueden compensar ni confirmar.</span><span class="sxs-lookup"><span data-stu-id="f5b1c-108">This pattern defines the lifetime of all child compensable activities, as they can no longer be compensated or confirmed.</span></span>  
  
 <span data-ttu-id="f5b1c-109">El ámbito consta de una clase <xref:System.Activities.Statements.TryCatch> donde la propiedad <xref:System.Activities.Statements.TryCatch.Try%2A> es una actividad <xref:System.Activities.Statements.CompensableActivity> interna.</span><span class="sxs-lookup"><span data-stu-id="f5b1c-109">The scope consists of a <xref:System.Activities.Statements.TryCatch> where the <xref:System.Activities.Statements.TryCatch.Try%2A> is an internal <xref:System.Activities.Statements.CompensableActivity>.</span></span> <span data-ttu-id="f5b1c-110">El cuerpo especificado por el usuario de la actividad `AutoConfirmScope` es el cuerpo de la actividad <xref:System.Activities.Statements.CompensableActivity> interna.</span><span class="sxs-lookup"><span data-stu-id="f5b1c-110">The user-specified body of the `AutoConfirmScope` is the body of the inner <xref:System.Activities.Statements.CompensableActivity>.</span></span> <span data-ttu-id="f5b1c-111">Cuando esta actividad <xref:System.Activities.Statements.CompensableActivity> interna se completa, genera una clase <xref:System.Activities.Statements.CompensationToken> como argumento de salida.</span><span class="sxs-lookup"><span data-stu-id="f5b1c-111">When this internal <xref:System.Activities.Statements.CompensableActivity> completes, it produces a <xref:System.Activities.Statements.CompensationToken> as an out-argument.</span></span> <span data-ttu-id="f5b1c-112">`AutoConfirmScope` utiliza una propiedad <xref:System.Activities.Statements.TryCatch.Finally%2A> para comprobar si se ha generado el token y, si es así, confirma la actividad <xref:System.Activities.Statements.CompensableActivity> interna.</span><span class="sxs-lookup"><span data-stu-id="f5b1c-112">The `AutoConfirmScope` uses a <xref:System.Activities.Statements.TryCatch.Finally%2A> to check whether the token has been produced and if it has then it confirms the inner <xref:System.Activities.Statements.CompensableActivity>.</span></span> <span data-ttu-id="f5b1c-113">La actividad <xref:System.Activities.Statements.CompensableActivity> interna invoca la compensación predeterminada para cualquier actividad de compensación que pueda existir en su cuerpo.</span><span class="sxs-lookup"><span data-stu-id="f5b1c-113">The inner <xref:System.Activities.Statements.CompensableActivity> invokes the default compensation for any compensable activities that may exist in its body.</span></span>  
  
 <span data-ttu-id="f5b1c-114">En el primer escenario se muestra la ejecución correcta del flujo de trabajo y se demuestra que las actividades de compensación segunda y tercera ya están confirmadas cuando se completa el flujo de trabajo y se confirman la primera y la cuarta.</span><span class="sxs-lookup"><span data-stu-id="f5b1c-114">The first scenario shows successful execution of the workflow and demonstrates that the second and third compensable activities are already confirmed when the workflow completes and the first and fourth are confirmed.</span></span> <span data-ttu-id="f5b1c-115">Esto genera un orden de confirmación de tres, dos, cuatro y uno.</span><span class="sxs-lookup"><span data-stu-id="f5b1c-115">This produces a confirmation order of three, two, four, and one.</span></span>  
  
 <span data-ttu-id="f5b1c-116">En el segundo escenario se muestra una excepción una vez que se han completado las cuatro actividades de compensación.</span><span class="sxs-lookup"><span data-stu-id="f5b1c-116">The second scenario shows an exception after the four compensable activities have completed.</span></span> <span data-ttu-id="f5b1c-117">Dado que las actividades de compensación dos y tres ya están confirmadas, no se ven afectadas, pero las actividades primera y cuarta se compensan.</span><span class="sxs-lookup"><span data-stu-id="f5b1c-117">Because compensable activities two and three are already confirmed they are unaffected but one and four are compensated.</span></span> <span data-ttu-id="f5b1c-118">Esto genera la confirmación de tres, la confirmación de dos, la compensación de cuatro y la compensación de uno.</span><span class="sxs-lookup"><span data-stu-id="f5b1c-118">This produces confirm three, confirm two, compensate four and compensate one.</span></span>  
  
 <span data-ttu-id="f5b1c-119">El último escenario muestra la ejecución incorrecta de la actividad `AutoConfirmScope`.</span><span class="sxs-lookup"><span data-stu-id="f5b1c-119">The final scenario shows unsuccessful execution of the `AutoConfirmScope`.</span></span> <span data-ttu-id="f5b1c-120">En este escenario, se produce una excepción después de que se complete la segunda actividad <xref:System.Activities.Statements.CompensableActivity>.</span><span class="sxs-lookup"><span data-stu-id="f5b1c-120">In this scenario, an exception occurs after the completion of the second <xref:System.Activities.Statements.CompensableActivity>.</span></span> <span data-ttu-id="f5b1c-121">Dado que las actividades de compensación tercera y cuarta no se han ejecutado, no se ven afectadas.</span><span class="sxs-lookup"><span data-stu-id="f5b1c-121">Because the third and fourth compensable activities have not executed, they are unaffected.</span></span> <span data-ttu-id="f5b1c-122">Dado que el ámbito no se completó correctamente, la segunda actividad <xref:System.Activities.Statements.CompensableActivity> no se confirma.</span><span class="sxs-lookup"><span data-stu-id="f5b1c-122">Because the scope did not complete successfully, the second <xref:System.Activities.Statements.CompensableActivity> does not get confirmed.</span></span> <span data-ttu-id="f5b1c-123">Esto genera un orden de compensación de dos y uno.</span><span class="sxs-lookup"><span data-stu-id="f5b1c-123">This produces and compensation order of two then one.</span></span>  
  
#### <a name="to-use-this-sample"></a><span data-ttu-id="f5b1c-124">Para utilizar este ejemplo</span><span class="sxs-lookup"><span data-stu-id="f5b1c-124">To use this sample</span></span>  
  
1.  <span data-ttu-id="f5b1c-125">Con [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)], abra el archivo de solución AutoConfirmSample.sln.</span><span class="sxs-lookup"><span data-stu-id="f5b1c-125">Using [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)], open the AutoConfirmSample.sln solution file.</span></span>  
  
2.  <span data-ttu-id="f5b1c-126">Para compilar la solución, presione Ctrl+MAYÚS+B.</span><span class="sxs-lookup"><span data-stu-id="f5b1c-126">To build the solution, press CTRL+SHIFT+B.</span></span>  
  
3.  <span data-ttu-id="f5b1c-127">Para ejecutar la solución, presione CTRL+F5.</span><span class="sxs-lookup"><span data-stu-id="f5b1c-127">To run the solution, press CTRL+F5.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="f5b1c-128">Puede que los ejemplos ya estén instalados en su equipo.</span><span class="sxs-lookup"><span data-stu-id="f5b1c-128">The samples may already be installed on your machine.</span></span> <span data-ttu-id="f5b1c-129">Compruebe el siguiente directorio (predeterminado) antes de continuar.</span><span class="sxs-lookup"><span data-stu-id="f5b1c-129">Check for the following (default) directory before continuing.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  <span data-ttu-id="f5b1c-130">Si no existe este directorio, vaya a [Windows Communication Foundation (WCF) y Windows Workflow Foundation (WF) Samples para .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) para descargar todos los Windows Communication Foundation (WCF) y [!INCLUDE[wf1](../../../../includes/wf1-md.md)] ejemplos.</span><span class="sxs-lookup"><span data-stu-id="f5b1c-130">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="f5b1c-131">Este ejemplo se encuentra en el siguiente directorio.</span><span class="sxs-lookup"><span data-stu-id="f5b1c-131">This sample is located in the following directory.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WF\Scenario\Compensation\AutoConfirm`