---
title: "Solución de problemas de la mensajería en cola"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: a5f2836f-018d-42f5-a571-1e97e64ea5b0
caps.latest.revision: "19"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: a23dd402cdc12cd20ce7273a96df056aeda71ceb
ms.sourcegitcommit: ce279f2d7fe2220e6ea0a25a8a7a5370ddf8d9f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 12/02/2017
---
# <a name="troubleshooting-queued-messaging"></a><span data-ttu-id="b2477-102">Solución de problemas de la mensajería en cola</span><span class="sxs-lookup"><span data-stu-id="b2477-102">Troubleshooting Queued Messaging</span></span>
<span data-ttu-id="b2477-103">Esta sección contiene preguntas comunes y solución de problemas para utilizar las colas en [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b2477-103">This section contains common questions and troubleshooting help for using queues in [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)].</span></span>  
  
## <a name="common-questions"></a><span data-ttu-id="b2477-104">Preguntas comunes</span><span class="sxs-lookup"><span data-stu-id="b2477-104">Common Questions</span></span>  
 <span data-ttu-id="b2477-105">**P: ¿** he usado [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] Beta 1 e instalé instalado la revisión de MSMQ.</span><span class="sxs-lookup"><span data-stu-id="b2477-105">**Q:** I used [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] Beta 1 and I installed the MSMQ hotfix.</span></span> <span data-ttu-id="b2477-106">¿Debo quitar la revisión?</span><span class="sxs-lookup"><span data-stu-id="b2477-106">Do I need to remove the hotfix?</span></span>  
  
 <span data-ttu-id="b2477-107">**R:** Sí.</span><span class="sxs-lookup"><span data-stu-id="b2477-107">**A:** Yes.</span></span> <span data-ttu-id="b2477-108">Esta revisión ya no se admite.</span><span class="sxs-lookup"><span data-stu-id="b2477-108">This hotfix is no longer supported.</span></span> [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]<span data-ttu-id="b2477-109"> ahora funciona en MSMQ sin un requisito de revisión.</span><span class="sxs-lookup"><span data-stu-id="b2477-109"> now works on MSMQ without a hotfix requirement.</span></span>  
  
 <span data-ttu-id="b2477-110">**P: ¿** hay dos enlaces para MSMQ: <xref:System.ServiceModel.NetMsmqBinding> y <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding>.</span><span class="sxs-lookup"><span data-stu-id="b2477-110">**Q:** There are two bindings for MSMQ: <xref:System.ServiceModel.NetMsmqBinding> and <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding>.</span></span> <span data-ttu-id="b2477-111">¿Qué debería utilizar y cuándo?</span><span class="sxs-lookup"><span data-stu-id="b2477-111">What should I use and when?</span></span>  
  
 <span data-ttu-id="b2477-112">**R:** usar la <xref:System.ServiceModel.NetMsmqBinding> cuando desea usar MSMQ como transporte para la comunicación en cola entre dos [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="b2477-112">**A:** Use the <xref:System.ServiceModel.NetMsmqBinding> when you want to use MSMQ as a transport for queued communication between two [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] applications.</span></span> <span data-ttu-id="b2477-113">Utilice <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding> cuando desee utilizar aplicaciones MSMQ existentes para comunicarse con nuevas aplicaciones [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b2477-113">Use the <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding> when you want to use existing MSMQ applications to communicate with new [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] applications.</span></span>  
  
 <span data-ttu-id="b2477-114">**P: ¿** ¿tengo que actualizar MSMQ para usar el <xref:System.ServiceModel.NetMsmqBinding> y `MsmqIntegration` enlaces?</span><span class="sxs-lookup"><span data-stu-id="b2477-114">**Q:** Do I have to upgrade MSMQ to use the <xref:System.ServiceModel.NetMsmqBinding> and `MsmqIntegration` bindings?</span></span>  
  
 <span data-ttu-id="b2477-115">**A:** No.</span><span class="sxs-lookup"><span data-stu-id="b2477-115">**A:** No.</span></span> <span data-ttu-id="b2477-116">Ambos enlaces funcionan con MSMQ 3.0 en [!INCLUDE[wxp](../../../../includes/wxp-md.md)] y [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b2477-116">Both bindings work with MSMQ 3.0 on [!INCLUDE[wxp](../../../../includes/wxp-md.md)] and [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)].</span></span> <span data-ttu-id="b2477-117">Ciertas características de los enlaces se vuelven disponibles al actualizar a MSMQ 4.0 en [!INCLUDE[wv](../../../../includes/wv-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b2477-117">Certain features of the bindings become available when you upgrade to MSMQ 4.0 in [!INCLUDE[wv](../../../../includes/wv-md.md)].</span></span>  
  
 <span data-ttu-id="b2477-118">**P: ¿** ¿qué características de la <xref:System.ServiceModel.NetMsmqBinding> y <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding> enlaces están disponibles en MSMQ 4.0 pero no en MSMQ 3.0?</span><span class="sxs-lookup"><span data-stu-id="b2477-118">**Q:** What features of the <xref:System.ServiceModel.NetMsmqBinding> and <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding> bindings are available in MSMQ 4.0 but not in MSMQ 3.0?</span></span>  
  
 <span data-ttu-id="b2477-119">**R:** las siguientes características están disponibles en MSMQ 4.0 pero no en MSMQ 3.0:</span><span class="sxs-lookup"><span data-stu-id="b2477-119">**A:** The following features are available in MSMQ 4.0 but not in MSMQ 3.0:</span></span>  
  
-   <span data-ttu-id="b2477-120">La cola de mensajes no enviados personalizada solo se admite en MSMQ 4.0.</span><span class="sxs-lookup"><span data-stu-id="b2477-120">Custom dead-letter queue is supported only on MSMQ 4.0.</span></span>  
  
-   <span data-ttu-id="b2477-121">MSMQ 3.0 y 4.0 administran los mensajes dudosos de manera diferente.</span><span class="sxs-lookup"><span data-stu-id="b2477-121">MSMQ 3.0 and 4.0 handle poison messages differently.</span></span>  
  
-   <span data-ttu-id="b2477-122">Sólo MSMQ 4.0 admite la lectura de transacción remota.</span><span class="sxs-lookup"><span data-stu-id="b2477-122">Only MSMQ 4.0 supports remote transacted read.</span></span>  
  
 [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)]<span data-ttu-id="b2477-123">[Diferencias en las características de puesta en cola en Windows Vista, Windows Server 2003 y Windows XP](../../../../docs/framework/wcf/feature-details/diff-in-queue-in-vista-server-2003-windows-xp.md).</span><span class="sxs-lookup"><span data-stu-id="b2477-123"> [Differences in Queuing Features in Windows Vista, Windows Server 2003, and Windows XP](../../../../docs/framework/wcf/feature-details/diff-in-queue-in-vista-server-2003-windows-xp.md).</span></span>  
  
 <span data-ttu-id="b2477-124">**P: ¿** puedo usar MSMQ 3.0 en un lado de una comunicación en cola y MSMQ 4.0 en el otro lado?</span><span class="sxs-lookup"><span data-stu-id="b2477-124">**Q:** Can I use MSMQ 3.0 on one side of a queued communication and MSMQ 4.0 on the other side?</span></span>  
  
 <span data-ttu-id="b2477-125">**R:** Sí.</span><span class="sxs-lookup"><span data-stu-id="b2477-125">**A:** Yes.</span></span>  
  
 <span data-ttu-id="b2477-126">**P: ¿** deseo integrar aplicaciones MSMQ existentes con nuevas [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] clientes o servidores.</span><span class="sxs-lookup"><span data-stu-id="b2477-126">**Q:** I want to integrate existing MSMQ applications with new [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] clients or servers.</span></span> <span data-ttu-id="b2477-127">¿Necesito actualizar ambos lados de mi infraestructura de MSMQ?</span><span class="sxs-lookup"><span data-stu-id="b2477-127">Do I need to upgrade both sides of my MSMQ infrastructure?</span></span>  
  
 <span data-ttu-id="b2477-128">**A:** No.</span><span class="sxs-lookup"><span data-stu-id="b2477-128">**A:** No.</span></span> <span data-ttu-id="b2477-129">No tiene que actualizar a MSMQ 4.0 en ningún lado.</span><span class="sxs-lookup"><span data-stu-id="b2477-129">You do not have to upgrade to MSMQ 4.0 on either side.</span></span>  
  
## <a name="troubleshooting"></a><span data-ttu-id="b2477-130">Solución de problemas</span><span class="sxs-lookup"><span data-stu-id="b2477-130">Troubleshooting</span></span>  
 <span data-ttu-id="b2477-131">Esta sección contiene las respuestas a la mayoría de problemas más comunes.</span><span class="sxs-lookup"><span data-stu-id="b2477-131">This section contains answers to most common troubleshooting issues.</span></span> <span data-ttu-id="b2477-132">Algunos problemas que son limitaciones conocidas también se describen en las notas de la versión.</span><span class="sxs-lookup"><span data-stu-id="b2477-132">Some issues that are known limitations are also described in the release notes.</span></span>  
  
 <span data-ttu-id="b2477-133">**P: ¿** estoy intentando usar una cola privada y obtengo la excepción siguiente: `System.InvalidOperationException`: la dirección URL no es válida.</span><span class="sxs-lookup"><span data-stu-id="b2477-133">**Q:** I am trying to use a private queue and I get the following exception: `System.InvalidOperationException`: The URL is invalid.</span></span> <span data-ttu-id="b2477-134">La dirección URL para la cola no puede contener el carácter '$'.</span><span class="sxs-lookup"><span data-stu-id="b2477-134">The URL for the queue cannot contain the '$' character.</span></span> <span data-ttu-id="b2477-135">Utilice la sintaxis en net.msmq://machine/private/queueName para direccionar una cola privada.</span><span class="sxs-lookup"><span data-stu-id="b2477-135">Use the syntax in net.msmq://machine/private/queueName to address a private queue.</span></span>  
  
 <span data-ttu-id="b2477-136">**R:** Compruebe el identificador uniforme de recursos (URI) en la configuración y el código.</span><span class="sxs-lookup"><span data-stu-id="b2477-136">**A:** Please check the queue Uniform Resource Identifier (URI) in your configuration and code.</span></span> <span data-ttu-id="b2477-137">No utilice el carácter "$" en el URI.</span><span class="sxs-lookup"><span data-stu-id="b2477-137">Do not use the "$" character in the URI.</span></span> <span data-ttu-id="b2477-138">Por ejemplo, para direccionar una cola privada denominada OrdersQueue, especifique el URI como net.msmq://localhost/private/ordersQueue.</span><span class="sxs-lookup"><span data-stu-id="b2477-138">For example, to address a private queue named OrdersQueue, specify the URI as net.msmq://localhost/private/ordersQueue.</span></span>  
  
 <span data-ttu-id="b2477-139">**P: ¿** al llamar a `ServiceHost.Open()` en mi aplicación en cola, inicia la siguiente excepción: `System.ArgumentException`: una dirección base no puede contener una cadena de consulta URI.</span><span class="sxs-lookup"><span data-stu-id="b2477-139">**Q:** Calling `ServiceHost.Open()` on my queued application throws the following exception: `System.ArgumentException`: A base address cannot contain a URI query string.</span></span> <span data-ttu-id="b2477-140">¿Por qué?</span><span class="sxs-lookup"><span data-stu-id="b2477-140">Why?</span></span>  
  
 <span data-ttu-id="b2477-141">**R:** Compruebe el URI en el archivo de configuración y en el código de la cola.</span><span class="sxs-lookup"><span data-stu-id="b2477-141">**A:** Check the queue URI in your configuration file and in your code.</span></span> <span data-ttu-id="b2477-142">Mientras que las colas de MSMQ admiten el uso del carácter "?", los URI lo interpretan como el principio de una consulta de cadena.</span><span class="sxs-lookup"><span data-stu-id="b2477-142">While MSMQ queues support the use of the '?' character, URIs interpret this character as the beginning of a string query.</span></span> <span data-ttu-id="b2477-143">Para evitar este problema, use nombres de cola que no contengan el carácter "?".</span><span class="sxs-lookup"><span data-stu-id="b2477-143">To avoid this issue, use queue names that do not contain '?' characters.</span></span>  
  
 <span data-ttu-id="b2477-144">**P: ¿** mi envío se realizó correctamente pero se invoca ninguna operación de servicio en el receptor.</span><span class="sxs-lookup"><span data-stu-id="b2477-144">**Q:** My send succeeded but no service operation is invoked on the receiver.</span></span> <span data-ttu-id="b2477-145">¿Por qué?</span><span class="sxs-lookup"><span data-stu-id="b2477-145">Why?</span></span>  
  
 <span data-ttu-id="b2477-146">**R:** para determinar la respuesta, examine la lista de comprobación siguiente:</span><span class="sxs-lookup"><span data-stu-id="b2477-146">**A:** To determine the answer, work through the following check list:</span></span>  
  
-   <span data-ttu-id="b2477-147">Compruebe que los requisitos de cola transaccional sean compatibles con las convicciones especificadas.</span><span class="sxs-lookup"><span data-stu-id="b2477-147">Check that the transactional queue requirements are compatible with the assurances specified.</span></span> <span data-ttu-id="b2477-148">Tenga en cuenta los principios siguientes:</span><span class="sxs-lookup"><span data-stu-id="b2477-148">Note the following principles:</span></span>  
  
    -   <span data-ttu-id="b2477-149">Puede enviar mensajes duraderos (datagramas y sesiones) con "exactamente una" convicción (<xref:System.ServiceModel.MsmqBindingBase.ExactlyOnce%2A> = `true`) solo a una cola transaccional.</span><span class="sxs-lookup"><span data-stu-id="b2477-149">You can send durable messages (datagrams and sessions) with "exactly once" assurances (<xref:System.ServiceModel.MsmqBindingBase.ExactlyOnce%2A> = `true`) only to a transactional queue.</span></span>  
  
    -   <span data-ttu-id="b2477-150">Solo puede enviar las sesiones con "exactamente una" convicción.</span><span class="sxs-lookup"><span data-stu-id="b2477-150">You can send sessions only with "exactly once" assurances.</span></span>  
  
    -   <span data-ttu-id="b2477-151">Se requiere una transacción para recibir mensajes en una sesión de una cola transaccional.</span><span class="sxs-lookup"><span data-stu-id="b2477-151">A transaction is required to receive messages in a session from a transactional queue.</span></span>  
  
    -   <span data-ttu-id="b2477-152">Puede enviar o recibir mensajes volátiles o duraderos (solo datagramas) sin convicciones (<xref:System.ServiceModel.MsmqBindingBase.ExactlyOnce%2A> = `false`) solo a una cola no transaccional.</span><span class="sxs-lookup"><span data-stu-id="b2477-152">You can send or receive volatile or durable messages (datagrams only) with no assurances (<xref:System.ServiceModel.MsmqBindingBase.ExactlyOnce%2A> = `false`) only to a non-transactional queue.</span></span>  
  
-   <span data-ttu-id="b2477-153">Compruebe la cola de mensajes no enviados.</span><span class="sxs-lookup"><span data-stu-id="b2477-153">Check the dead-letter queue.</span></span> <span data-ttu-id="b2477-154">Si encuentra los mensajes allí, determine por qué no se entregaron.</span><span class="sxs-lookup"><span data-stu-id="b2477-154">If you find the messages there, determine why they were not delivered.</span></span>  
  
-   <span data-ttu-id="b2477-155">Compruebe la conectividad o los problemas de direccionamiento de las colas de salida.</span><span class="sxs-lookup"><span data-stu-id="b2477-155">Check the outgoing queues for connectivity or addressing problems.</span></span>  
  
 <span data-ttu-id="b2477-156">**P: ¿** he especificado una cola de mensajes no enviados personalizada, pero cuando inicio la aplicación emisora, se produce una excepción que no se encuentra la cola de mensajes no enviados o la aplicación emisora no tiene ningún permiso a la cola de mensajes no enviados.</span><span class="sxs-lookup"><span data-stu-id="b2477-156">**Q:** I have specified a custom dead-letter queue, but when I start the sender application, I get an exception that either the dead-letter queue is not found, or the sending application has no permission to the dead-letter queue.</span></span> <span data-ttu-id="b2477-157">¿Por qué está sucediendo esto?</span><span class="sxs-lookup"><span data-stu-id="b2477-157">Why is this happening?</span></span>  
  
 <span data-ttu-id="b2477-158">**R:** el URI de cola de mensajes no enviados personalizada debe incluir un "localhost" o el nombre del equipo en el primer segmento, por ejemplo, MSMQ://localhost/Private/cola cola.</span><span class="sxs-lookup"><span data-stu-id="b2477-158">**A:** The custom dead-letter queue URI must include a "localhost" or the computer name in the first segment, for example, net.msmq://localhost/private/myAppdead-letter queue.</span></span>  
  
 <span data-ttu-id="b2477-159">**P: ¿** siempre es necesario definir una cola de mensajes no enviados personalizada o hay una cola de mensajes no enviados predeterminada?</span><span class="sxs-lookup"><span data-stu-id="b2477-159">**Q:** Is it always necessary to define a custom dead-letter queue, or is there a default dead-letter queue?</span></span>  
  
 <span data-ttu-id="b2477-160">**R:** si la convicción es "exactamente una vez" (<xref:System.ServiceModel.MsmqBindingBase.ExactlyOnce%2A> = `true`), y si no especifica una cola de mensajes no enviados personalizada, el valor predeterminado es una cola de mensajes no enviados transaccional para todo el sistema.</span><span class="sxs-lookup"><span data-stu-id="b2477-160">**A:** If assurances are "exactly once" (<xref:System.ServiceModel.MsmqBindingBase.ExactlyOnce%2A> = `true`), and if you do not specify a custom dead-letter queue, the default is a system-wide transactional dead-letter queue.</span></span>  
  
 <span data-ttu-id="b2477-161">Si la convicción es none (<xref:System.ServiceModel.MsmqBindingBase.ExactlyOnce%2A> = `false`), el valor predeterminado es ninguna funcionalidad de cola de mensajes no enviados.</span><span class="sxs-lookup"><span data-stu-id="b2477-161">If assurances are none (<xref:System.ServiceModel.MsmqBindingBase.ExactlyOnce%2A> = `false`), then the default is no dead-letter queue functionality.</span></span>  
  
 <span data-ttu-id="b2477-162">**P: ¿** mi servicio inicia Svchost.Open con un mensaje "que Listenerfactory no puede cumplir requisitos de endpointlistener el".</span><span class="sxs-lookup"><span data-stu-id="b2477-162">**Q:** My service throws on SvcHost.Open with a message "EndpointListener requirements cannot be met by the ListenerFactory".</span></span> <span data-ttu-id="b2477-163">¿Por qué?</span><span class="sxs-lookup"><span data-stu-id="b2477-163">Why?</span></span>  
  
 <span data-ttu-id="b2477-164">Un archivo .</span><span class="sxs-lookup"><span data-stu-id="b2477-164">A.</span></span> <span data-ttu-id="b2477-165">Compruebe su contrato de servicios.</span><span class="sxs-lookup"><span data-stu-id="b2477-165">Check your service contract.</span></span> <span data-ttu-id="b2477-166">Puede que haya olvidado colocar "IsOneWay =`true`" en todas las operaciones de servicio.</span><span class="sxs-lookup"><span data-stu-id="b2477-166">You may have forgotten to put "IsOneWay=`true`" on all the service operations.</span></span> <span data-ttu-id="b2477-167">Las colas solo admiten las operaciones de servicio unidireccionales.</span><span class="sxs-lookup"><span data-stu-id="b2477-167">Queues support only one-way service operations.</span></span>  
  
 <span data-ttu-id="b2477-168">**P: ¿** hay mensajes en la cola, pero se invoca ninguna operación de servicio.</span><span class="sxs-lookup"><span data-stu-id="b2477-168">**Q:** There are messages in the queue but no service operation is invoked.</span></span> <span data-ttu-id="b2477-169">¿Cuál es el problema?</span><span class="sxs-lookup"><span data-stu-id="b2477-169">What is the problem?</span></span>  
  
 <span data-ttu-id="b2477-170">**R:** Determine si su host de servicio funciona correctamente.</span><span class="sxs-lookup"><span data-stu-id="b2477-170">**A:** Determine if your service host is faulted.</span></span> <span data-ttu-id="b2477-171">Lo puede comprobar examinando el seguimiento o implementando `IErrorHandler`.</span><span class="sxs-lookup"><span data-stu-id="b2477-171">You can check by looking at the trace or implementing `IErrorHandler`.</span></span> <span data-ttu-id="b2477-172">El host de servicio, de forma predeterminada, tiene errores si se detecta un mensaje dudoso.</span><span class="sxs-lookup"><span data-stu-id="b2477-172">Service host faults, by default, if a poison message is detected.</span></span>  
  
 <span data-ttu-id="b2477-173">**P: ¿** hay mensajes en la cola pero no se activa mi servicio en cola hospedado en Web.</span><span class="sxs-lookup"><span data-stu-id="b2477-173">**Q:** There are messages in the queue but my Web-hosted queued service is not getting activated.</span></span> <span data-ttu-id="b2477-174">¿Por qué?</span><span class="sxs-lookup"><span data-stu-id="b2477-174">Why?</span></span>  
  
 <span data-ttu-id="b2477-175">**R:** la razón más común es los permisos.</span><span class="sxs-lookup"><span data-stu-id="b2477-175">**A:** The most common reason is permissions.</span></span>  
  
1.  <span data-ttu-id="b2477-176">Asegúrese de que el proceso `NetMsmqActivator` se esté ejecutando y la identidad del proceso `NetMsmqActivator` se lea y busque el permiso en la cola.</span><span class="sxs-lookup"><span data-stu-id="b2477-176">Ensure that the `NetMsmqActivator` process is running and the identity of the `NetMsmqActivator` process is given read and seek permission on the queue.</span></span>  
  
2.  <span data-ttu-id="b2477-177">Si `NetMsmqActivator` está supervisando las colas en un equipo remoto, asegúrese de que `NetMsmqActivator` no se ejecute con un token restringido.</span><span class="sxs-lookup"><span data-stu-id="b2477-177">If the `NetMsmqActivator` is monitoring queues on a remote machine, ensure that `NetMsmqActivator` does not run under a restricted token.</span></span> <span data-ttu-id="b2477-178">Para ejecutar `NetMsmqActivator` con un token sin restricciones:</span><span class="sxs-lookup"><span data-stu-id="b2477-178">To run the `NetMsmqActivator` with an unrestricted token:</span></span>  
  
    ```  
    sc sidtype NetMsmqActivator unrestricted  
    ```  
  
 <span data-ttu-id="b2477-179">Para problemas de seguridad no relacionados con Web host, consulte: [Web hospeda una aplicación en cola](../../../../docs/framework/wcf/feature-details/web-hosting-a-queued-application.md).</span><span class="sxs-lookup"><span data-stu-id="b2477-179">For non-security related Web host issues refer to: [Web Hosting a Queued Application](../../../../docs/framework/wcf/feature-details/web-hosting-a-queued-application.md).</span></span>  
  
 <span data-ttu-id="b2477-180">**P: ¿** ¿qué es la manera más fácil a las sesiones de acceso?</span><span class="sxs-lookup"><span data-stu-id="b2477-180">**Q:** What is the easiest way to access sessions?</span></span>  
  
 <span data-ttu-id="b2477-181">**R:** establezca AutoComplete =`true` en la operación que corresponde al último mensaje de la sesión y establezca AutoComplete =`false` en todas las operaciones de servicio restantes.</span><span class="sxs-lookup"><span data-stu-id="b2477-181">**A:** Set AutoComplete=`true` on the operation that corresponds to the last message in the session, and set AutoComplete=`false` on all remaining service operations.</span></span>  
  
 <span data-ttu-id="b2477-182">**P: ¿** ¿dónde puedo encontrar respuestas a preguntas habituales sobre MSMQ?</span><span class="sxs-lookup"><span data-stu-id="b2477-182">**Q:** Where can I find answers to common questions on MSMQ?</span></span>  
  
 <span data-ttu-id="b2477-183">**R:** [!INCLUDE[crabout](../../../../includes/crabout-md.md)] MSMQ, consulte [Microsoft Message Queue Server](http://go.microsoft.com/fwlink/?LinkId=87810).</span><span class="sxs-lookup"><span data-stu-id="b2477-183">**A:** [!INCLUDE[crabout](../../../../includes/crabout-md.md)] MSMQ, see [Microsoft Message Queuing](http://go.microsoft.com/fwlink/?LinkId=87810).</span></span>  
  
 <span data-ttu-id="b2477-184">**P: ¿** ¿por qué produce mi servicio un `ProtocolException` al leer en una cola que contiene mensajes de sesión en cola y mensajes de datagrama en cola?</span><span class="sxs-lookup"><span data-stu-id="b2477-184">**Q:** Why does my service throw a `ProtocolException` when reading from a queue that contains both queued session messages and queued datagram messages?</span></span>  
  
 <span data-ttu-id="b2477-185">**R:** se componen los mensajes de datagrama en cola y hay una diferencia fundamental en los mensajes de sesión en cola de forma.</span><span class="sxs-lookup"><span data-stu-id="b2477-185">**A:** There is a fundamental difference in the way queued session messages and queued datagram messages are composed.</span></span> <span data-ttu-id="b2477-186">Debido a esto, un servicio que está esperando leer un mensaje de la sesión en cola no puede recibir un mensaje del datagrama en cola y un servicio que espera leer un mensaje del datagrama en cola no puede recibir un mensaje de la sesión.</span><span class="sxs-lookup"><span data-stu-id="b2477-186">Because of this, a service that is expecting to read a queued session message cannot receive a queued datagram message and a service expecting to read a queued datagram message cannot receive a session message.</span></span> <span data-ttu-id="b2477-187">Intentar leer ambos tipos de mensajes de la misma cola provoca la excepción siguiente:</span><span class="sxs-lookup"><span data-stu-id="b2477-187">Attempting to read both types of messages from the same queue throws the following exception:</span></span>  
  
```  
System.ServiceModel.MsmqPoisonMessageException: The transport channel detected a poison message. This occurred because the message exceeded the maximum number of delivery attempts or because the channel detected a fundamental problem with the message. The inner exception may contain additional information.   
---> System.ServiceModel.ProtocolException: An incoming MSMQ message contained invalid or unexpected .NET Message Framing information in its body. The message cannot be received. Ensure that the sender is using a compatible service contract with a matching SessionMode.  
```  
  
 <span data-ttu-id="b2477-188">La cola de mensajes no enviados del sistema, así como cualquier cola de mensajes no enviados personalizada, es particularmente susceptible a este problema si una aplicación envía mensajes de la sesión en cola y mensajes del datagrama en cola desde el mismo equipo.</span><span class="sxs-lookup"><span data-stu-id="b2477-188">The system dead-letter queue, as well as any custom dead-letter queue, is particularly susceptible to this issue if an application sends both queued session messages and queued datagram messages from the same computer.</span></span> <span data-ttu-id="b2477-189">Si no se puede enviar un mensaje correctamente, se mueve a la cola de mensajes no enviados.</span><span class="sxs-lookup"><span data-stu-id="b2477-189">If a message cannot be sent successfully, it is moved to the dead-letter queue.</span></span> <span data-ttu-id="b2477-190">Bajo estas circunstancias, es posible tener mensajes de sesión y datagrama en la cola de mensajes no enviados.</span><span class="sxs-lookup"><span data-stu-id="b2477-190">Under these circumstances, it is possible to have both session and datagram messages in the dead-letter queue.</span></span> <span data-ttu-id="b2477-191">No hay ninguna manera de separar ambos tipos de mensajes en el tiempo de ejecución al leer de una cola, por consiguiente, las aplicaciones no deberían enviar mensajes de la sesión en cola y mensajes del datagrama en cola desde el mismo equipo.</span><span class="sxs-lookup"><span data-stu-id="b2477-191">There is no way to separate both types of messages at runtime when reading from a queue, therefore, applications should not send both queued session messages and queued datagram messages from the same computer.</span></span>  
  
### <a name="msmq-integration-specific-troubleshooting"></a><span data-ttu-id="b2477-192">Integración de MSMQ: Solución de problemas específicos</span><span class="sxs-lookup"><span data-stu-id="b2477-192">MSMQ Integration: Specific Troubleshooting</span></span>  
 <span data-ttu-id="b2477-193">**P: ¿** cuando se envía un mensaje, o cuando abro el host de servicio, obtengo un error que indica el esquema es erróneo.</span><span class="sxs-lookup"><span data-stu-id="b2477-193">**Q:** When I send a message, or when I open the service host, I get an error that indicates the scheme is wrong.</span></span> <span data-ttu-id="b2477-194">¿Por qué?</span><span class="sxs-lookup"><span data-stu-id="b2477-194">Why?</span></span>  
  
 <span data-ttu-id="b2477-195">**R:** cuando se usa el enlace de integración de MSMQ, debe usar el esquema msmq.formatname.</span><span class="sxs-lookup"><span data-stu-id="b2477-195">**A:** When you use the MSMQ integration binding, you must use the msmq.formatname scheme.</span></span> <span data-ttu-id="b2477-196">Por ejemplo, msmq.formatname:DIRECT=OS:. \private $ \OrdersQueue.</span><span class="sxs-lookup"><span data-stu-id="b2477-196">For example, msmq.formatname:DIRECT=OS:.\private$\OrdersQueue.</span></span> <span data-ttu-id="b2477-197">Pero al especificar la cola de mensajes no enviados personalizada, debe utilizar el esquema de net.msmq.</span><span class="sxs-lookup"><span data-stu-id="b2477-197">But when you specify the custom dead-letter queue, you must use the net.msmq scheme.</span></span>  
  
 <span data-ttu-id="b2477-198">**P: ¿** cuando uso un nombre de formato público o privado y abro el host de servicio en [!INCLUDE[wv](../../../../includes/wv-md.md)], obtengo un error.</span><span class="sxs-lookup"><span data-stu-id="b2477-198">**Q:** When I use a public or private format name and open the service host on [!INCLUDE[wv](../../../../includes/wv-md.md)], I get an error.</span></span> <span data-ttu-id="b2477-199">¿Por qué?</span><span class="sxs-lookup"><span data-stu-id="b2477-199">Why?</span></span>  
  
 <span data-ttu-id="b2477-200">**R:** el [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] canal de integración en [!INCLUDE[wv](../../../../includes/wv-md.md)] comprueba si se puede abrir una subcola de la cola de aplicación principal para administrar los mensajes dudosos.</span><span class="sxs-lookup"><span data-stu-id="b2477-200">**A:** The [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] integration channel on [!INCLUDE[wv](../../../../includes/wv-md.md)] checks to see if a sub-queue can be opened for the main application queue for handling poison messages.</span></span> <span data-ttu-id="b2477-201">El nombre de la subcola se deriva de un URI de msmq.formatname pasado a la escucha.</span><span class="sxs-lookup"><span data-stu-id="b2477-201">The sub-queue name is derived from an msmq.formatname URI passed to the listener.</span></span> <span data-ttu-id="b2477-202">El nombre de la subcola en MSMQ solo puede ser un nombre de formato directo.</span><span class="sxs-lookup"><span data-stu-id="b2477-202">The sub-queue name in MSMQ can only be a direct format name.</span></span> <span data-ttu-id="b2477-203">Aquí radica el error.</span><span class="sxs-lookup"><span data-stu-id="b2477-203">So you see the error.</span></span> <span data-ttu-id="b2477-204">Cambie el URI de la cola a un nombre de formato directo.</span><span class="sxs-lookup"><span data-stu-id="b2477-204">Change the queue URI to a direct format name.</span></span>  
  
 <span data-ttu-id="b2477-205">**P: ¿** al recibir un mensaje desde una aplicación MSMQ, el mensaje permanece en la cola y la recepción no lee [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] aplicación.</span><span class="sxs-lookup"><span data-stu-id="b2477-205">**Q:** When receiving a message from an MSMQ application, the message sits in the queue and is not read by the receiving [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] application.</span></span> <span data-ttu-id="b2477-206">¿Por qué?</span><span class="sxs-lookup"><span data-stu-id="b2477-206">Why?</span></span>  
  
 <span data-ttu-id="b2477-207">**R:** Compruebe si el mensaje tiene un cuerpo.</span><span class="sxs-lookup"><span data-stu-id="b2477-207">**A:** Check to see whether the message has a body.</span></span> <span data-ttu-id="b2477-208">Si el mensaje no tiene ningún cuerpo, el canal de integración de MSMQ omite el mensaje.</span><span class="sxs-lookup"><span data-stu-id="b2477-208">If the message has no body, the MSMQ integration channel ignores the message.</span></span> <span data-ttu-id="b2477-209">Implemente `IErrorHandler` para recibir notificaciones de las excepciones y comprobar las trazas.</span><span class="sxs-lookup"><span data-stu-id="b2477-209">Implement `IErrorHandler` to be notified of exceptions and check the traces.</span></span>  
  
### <a name="security-related-troubleshooting"></a><span data-ttu-id="b2477-210">Solución de problemas relacionados con la seguridad</span><span class="sxs-lookup"><span data-stu-id="b2477-210">Security-Related Troubleshooting</span></span>  
 <span data-ttu-id="b2477-211">**P: ¿** cuando ejecuto el ejemplo que usa un enlace predeterminado en modo de grupo de trabajo, los mensajes parecen enviarse pero nunca se reciben por el receptor.</span><span class="sxs-lookup"><span data-stu-id="b2477-211">**Q:** When I run the sample that uses a default binding in workgroup mode, messages seem to get sent but are never received by the receiver.</span></span>  
  
 <span data-ttu-id="b2477-212">**R:** de forma predeterminada, los mensajes se firman con un certificado interno de MSMQ que requiere el servicio de directorio de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="b2477-212">**A:** By default, messages are signed using an MSMQ internal certificate that requires the Active Directory directory service.</span></span> <span data-ttu-id="b2477-213">En modo del grupo de trabajo, puesto que Active Directory no está disponible, la firma de los mensajes falla.</span><span class="sxs-lookup"><span data-stu-id="b2477-213">In workgroup mode, because Active Directory is not available, signing the message fails.</span></span> <span data-ttu-id="b2477-214">Por lo tanto, el mensaje aterriza en la cola de mensajes no enviados y provoca el error, como "Firma no válida", se indica.</span><span class="sxs-lookup"><span data-stu-id="b2477-214">So the message lands in the dead-letter queue and failure cause, such as "Bad signature", is indicated.</span></span>  
  
 <span data-ttu-id="b2477-215">La solución alternativa es desactivar la seguridad.</span><span class="sxs-lookup"><span data-stu-id="b2477-215">The workaround is to turn off security.</span></span> <span data-ttu-id="b2477-216">Esto se hace estableciendo <xref:System.ServiceModel.NetMsmqSecurity.Mode%2A>  =  <xref:System.ServiceModel.NetMsmqSecurityMode.None> para que funcione en modo de grupo de trabajo.</span><span class="sxs-lookup"><span data-stu-id="b2477-216">This is done by setting <xref:System.ServiceModel.NetMsmqSecurity.Mode%2A> = <xref:System.ServiceModel.NetMsmqSecurityMode.None> to make it work in workgroup mode.</span></span>  
  
 <span data-ttu-id="b2477-217">Otra solución alternativa es recibir <xref:System.ServiceModel.MsmqTransportSecurity> de la propiedad <xref:System.ServiceModel.NetMsmqSecurity.Transport%2A> y establecerlo en <xref:System.ServiceModel.MsmqAuthenticationMode.Certificate>y establecer el certificado de cliente.</span><span class="sxs-lookup"><span data-stu-id="b2477-217">Another workaround is to get the <xref:System.ServiceModel.MsmqTransportSecurity> from the <xref:System.ServiceModel.NetMsmqSecurity.Transport%2A> property and set it to <xref:System.ServiceModel.MsmqAuthenticationMode.Certificate>, and set the client certificate.</span></span>  
  
 <span data-ttu-id="b2477-218">Todavía otra solución alternativa es instalar MSMQ con integración de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="b2477-218">Yet another workaround is to install MSMQ with Active Directory integration.</span></span>  
  
 <span data-ttu-id="b2477-219">**P: ¿** cuando envío un mensaje con enlace predeterminado (activada de seguridad de transporte) en Active Directory a una cola, obtengo un mensaje "no se encuentra el certificado interno".</span><span class="sxs-lookup"><span data-stu-id="b2477-219">**Q:** When I send a message with default binding (transport security turned on) in Active Directory to a queue, I get an "internal certificate not found" message.</span></span> <span data-ttu-id="b2477-220">¿Cómo se soluciona?</span><span class="sxs-lookup"><span data-stu-id="b2477-220">How do I fix this?</span></span>  
  
 <span data-ttu-id="b2477-221">**R:** Esto significa que se debe renovar el certificado en Active Directory para el remitente.</span><span class="sxs-lookup"><span data-stu-id="b2477-221">**A:** This means that the certificate in Active Directory for the sender must be renewed.</span></span> <span data-ttu-id="b2477-222">Para ello, abra **el Panel de Control**, **herramientas administrativas**, **administración de equipos**, haga clic en **MSMQ**y seleccione **Propiedades**.</span><span class="sxs-lookup"><span data-stu-id="b2477-222">To do so, open **Control Panel**, **Administrative Tools**, **Computer Management**, right-click **MSMQ**, and select **Properties**.</span></span> <span data-ttu-id="b2477-223">Seleccione el **certificado de usuario** ficha y haga clic en el **renovar** botón.</span><span class="sxs-lookup"><span data-stu-id="b2477-223">Select the **User Certificate** tab and click the **Renew** button.</span></span>  
  
 <span data-ttu-id="b2477-224">**P: ¿** cuando envío un mensaje utilizando <xref:System.ServiceModel.MsmqAuthenticationMode.Certificate> y especificar el certificado que se va a usar, aparece un mensaje de "Certificado no válido".</span><span class="sxs-lookup"><span data-stu-id="b2477-224">**Q:** When I send a message using <xref:System.ServiceModel.MsmqAuthenticationMode.Certificate> and specify the certificate to use, I get an "Invalid certificate" message.</span></span> <span data-ttu-id="b2477-225">¿Cómo se soluciona?</span><span class="sxs-lookup"><span data-stu-id="b2477-225">How do I fix this?</span></span>  
  
 <span data-ttu-id="b2477-226">**R:** no se puede usar un almacén de certificados del equipo local con el modo de certificado.</span><span class="sxs-lookup"><span data-stu-id="b2477-226">**A:** You cannot use a local machine certificate store with certificate mode.</span></span> <span data-ttu-id="b2477-227">Tiene que copiar el certificado del almacén de certificados del equipo al almacén del usuario actual utilizando el complemento del certificado.</span><span class="sxs-lookup"><span data-stu-id="b2477-227">You have to copy the certificate from the machine certificate store to the current user store using the Certificate snap-in.</span></span> <span data-ttu-id="b2477-228">Para obtener el complemento del certificado:</span><span class="sxs-lookup"><span data-stu-id="b2477-228">To get the Certificate snap-in:</span></span>  
  
1.  <span data-ttu-id="b2477-229">Haga clic en **iniciar**, seleccione **ejecutar**, tipo `mmc`y haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="b2477-229">Click **Start**, select **Run**, type `mmc`, and click **OK**.</span></span>  
  
2.  <span data-ttu-id="b2477-230">En el **Microsoft Management Console**, abra el **archivo** menú y seleccione **agregar o quitar complemento**.</span><span class="sxs-lookup"><span data-stu-id="b2477-230">In the **Microsoft Management Console**, open the **File** menu and select **Add/Remove Snap-in**.</span></span>  
  
3.  <span data-ttu-id="b2477-231">En el **agregar o quitar complemento** cuadro de diálogo, haga clic en el **agregar** botón.</span><span class="sxs-lookup"><span data-stu-id="b2477-231">In the **Add/Remove Snap-in** dialog box, click the **Add** button.</span></span>  
  
4.  <span data-ttu-id="b2477-232">En el **Add Standalone Snap-in** cuadro de diálogo, seleccione certificados y haga clic en **agregar**.</span><span class="sxs-lookup"><span data-stu-id="b2477-232">In the **Add Standalone Snap-in** dialog box, select Certificates and click **Add**.</span></span>  
  
5.  <span data-ttu-id="b2477-233">En el **certificados** cuadro de diálogo del complemento, seleccione **mi cuenta de usuario,** y haga clic en **finalizar**.</span><span class="sxs-lookup"><span data-stu-id="b2477-233">In the **Certificates** snap-in dialog box, select **My user account,** and click **Finish**.</span></span>  
  
6.  <span data-ttu-id="b2477-234">A continuación, agregue un segundo complemento certificados utilizando los pasos anteriores, pero esta vez seleccione **cuenta de equipo** y haga clic en **siguiente**.</span><span class="sxs-lookup"><span data-stu-id="b2477-234">Next, add a second Certificates snap-in using the previous steps, but this time select **Computer account** and click **Next**.</span></span>  
  
7.  <span data-ttu-id="b2477-235">Seleccione **equipo Local** y haga clic en **finalizar**.</span><span class="sxs-lookup"><span data-stu-id="b2477-235">Select **Local Computer** and click **Finish**.</span></span> <span data-ttu-id="b2477-236">Ahora puede arrastrar y colocar certificados del almacén de certificados del equipo al almacén del usuario actual.</span><span class="sxs-lookup"><span data-stu-id="b2477-236">You can now drag and drop certificates from the machine certificate store to the current user store.</span></span>  
  
 <span data-ttu-id="b2477-237">**P: ¿** cuando mi servicio lee de una cola en otro equipo en el modo de grupo de trabajo, se produce una excepción de "acceso denegado".</span><span class="sxs-lookup"><span data-stu-id="b2477-237">**Q:** When my service reads from a queue on another computer in workgroup mode, I get an "access denied" exception.</span></span>  
  
 <span data-ttu-id="b2477-238">**R:** en modo de grupo de trabajo, para una aplicación remota obtener acceso a la cola, la aplicación debe tener permiso para tener acceso a la cola.</span><span class="sxs-lookup"><span data-stu-id="b2477-238">**A:** In workgroup mode, for a remote application to gain access to the queue, the application must have permission to access the queue.</span></span> <span data-ttu-id="b2477-239">Agregue "Inicio de sesión anónimo" a la lista de control de acceso (ACL) de la cola y asígnele permiso de lectura.</span><span class="sxs-lookup"><span data-stu-id="b2477-239">Add "Anonymous login" to the queue's access control list (ACL) and give it read permission.</span></span>  
  
 <span data-ttu-id="b2477-240">**P: ¿** cuando un cliente de servicio de red (o cualquier cliente que no tiene una cuenta de dominio) envía un mensaje en cola, se produce un error en el envío con un certificado no válido.</span><span class="sxs-lookup"><span data-stu-id="b2477-240">**Q:** When a network service client (or any client that does not have a domain account) sends a queued message, the send fails with an invalid certificate.</span></span> <span data-ttu-id="b2477-241">¿Cómo se soluciona?</span><span class="sxs-lookup"><span data-stu-id="b2477-241">How do I fix this?</span></span>  
  
 <span data-ttu-id="b2477-242">**R:** Compruebe la configuración del enlace.</span><span class="sxs-lookup"><span data-stu-id="b2477-242">**A:** Check the binding configuration.</span></span> <span data-ttu-id="b2477-243">El enlace predeterminado tiene la seguridad de transporte de MSMQ activada para firmar el mensaje.</span><span class="sxs-lookup"><span data-stu-id="b2477-243">The default binding has MSMQ transport security turned on to sign the message.</span></span> <span data-ttu-id="b2477-244">Desactívela.</span><span class="sxs-lookup"><span data-stu-id="b2477-244">Turn it off.</span></span>  
  
### <a name="remote-transacted-receives"></a><span data-ttu-id="b2477-245">Recepciones de transacción remotas</span><span class="sxs-lookup"><span data-stu-id="b2477-245">Remote Transacted Receives</span></span>  
 <span data-ttu-id="b2477-246">**P: ¿** cuando tengo una cola en el equipo A y un [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] servicio que lee mensajes de una cola en el equipo B (escenario de recepción de transacción remota), los mensajes no se leen de la cola.</span><span class="sxs-lookup"><span data-stu-id="b2477-246">**Q:** When I have a queue on machine A, and a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service that reads messages from a queue on machine B (the remote transacted receive scenario), messages are not read from the queue.</span></span> <span data-ttu-id="b2477-247">La información de seguimiento indica error en la recepción con el mensaje "no se puede importar transacción."</span><span class="sxs-lookup"><span data-stu-id="b2477-247">Tracing information indicates the receive failed with the message "Transaction cannot be imported."</span></span> <span data-ttu-id="b2477-248">¿Qué puedo hacer para solucionar este problema?</span><span class="sxs-lookup"><span data-stu-id="b2477-248">What can I do to fix this?</span></span>  
  
 <span data-ttu-id="b2477-249">**R:** existen tres posibles razones para esto:</span><span class="sxs-lookup"><span data-stu-id="b2477-249">**A:** There are three possible reasons for this:</span></span>  
  
-   <span data-ttu-id="b2477-250">Si está en modo del dominio, la recepción de transacciones remotas requiere el acceso de red de Microsoft DTC (Coordinador de transacciones distribuidas) (MSDTC).</span><span class="sxs-lookup"><span data-stu-id="b2477-250">If you are in domain mode, remote transacted receive requires Microsoft Distributed Transaction Coordinator (MSDTC) network access.</span></span> <span data-ttu-id="b2477-251">Se puede habilitar esta opción mediante **agregar o quitar componentes**.</span><span class="sxs-lookup"><span data-stu-id="b2477-251">You can enable this using **Add/Remove Components**.</span></span>  
  
     <span data-ttu-id="b2477-252">![Habilitar acceso de red DTC](../../../../docs/framework/wcf/feature-details/media/applicationserveraddcomps.jpg "ApplicationServerAddComps")</span><span class="sxs-lookup"><span data-stu-id="b2477-252">![Enabling network DTC access](../../../../docs/framework/wcf/feature-details/media/applicationserveraddcomps.jpg "ApplicationServerAddComps")</span></span>  
  
-   <span data-ttu-id="b2477-253">Compruebe el modo de autenticación para comunicarse con el administrador de transacciones.</span><span class="sxs-lookup"><span data-stu-id="b2477-253">Check the authentication mode for communicating with the transaction manager.</span></span> <span data-ttu-id="b2477-254">Si está en modo de grupo de trabajo, no debe seleccionarse "se requiere autenticación".</span><span class="sxs-lookup"><span data-stu-id="b2477-254">If you are in workgroup mode, "No Authentication Required" must be selected.</span></span> <span data-ttu-id="b2477-255">Si está en modo de dominio, debe seleccionarse "Se requiere autenticación mutua".</span><span class="sxs-lookup"><span data-stu-id="b2477-255">If you are in domain mode, then "Mutual Authentication Required" must be selected.</span></span>  
  
     <span data-ttu-id="b2477-256">![Habilitar transacciones XA](../../../../docs/framework/wcf/feature-details/media/4f3695e0-fb0b-4c5b-afac-75f8860d2bb0.jpg "4f3695e0-fb0b-4c5b-afac-75f8860d2bb0")</span><span class="sxs-lookup"><span data-stu-id="b2477-256">![Enabling XA transactions](../../../../docs/framework/wcf/feature-details/media/4f3695e0-fb0b-4c5b-afac-75f8860d2bb0.jpg "4f3695e0-fb0b-4c5b-afac-75f8860d2bb0")</span></span>  
  
-   <span data-ttu-id="b2477-257">Asegúrese de que MSDTC no está en la lista de excepciones en el **Firewall de conexión a Internet** configuración.</span><span class="sxs-lookup"><span data-stu-id="b2477-257">Make sure that MSDTC is in the list of exceptions in the **Internet Connection Firewall** settings.</span></span>  
  
-   <span data-ttu-id="b2477-258">Asegúrese de que está utilizando [!INCLUDE[wv](../../../../includes/wv-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b2477-258">Ensure that you are using [!INCLUDE[wv](../../../../includes/wv-md.md)].</span></span> <span data-ttu-id="b2477-259">MSMQ en [!INCLUDE[wv](../../../../includes/wv-md.md)] admite la lectura de transacciones remotas.</span><span class="sxs-lookup"><span data-stu-id="b2477-259">MSMQ on [!INCLUDE[wv](../../../../includes/wv-md.md)] supports remote transacted read.</span></span> <span data-ttu-id="b2477-260">MSMQ en versiones anteriores de Windows no admite la lectura de transacciones remotas.</span><span class="sxs-lookup"><span data-stu-id="b2477-260">MSMQ on earlier Windows releases does not support remote transacted read.</span></span>  
  
 <span data-ttu-id="b2477-261">**P: ¿** cuando el servicio que lee de la cola es un servicio de red, por ejemplo, en un sitio Web host, ¿por qué obtengo una excepción de acceso denegado se produce cuando se leen de la cola?</span><span class="sxs-lookup"><span data-stu-id="b2477-261">**Q:** When the service reading from the queue is a network service, for example, in a Web host, why do I get an access-denied exception is raised when reading from the queue?</span></span>  
  
 <span data-ttu-id="b2477-262">**R:** acceso de lectura de servicio de red debe agregarse a la cola ACL para garantizar que un servicio de red puede leer de la cola.</span><span class="sxs-lookup"><span data-stu-id="b2477-262">**A:** Network service read access must be added to the queue ACL to ensure that a network service can read from the queue.</span></span>  
  
 <span data-ttu-id="b2477-263">**P: ¿** ¿se puede usar el servicio de activación de MSMQ para activar aplicaciones basadas en mensajes en una cola en un equipo remoto?</span><span class="sxs-lookup"><span data-stu-id="b2477-263">**Q:** Can I use the MSMQ activation service to activate applications based on messages in a queue on a remote machine?</span></span>  
  
 <span data-ttu-id="b2477-264">**R:** Sí.</span><span class="sxs-lookup"><span data-stu-id="b2477-264">**A:** Yes.</span></span> <span data-ttu-id="b2477-265">Para ello, debe configurar el servicio de activación de MSMQ para que se ejecute como un servicio de red y agregar el acceso del servicio de red a la cola en el equipo remoto.</span><span class="sxs-lookup"><span data-stu-id="b2477-265">To do this, you must configure the MSMQ activation service to run as a network service, and add network service access to the queue on the remote machine.</span></span>  
  
## <a name="using-custom-msmq-bindings-with-receivecontext-enabled"></a><span data-ttu-id="b2477-266">Utilizar los enlaces personalizados de MSMQ con ReceiveContext habilitado</span><span class="sxs-lookup"><span data-stu-id="b2477-266">Using Custom MSMQ Bindings with ReceiveContext Enabled</span></span>  
 <span data-ttu-id="b2477-267">Al utilizar un enlace personalizado de MSMQ con <xref:System.ServiceModel.Channels.ReceiveContext> habilitado, al procesar un mensaje entrante se utilizará un subproceso del grupo de subprocesos porque MSMQ nativo no admite la realización de E/S para recepciones <xref:System.ServiceModel.Channels.ReceiveContext> asincrónicas.</span><span class="sxs-lookup"><span data-stu-id="b2477-267">When using a custom MSMQ binding with <xref:System.ServiceModel.Channels.ReceiveContext> enabled processing an incoming message will use a thread pool thread because native MSMQ does not support I/O completion for asynchronous <xref:System.ServiceModel.Channels.ReceiveContext> receives.</span></span> <span data-ttu-id="b2477-268">Esto se debe a que, al procesar este tipo de mensaje, se utilizan transacciones internas para <xref:System.ServiceModel.Channels.ReceiveContext> y MSMQ no admite el procesamiento asincrónico.</span><span class="sxs-lookup"><span data-stu-id="b2477-268">This is because processing such a message uses internal transactions for <xref:System.ServiceModel.Channels.ReceiveContext> and MSMQ does not support asynchronous processing.</span></span> <span data-ttu-id="b2477-269">Para evitar este problema, puede agregar <xref:System.ServiceModel.Description.SynchronousReceiveBehavior> al extremo para forzar el procesamiento sincrónico, o establecer <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior.MaxPendingReceives%2A> en 1.</span><span class="sxs-lookup"><span data-stu-id="b2477-269">To work around this issue you can add a <xref:System.ServiceModel.Description.SynchronousReceiveBehavior> to the endpoint to force synchronous processing or set <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior.MaxPendingReceives%2A> to 1.</span></span>
