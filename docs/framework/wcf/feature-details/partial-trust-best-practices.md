---
title: Procedimientos recomendados de confianza parcial
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 0d052bc0-5b98-4c50-8bb5-270cc8a8b145
caps.latest.revision: "17"
author: Erikre
ms.author: erikre
manager: erikre
ms.openlocfilehash: cbe782d117fee7c1cd8b8cb6fd3710e2adac77e5
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/21/2017
---
# <a name="partial-trust-best-practices"></a><span data-ttu-id="1cfd9-102">Procedimientos recomendados de confianza parcial</span><span class="sxs-lookup"><span data-stu-id="1cfd9-102">Partial Trust Best Practices</span></span>
<span data-ttu-id="1cfd9-103">En este tema se describen procedimientos recomendados al ejecutar [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] en un entorno de confianza parcial.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-103">This topic describes best practices when running [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] in a partial trust environment.</span></span>  
  
## <a name="serialization"></a><span data-ttu-id="1cfd9-104">Serialización</span><span class="sxs-lookup"><span data-stu-id="1cfd9-104">Serialization</span></span>  
 <span data-ttu-id="1cfd9-105">Aplique los siguientes procedimientos al utilizar <xref:System.Runtime.Serialization.DataContractSerializer> en una aplicación de confianza parcial.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-105">Apply the following practices when using the <xref:System.Runtime.Serialization.DataContractSerializer> in a partially-trusted application.</span></span>  
  
-   <span data-ttu-id="1cfd9-106">Se ha de marcar a todos los tipos serializables mediante el atributo `[DataContract]`.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-106">All serializable types must be explicitly marked with the `[DataContract]` attribute.</span></span> <span data-ttu-id="1cfd9-107">Las siguientes técnicas no se admiten en un entorno de confianza parcial:</span><span class="sxs-lookup"><span data-stu-id="1cfd9-107">The following techniques are not supported in a partial trust environment:</span></span>  
  
-   <span data-ttu-id="1cfd9-108">Marcado de clases que se van a serializar con el <xref:System.SerializableAttribute>.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-108">Marking classes to be serialized with the <xref:System.SerializableAttribute>.</span></span>  
  
-   <span data-ttu-id="1cfd9-109">Implementación de la interfaz <xref:System.Runtime.Serialization.ISerializable> para permitir que una clase controle su proceso de serialización.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-109">Implementing the <xref:System.Runtime.Serialization.ISerializable> interface to allow a class to control its serialization process.</span></span>  
  
### <a name="using-datacontractserializer"></a><span data-ttu-id="1cfd9-110">Uso de DataContractSerializer</span><span class="sxs-lookup"><span data-stu-id="1cfd9-110">Using DataContractSerializer</span></span>  
  
-   <span data-ttu-id="1cfd9-111">Todos los tipos marcados con el atributo `[DataContract]` deben ser públicos.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-111">All types marked with the `[DataContract]` attribute must be public.</span></span> <span data-ttu-id="1cfd9-112">Los tipos no públicos no se pueden serializar en un entorno de confianza parcial.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-112">Non-public types cannot be serialized in a partial trust environment.</span></span>  
  
-   <span data-ttu-id="1cfd9-113">Todos los miembros de `[DataContract]` de un tipo de `[DataContract]` serializable deben ser públicos.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-113">All `[DataContract]` members in a serializable `[DataContract]` type must be public.</span></span> <span data-ttu-id="1cfd9-114">Un tipo con un `[DataMember]` no público no se puede serializar en un entorno de confianza parcial.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-114">A type with a non-public `[DataMember]` cannot be serialized in a partial trust environment.</span></span>  
  
-   <span data-ttu-id="1cfd9-115">Los métodos que administran eventos de serialización (como `OnSerializing`, `OnSerialized`, `OnDeserializing`y `OnDeserialized`) se deben declarar como públicos.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-115">Methods that handle serialization events (such as `OnSerializing`, `OnSerialized`, `OnDeserializing`, and `OnDeserialized`) must be declared as public.</span></span> <span data-ttu-id="1cfd9-116">Sin embargo, se admiten las implementaciones explícitas e implícitas de <xref:System.Runtime.Serialization.IDeserializationCallback.OnDeserialization%28System.Object%29>.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-116">However, both explicit and implicit implementations of <xref:System.Runtime.Serialization.IDeserializationCallback.OnDeserialization%28System.Object%29> are supported.</span></span>  
  
-   <span data-ttu-id="1cfd9-117">Los tipos `[DataContract]` implementados en ensamblados marcados con el <xref:System.Security.AllowPartiallyTrustedCallersAttribute> no deben realizar acciones relacionadas con la seguridad en el constructor de tipos, puesto que el <xref:System.Runtime.Serialization.DataContractSerializer> no llama durante la deserialización al constructor del objeto del que se ha creado recientemente una instancia.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-117">`[DataContract]` types implemented in assemblies marked with the <xref:System.Security.AllowPartiallyTrustedCallersAttribute> must not perform security-related actions in the type constructor, as the <xref:System.Runtime.Serialization.DataContractSerializer> does not call the constructor of the newly-instantiated object during deserialization.</span></span> <span data-ttu-id="1cfd9-118">Particularmente, se han de evitar las siguientes técnicas de seguridad comunes en los tipos de `[DataContract]`:</span><span class="sxs-lookup"><span data-stu-id="1cfd9-118">Specifically, the following common security techniques must be avoided for `[DataContract]` types:</span></span>  
  
-   <span data-ttu-id="1cfd9-119">Intentar restringir el acceso de confianza parcial haciendo interno o privado el constructor del tipo.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-119">Attempting to restrict partial trust access by making the type's constructor internal or private.</span></span>  
  
-   <span data-ttu-id="1cfd9-120">Restringir el acceso al tipo agregando una `[LinkDemand]` al constructor del tipo.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-120">Restricting access to the type by adding a `[LinkDemand]` to the type's constructor.</span></span>  
  
-   <span data-ttu-id="1cfd9-121">Suponer que, como se ha creado una instancia del objeto correctamente, todas las comprobaciones de validación requeridas por el constructor se han superado con éxito.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-121">Assuming that because the object has been successfully instantiated, any validation checks enforced by the constructor have passed successfully.</span></span>  
  
### <a name="using-ixmlserializable"></a><span data-ttu-id="1cfd9-122">Utilizar IXmlSerializable</span><span class="sxs-lookup"><span data-stu-id="1cfd9-122">Using IXmlSerializable</span></span>  
 <span data-ttu-id="1cfd9-123">Los siguientes procedimientos recomendados se aplican a tipos que implementan <xref:System.Xml.Serialization.IXmlSerializable> y se serializan mediante <xref:System.Runtime.Serialization.DataContractSerializer>.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-123">The following best practices apply for types that implement <xref:System.Xml.Serialization.IXmlSerializable> and are serialized using the <xref:System.Runtime.Serialization.DataContractSerializer>:</span></span>  
  
-   <span data-ttu-id="1cfd9-124">Las implementaciones del método estático <xref:System.Xml.Serialization.IXmlSerializable.GetSchema%2A> deben ser `public`.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-124">The <xref:System.Xml.Serialization.IXmlSerializable.GetSchema%2A> static method implementations must be `public`.</span></span>  
  
-   <span data-ttu-id="1cfd9-125">Los métodos de instancia que implementan la interfaz <xref:System.Xml.Serialization.IXmlSerializable> deben ser `public`.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-125">The instance methods that implement the <xref:System.Xml.Serialization.IXmlSerializable> interface must be `public`.</span></span>  
  
## <a name="using-wcf-from-fully-trusted-platform-code-that-allows-calls-from-partially-trusted-callers"></a><span data-ttu-id="1cfd9-126">Utilizar WCF a partir de código de la plataforma de plena confianza que permite llamadas desde llamadores de confianza parcial</span><span class="sxs-lookup"><span data-stu-id="1cfd9-126">Using WCF from Fully-Trusted Platform Code that Allows Calls from Partially Trusted Callers</span></span>  
 <span data-ttu-id="1cfd9-127">El modelo de seguridad de confianza parcial de [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] supone que cualquier autor de llama de un método o una propiedad pública de [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] se ejecuta en el contexto de seguridad de acceso del código (CAS) de la aplicación de hospedaje.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-127">The [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] partial trust security model assumes that any caller of a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] public method or property is running in the code access security (CAS) context of the hosting application.</span></span> [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]<span data-ttu-id="1cfd9-128"> también supone que solo existe un contexto de seguridad de la aplicación para cada <xref:System.AppDomain> y que este contexto lo establece en la hora de creación de <xref:System.AppDomain> un host de confianza (por ejemplo, mediante una llamada a <xref:System.AppDomain.CreateDomain%2A> o por parte del Administrador de aplicaciones de ASP.NET).</span><span class="sxs-lookup"><span data-stu-id="1cfd9-128"> also assumes that only one application security context exists for each <xref:System.AppDomain>, and that this context is established at <xref:System.AppDomain> creation time by a trusted host (for example, by a call to <xref:System.AppDomain.CreateDomain%2A> or by the ASP.NET Application Manager).</span></span>  
  
 <span data-ttu-id="1cfd9-129">Este modelo de seguridad se aplica a las aplicaciones escritas por usuarios que no pueden validar permisos CAS adicionales, como, por ejemplo, el código de usuario que se ejecuta en una aplicación ASP.NET de nivel de confianza medio.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-129">This security model applies to user-written applications that cannot assert additional CAS permissions, such as user code running in a Medium Trust ASP.NET application.</span></span> <span data-ttu-id="1cfd9-130">Sin embargo, el código de plataforma de plena confianza (por ejemplo, un ensamblado de otro fabricante que se instala en la caché global de ensamblados y acepta llamadas de código de confianza parcial) debe tener un cuidado explícito al realizar llamadas en [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] en nombre de una aplicación de confianza parcial, para evitar introducir vulnerabilidades de seguridad en el nivel de aplicación.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-130">However, fully-trusted platform code (for example, a third-party assembly that is installed in the global assembly cache and accepts calls from partially-trusted code) must take explicit care when calling into [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] on behalf of a partially-trusted application to avoid introducing application-level security vulnerabilities.</span></span>  
  
 <span data-ttu-id="1cfd9-131">El código de plena confianza debería evitar modificar el conjunto de permisos CAS del subproceso actual (llamando al método <xref:System.Security.PermissionSet.Assert%2A>, <xref:System.Security.PermissionSet.PermitOnly%2A>o <xref:System.Security.PermissionSet.Deny%2A>) antes de llamar a la API de [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] en nombre de código de confianza parcial.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-131">Full-trust code should avoid altering the CAS permission set of the current thread (by calling <xref:System.Security.PermissionSet.Assert%2A>, <xref:System.Security.PermissionSet.PermitOnly%2A>, or <xref:System.Security.PermissionSet.Deny%2A>) prior to calling [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] APIs on behalf of partially-trusted code.</span></span> <span data-ttu-id="1cfd9-132">Validar, denegar o crear un contexto de permiso para subprocesos que sea independiente del contexto de seguridad de aplicaciones puede provocar un comportamiento inesperado.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-132">Asserting, denying, or otherwise creating a thread-specific permission context that is independent of the application-level security context can result in unexpected behavior.</span></span> <span data-ttu-id="1cfd9-133">En función de la aplicación, este comportamiento puede producir vulnerabilidades de seguridad en aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-133">Depending on the application, this behavior may result in application-level security vulnerabilities.</span></span>  
  
 <span data-ttu-id="1cfd9-134">El código que llama en [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] utilizando un contexto de permiso para subprocesos debe estar preparado para afrontar las siguientes situaciones que se podrían presentar:</span><span class="sxs-lookup"><span data-stu-id="1cfd9-134">Code that calls into [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] using a thread-specific permission context must be prepared to handle the following situations that may arise:</span></span>  
  
-   <span data-ttu-id="1cfd9-135">El contexto de seguridad específico para subprocesos no se puede mantener durante toda la operación, lo que produce excepciones de seguridad potenciales.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-135">The thread-specific security context may not be maintained for the duration of the operation, which results in potential security exceptions.</span></span>  
  
-   <span data-ttu-id="1cfd9-136">El código de [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] interno, así como cualquier devolución de llamada proporcionada por el usuario puede ejecutarse en un contexto de seguridad diferente que aquel bajo el que se inició la llamada originariamente.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-136">Internal [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] code as well as any user-provided callbacks may run in a different security context than the one under which the call was originally initiated.</span></span> <span data-ttu-id="1cfd9-137">Entre estos contextos se incluyen:</span><span class="sxs-lookup"><span data-stu-id="1cfd9-137">These contexts include:</span></span>  
  
    -   <span data-ttu-id="1cfd9-138">El contexto del permiso de aplicación.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-138">The application permission context.</span></span>  
  
    -   <span data-ttu-id="1cfd9-139">Cualquier contexto de permiso para subprocesos creado previamente por otros subprocesos de usuarios utilizados para llamar en [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] durante la duración del <xref:System.AppDomain> que se está ejecutando actualmente.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-139">Any thread-specific permission context previously created by other user threads used to call into [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] during the lifetime of the currently running <xref:System.AppDomain>.</span></span>  
  
 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]<span data-ttu-id="1cfd9-140"> garantiza que el código de confianza parcial no puede obtener permisos de plena confianza a menos que un componente de plena confianza valide tales permisos antes de llamar en las API públicas de [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)].</span><span class="sxs-lookup"><span data-stu-id="1cfd9-140"> guarantees that partially-trusted code cannot obtain full-trust permissions unless such permissions are asserted by a fully-trusted component prior to calling into [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] public APIs.</span></span> <span data-ttu-id="1cfd9-141">Sin embargo, no garantiza que los efectos de validar la plena confianza se aíslen a un determinado subproceso, operación o acción del usuario.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-141">However, it does not guarantee that the effects of asserting full trust is isolated to a particular thread, operation, or user action.</span></span>  
  
 <span data-ttu-id="1cfd9-142">A modo de procedimiento recomendado, evite crear un contexto de permiso para subprocesos llamando al método <xref:System.Security.PermissionSet.Assert%2A>, <xref:System.Security.PermissionSet.PermitOnly%2A> o <xref:System.Security.PermissionSet.Deny%2A>.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-142">As a best practice, avoid creating thread-specific permission context by calling <xref:System.Security.PermissionSet.Assert%2A>, <xref:System.Security.PermissionSet.PermitOnly%2A>, or <xref:System.Security.PermissionSet.Deny%2A>.</span></span> <span data-ttu-id="1cfd9-143">En su lugar, conceda o deniegue el privilegio a la propia aplicación, para que no se requiera <xref:System.Security.PermissionSet.Assert%2A>, <xref:System.Security.PermissionSet.Deny%2A> o <xref:System.Security.PermissionSet.PermitOnly%2A>.</span><span class="sxs-lookup"><span data-stu-id="1cfd9-143">Instead, grant or deny the privilege to the application itself, so that no <xref:System.Security.PermissionSet.Assert%2A>, <xref:System.Security.PermissionSet.Deny%2A>, or <xref:System.Security.PermissionSet.PermitOnly%2A> is required.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1cfd9-144">Vea también</span><span class="sxs-lookup"><span data-stu-id="1cfd9-144">See Also</span></span>  
 <xref:System.Runtime.Serialization.DataContractSerializer>  
 <xref:System.Xml.Serialization.IXmlSerializable>
