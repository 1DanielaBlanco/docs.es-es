---
title: Tratamiento de errores y puentes
ms.date: 03/30/2017
ms.assetid: 4ae87d1a-b615-4014-a494-a53f63ff0137
ms.openlocfilehash: 20f5af5736e5869ead0f7c50ce0fff22391ea730
ms.sourcegitcommit: 15109844229ade1c6449f48f3834db1b26907824
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 05/07/2018
---
# <a name="bridging-and-error-handling"></a><span data-ttu-id="a8697-102">Tratamiento de errores y puentes</span><span class="sxs-lookup"><span data-stu-id="a8697-102">Bridging and Error Handling</span></span>
<span data-ttu-id="a8697-103">Este ejemplo muestra cómo se utiliza el servicio de enrutamiento de Windows Communication Foundation (WCF) para puentear la comunicación entre un cliente y un servicio que utilizan enlaces diferentes.</span><span class="sxs-lookup"><span data-stu-id="a8697-103">This sample demonstrates how the Windows Communication Foundation (WCF) routing service is used for bridging communication between a client and a service that use different bindings.</span></span> <span data-ttu-id="a8697-104">Este ejemplo también muestra cómo utilizar un servicio de seguridad de reserva para escenarios de conmutación por error.</span><span class="sxs-lookup"><span data-stu-id="a8697-104">This sample also shows how to use a back-up service for failover scenarios.</span></span> <span data-ttu-id="a8697-105">El servicio de enrutamiento es un componente WCF que facilita el proceso incluir un enrutador basado en contenido en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a8697-105">The routing service is a WCF component that makes it easy to include a content-based router in your application.</span></span> <span data-ttu-id="a8697-106">Este ejemplo adapta el ejemplo de la calculadora de WCF estándar para comunicarse con el servicio de enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="a8697-106">This sample adapts the standard WCF Calculator Sample to communicate using the routing service.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="a8697-107">Puede que los ejemplos ya estén instalados en su equipo.</span><span class="sxs-lookup"><span data-stu-id="a8697-107">The samples may already be installed on your computer.</span></span> <span data-ttu-id="a8697-108">Compruebe el siguiente directorio (predeterminado) antes de continuar.</span><span class="sxs-lookup"><span data-stu-id="a8697-108">Check for the following (default) directory before continuing.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  <span data-ttu-id="a8697-109">Si este directorio no existe, vaya a [Windows Communication Foundation (WCF) y ejemplos de Windows Workflow Foundation (WF) para .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) para descargar todos los Windows Communication Foundation (WCF) y [!INCLUDE[wf1](../../../../includes/wf1-md.md)] ejemplos.</span><span class="sxs-lookup"><span data-stu-id="a8697-109">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="a8697-110">Este ejemplo se encuentra en el siguiente directorio.</span><span class="sxs-lookup"><span data-stu-id="a8697-110">This sample is located in the following directory.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WCF\Basic\RoutingServices\ErrorHandlingAndBridging`  
  
## <a name="sample-details"></a><span data-ttu-id="a8697-111">Detalles del ejemplo</span><span class="sxs-lookup"><span data-stu-id="a8697-111">Sample Details</span></span>  
 <span data-ttu-id="a8697-112">En este ejemplo, el cliente de la calculadora se configura para enviar los mensajes a un extremo que expone el enrutador.</span><span class="sxs-lookup"><span data-stu-id="a8697-112">In this sample, the Calculator client is configured to send messages to an endpoint exposed by the router.</span></span> <span data-ttu-id="a8697-113">El servicio de enrutamiento se configura para aceptar todos los mensajes que se le envíen y reenviarlos a un extremo que corresponde al servicio de calculadora.</span><span class="sxs-lookup"><span data-stu-id="a8697-113">The routing service is configured to accept all messages sent to it and to forward them to an endpoint that corresponds to the Calculator service.</span></span> <span data-ttu-id="a8697-114">Los siguientes puntos describen la configuración del servicio de calculadora principal, el servicio de calculadora de seguridad y el cliente de calculadora, y el modo en que se produce la comunicación entre el cliente y el servicio mediante el servicio de enrutamiento:</span><span class="sxs-lookup"><span data-stu-id="a8697-114">The following points describe the configuration of the primary Calculator service, the back-up Calculator service, and the Calculator client and how the communication between the client and the service happens using the routing service:</span></span>  
  
-   <span data-ttu-id="a8697-115">El cliente de calculadora se configura para utilizar BasicHttpBinding mientras que el servicio de calculadora se configura para utilizar NetTcpBinding.</span><span class="sxs-lookup"><span data-stu-id="a8697-115">The Calculator client is configured to use BasicHttpBinding while the Calculator service is configured to use NetTcpBinding.</span></span> <span data-ttu-id="a8697-116">El servicio de enrutamiento debe convertir automáticamente los mensajes antes de enviarlos al servicio de calculadora y también convierte las respuestas para que el cliente de la calculadora pueda tener acceso a ellos.</span><span class="sxs-lookup"><span data-stu-id="a8697-116">The routing service automatically converts the messages as necessary before sending them to the Calculator service and it also converts the responses so that the Calculator client can access them.</span></span>  
  
-   <span data-ttu-id="a8697-117">El servicio de enrutamiento conoce dos servicios de calculadora: el principal y el de reserva.</span><span class="sxs-lookup"><span data-stu-id="a8697-117">The routing service knows about two Calculator services: the primary Calculator service and the back-up Calculator service.</span></span> <span data-ttu-id="a8697-118">El servicio de enrutamiento intenta comunicarse primero con el extremo de servicio de calculadora principal.</span><span class="sxs-lookup"><span data-stu-id="a8697-118">The routing service first attempts to communicate with the primary Calculator service endpoint.</span></span> <span data-ttu-id="a8697-119">Si se produce un error en este intento debido a que el punto de conexión se desactiva, el servicio de enrutamiento intenta comunicarse con el punto de conexión del servicio de calculadora de reserva.</span><span class="sxs-lookup"><span data-stu-id="a8697-119">If this attempt fails due to the endpoint being down, the routing service then tries to communicate with the back-up Calculator service endpoint.</span></span>  
  
 <span data-ttu-id="a8697-120">Por tanto, los mensajes enviados desde el cliente son recibidos por el enrutador y se vuelven a enrutar al servicio de calculadora real.</span><span class="sxs-lookup"><span data-stu-id="a8697-120">Thus messages sent from the client are received by the router and are rerouted to the actual Calculator service.</span></span> <span data-ttu-id="a8697-121">Si el extremo de servicio de calculadora se desactiva, el servicio de enrutamiento enruta el mensaje al extremo de servicio de calculadora de reserva.</span><span class="sxs-lookup"><span data-stu-id="a8697-121">If the Calculator service endpoint is down, the routing service routes the message to the back-up Calculator service endpoint.</span></span> <span data-ttu-id="a8697-122">Los mensajes del servicio de calculadora de reserva se devuelven al enrutador del servicio, que a su vez los pasa al cliente de la calculadora.</span><span class="sxs-lookup"><span data-stu-id="a8697-122">Messages from the back-up Calculator service are sent back to the service router, which in turn passes them back to the Calculator client.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a8697-123">Una lista de reserva puede tener definido más de un extremo.</span><span class="sxs-lookup"><span data-stu-id="a8697-123">A back-up list can have more than one endpoint defined.</span></span> <span data-ttu-id="a8697-124">En este caso, si el punto de conexión de servicio de seguridad se desactiva, el servicio de enrutamiento intenta conectarse al punto de conexión de reserva siguiente en la lista hasta que se produce una conexión correcta.</span><span class="sxs-lookup"><span data-stu-id="a8697-124">In this case if the back-up service endpoint is down, the routing service attempts to connect to the next back-up endpoint in the list until a successful connection occurs.</span></span>  
  
#### <a name="to-use-this-sample"></a><span data-ttu-id="a8697-125">Para utilizar este ejemplo</span><span class="sxs-lookup"><span data-stu-id="a8697-125">To use this sample</span></span>  
  
1.  <span data-ttu-id="a8697-126">Con [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)], abra RouterBridgingAndErrorHandling.sln.</span><span class="sxs-lookup"><span data-stu-id="a8697-126">Using [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)], open RouterBridgingAndErrorHandling.sln.</span></span>  
  
2.  <span data-ttu-id="a8697-127">Presione F5 o CTRL+MAYÚS+B en Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="a8697-127">Press F5 or CTRL+SHIFT+B in Visual Studio</span></span>  
  
    1.  <span data-ttu-id="a8697-128">Si desea iniciar de forma automática los proyectos necesarios al presionar F5, haga clic en la solución, seleccione **propiedades**y en el **proyecto de inicio** nodo bajo **propiedades comunes**, seleccione **proyectos de inicio múltiples**y establezca todos los proyectos en **iniciar**.</span><span class="sxs-lookup"><span data-stu-id="a8697-128">If you would like to auto-launch the necessary projects when you press F5, right-click the solution, select **Properties**, and in the **Startup Project** node under **Common Properties**, select **Multiple Startup Projects**, and set all projects to **Start**.</span></span>  
  
    2.  <span data-ttu-id="a8697-129">Si compila el proyecto con CTRL+MAYÚS+B, debe iniciar las siguientes aplicaciones:</span><span class="sxs-lookup"><span data-stu-id="a8697-129">If you build the project with CTRL+SHIFT+B, start the following applications:</span></span>  
  
        1.  <span data-ttu-id="a8697-130">El cliente de la calculadora (./CalculatorClient/bin/client.exe)</span><span class="sxs-lookup"><span data-stu-id="a8697-130">Calculator client (./CalculatorClient/bin/client.exe)</span></span>  
  
        2.  <span data-ttu-id="a8697-131">El servicio de calculadora (./CalculatorService/bin/service.exe)</span><span class="sxs-lookup"><span data-stu-id="a8697-131">Calculator service (./CalculatorService/bin/service.exe)</span></span>  
  
        3.  <span data-ttu-id="a8697-132">El servicio de enrutamiento (./RoutingService/bin/RoutingService.exe)</span><span class="sxs-lookup"><span data-stu-id="a8697-132">Routing Service (./RoutingService/bin/RoutingService.exe)</span></span>  
  
3.  <span data-ttu-id="a8697-133">En el cliente de la calculadora, presione Entrar para iniciar el cliente.</span><span class="sxs-lookup"><span data-stu-id="a8697-133">In the Calculator Client, press ENTER to start the client.</span></span>  
  
     <span data-ttu-id="a8697-134">Debería ver los siguientes resultados:</span><span class="sxs-lookup"><span data-stu-id="a8697-134">You should see the following output:</span></span>  
  
    ```Output  
    Add(100,15.99) = 115.99  
    Subtract(145,76.54) = 68.46  
    Multiply(9,81.25) = 731.25  
    Divide(22,7) = 3.14285714285714  
    ```  
  
## <a name="configurable-via-code-or-appconfig"></a><span data-ttu-id="a8697-135">Configurable a través de código o App.onfig</span><span class="sxs-lookup"><span data-stu-id="a8697-135">Configurable Via Code or App.config</span></span>  
 <span data-ttu-id="a8697-136">El ejemplo viene configurado para utilizar un archivo App.config que define el comportamiento del enrutador.</span><span class="sxs-lookup"><span data-stu-id="a8697-136">The sample ships configured to use an App.config file to define the router’s behavior.</span></span> <span data-ttu-id="a8697-137">También puede cambiar el nombre del archivo App.config por otro de modo que no se reconozca y quitar el comentario de la llamada al método `ConfigureRouterViaCode()`.</span><span class="sxs-lookup"><span data-stu-id="a8697-137">You can also change the name of the App.config file to something else so that it is not recognized and uncomment the method call to `ConfigureRouterViaCode()`.</span></span> <span data-ttu-id="a8697-138">Cualquier método provoca el mismo comportamiento del enrutador.</span><span class="sxs-lookup"><span data-stu-id="a8697-138">Either method results in the same behavior from the router.</span></span>  
  
### <a name="scenario"></a><span data-ttu-id="a8697-139">Escenario</span><span class="sxs-lookup"><span data-stu-id="a8697-139">Scenario</span></span>  
 <span data-ttu-id="a8697-140">En este ejemplo se muestra el enrutador del servicio que actúa como puente de protocolo y un controlador de errores.</span><span class="sxs-lookup"><span data-stu-id="a8697-140">This sample demonstrates the service router acting as a protocol bridge and error handler.</span></span> <span data-ttu-id="a8697-141">En este escenario, no se produce el enrutamiento basado en contenido; el servicio de enrutamiento actúa como un nodo de proxy transparente configurado para pasar los mensajes a un conjunto preconfigurado de extremos de destino directamente.</span><span class="sxs-lookup"><span data-stu-id="a8697-141">In this scenario, no content-based routing occurs; the routing service acts as a transparent proxy node configured to pass messages directly to a preconfigured set of destination endpoints.</span></span> <span data-ttu-id="a8697-142">El servicio de enrutamiento también sigue pasos adicionales para tratar de forma transparente los errores que ocurren al intentar enviar a los extremos con los que está configurado para comunicarse.</span><span class="sxs-lookup"><span data-stu-id="a8697-142">The routing service also performs the additional steps of transparently handling errors that occur when it tries to send to the endpoints that it is configured to communicate with.</span></span> <span data-ttu-id="a8697-143">Al actuar como puente de protocolo, el servicio de enrutamiento permite al usuario definir un protocolo para la comunicación externa y otra para la interna.</span><span class="sxs-lookup"><span data-stu-id="a8697-143">By acting as a protocol bridge, the routing service enables the user to define one protocol for external communication and another for internal communication.</span></span>  
  
### <a name="real-world-scenario"></a><span data-ttu-id="a8697-144">Escenario real</span><span class="sxs-lookup"><span data-stu-id="a8697-144">Real World Scenario</span></span>  
 <span data-ttu-id="a8697-145">Contoso desea proporcionar un punto de conexión de servicio interoperable, al tiempo que optimiza el rendimiento internamente.</span><span class="sxs-lookup"><span data-stu-id="a8697-145">Contoso wants to provide an interoperable service endpoint to the world, while optimizing performance internally.</span></span> <span data-ttu-id="a8697-146">Por tanto, expone sus servicios a los demás a través de un punto de conexión utilizando BasicHttpBinding, mientras que, internamente, usa el servicio de enrutamiento para puentear esa conexión al punto de conexión mediante NetTcpBinding, que su servicio usa.</span><span class="sxs-lookup"><span data-stu-id="a8697-146">Thus it exposes its services to the world through an endpoint using the BasicHttpBinding, while internally using the routing service to bridge that connection to the endpoint using NetTcpBinding, which its services use.</span></span> <span data-ttu-id="a8697-147">Además, Contoso desea que su oferta de servicios tolere las interrupciones temporales en cualquiera de sus servicios de producción y, por lo tanto, proporcionar varios puntos de conexión virtuales detrás del servicio de enrutador utilizando las funciones de tratamiento de errores para conmutar por error automáticamente a los puntos de conexión de reserva cuando sea necesario.</span><span class="sxs-lookup"><span data-stu-id="a8697-147">Furthermore, Contoso wants its service offering to be tolerant of temporary outages in any one of their production services and thus virtualizes multiple endpoints behind the router service using the ’s error handling capabilities to automatically failover to back-up endpoints when necessary.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a8697-148">Vea también</span><span class="sxs-lookup"><span data-stu-id="a8697-148">See Also</span></span>  
 [<span data-ttu-id="a8697-149">Ejemplos de persistencia y el hospedaje de AppFabric</span><span class="sxs-lookup"><span data-stu-id="a8697-149">AppFabric Hosting and Persistence Samples</span></span>](http://go.microsoft.com/fwlink/?LinkId=193961)
