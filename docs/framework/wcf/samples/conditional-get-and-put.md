---
title: Get y Put condicionales
ms.date: 03/30/2017
ms.assetid: 3d22067f-57b8-4e0f-a571-a694512187ae
ms.openlocfilehash: 29819f89327128cdd71cc89eb8d14126522dc2df
ms.sourcegitcommit: 6eac9a01ff5d70c6d18460324c016a3612c5e268
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/14/2018
ms.locfileid: "45595128"
---
# <a name="conditional-get-and-put"></a><span data-ttu-id="38b52-102">Get y Put condicionales</span><span class="sxs-lookup"><span data-stu-id="38b52-102">Conditional Get and Put</span></span>
<span data-ttu-id="38b52-103">En este ejemplo se muestra cómo utilizar las nuevas API de recuperación y actualización condicionales para el modelo de programación REST de WCF.</span><span class="sxs-lookup"><span data-stu-id="38b52-103">This sample demonstrates how to use the new conditional retrieve and update APIs for the WCF REST programming model.</span></span> <span data-ttu-id="38b52-104">Dado que son más adecuadas para la recuperación y actualización condicionales orientado a recursos y servicios REST, este ejemplo amplía la [servicio de recurso básico](../../../../docs/framework/wcf/samples/basic-resource-service.md) ejemplo.</span><span class="sxs-lookup"><span data-stu-id="38b52-104">Because conditional retrieve and update are most appropriate for resource-oriented and REST services, this sample extends the [Basic Resource Service](../../../../docs/framework/wcf/samples/basic-resource-service.md) sample.</span></span> <span data-ttu-id="38b52-105">En este ejemplo se centra en Agregar compatibilidad para la recuperación y actualización a condicionales el [servicio de recurso básico](../../../../docs/framework/wcf/samples/basic-resource-service.md) de ejemplo mediante las nuevas API que se introdujo en [!INCLUDE[netfx40_long](../../../../includes/netfx40-long-md.md)].</span><span class="sxs-lookup"><span data-stu-id="38b52-105">This sample focuses on adding support for conditional retrieve and update to the [Basic Resource Service](../../../../docs/framework/wcf/samples/basic-resource-service.md) sample using the new APIs introduced in [!INCLUDE[netfx40_long](../../../../includes/netfx40-long-md.md)].</span></span>  
  
## <a name="demonstrates"></a><span data-ttu-id="38b52-106">Demostraciones</span><span class="sxs-lookup"><span data-stu-id="38b52-106">Demonstrates</span></span>  
 <span data-ttu-id="38b52-107">Recuperación y actualización condicionales</span><span class="sxs-lookup"><span data-stu-id="38b52-107">Conditional Retrieve and Update</span></span>  
  
## <a name="discussion"></a><span data-ttu-id="38b52-108">Explicación</span><span class="sxs-lookup"><span data-stu-id="38b52-108">Discussion</span></span>  
 <span data-ttu-id="38b52-109">El servicio WCF de este ejemplo expone una colección de clientes al estilo de REST y orientado a recursos.</span><span class="sxs-lookup"><span data-stu-id="38b52-109">The WCF service in this sample exposes a collection of customers in a resource-oriented and REST manner.</span></span> <span data-ttu-id="38b52-110">Para obtener una descripción detallada de la implementación del servicio, consulte el [servicio de recurso básico](../../../../docs/framework/wcf/samples/basic-resource-service.md) ejemplo.</span><span class="sxs-lookup"><span data-stu-id="38b52-110">For a detailed description of the service implementation, please see the [Basic Resource Service](../../../../docs/framework/wcf/samples/basic-resource-service.md) sample.</span></span>  
  
 <span data-ttu-id="38b52-111">Este ejemplo agrega recuperación condicional y capacidades de actualización para el [servicio de recurso básico](../../../../docs/framework/wcf/samples/basic-resource-service.md) ejemplo.</span><span class="sxs-lookup"><span data-stu-id="38b52-111">This sample adds conditional retrieve and update capabilities to the [Basic Resource Service](../../../../docs/framework/wcf/samples/basic-resource-service.md) sample.</span></span> <span data-ttu-id="38b52-112">La recuperación y actualización condicionales usan etiquetas de entidad HTTP y encabezados If-None-Match e If-Match HTTP para validar si los clientes tienen o no la entidad más actual para un recurso dado.</span><span class="sxs-lookup"><span data-stu-id="38b52-112">Conditional retrieve and update use HTTP entity tags and the HTTP If-None-Match and If-Match headers to validate that clients either have or do not have the most current entity for a given resource.</span></span> <span data-ttu-id="38b52-113">Sin embargo, implementar el código para analizar correctamente los encabezados If-None-Match e If-Match de HTTP puede ser tedioso y se suelen cometer muchos errores.</span><span class="sxs-lookup"><span data-stu-id="38b52-113">However, implementing the code to correctly parse the HTTP If-None-Match and If-Match headers can be tedious and error-prone.</span></span> <span data-ttu-id="38b52-114">Por consiguiente, los métodos <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> y <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalUpdate%2A> se han agregado a <xref:System.ServiceModel.Web.IncomingWebRequestContext>, al que se puede tener acceso utilizando la instancia actual de <xref:System.ServiceModel.Web.WebOperationContext>.</span><span class="sxs-lookup"><span data-stu-id="38b52-114">Therefore, the <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> and <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalUpdate%2A> methods have been added to the <xref:System.ServiceModel.Web.IncomingWebRequestContext>, which can be accessed using the current instance of the <xref:System.ServiceModel.Web.WebOperationContext>.</span></span> <span data-ttu-id="38b52-115">Además, el método `SetETag` se ha agregado a <xref:System.ServiceModel.Web.OutgoingWebRequestContext>, con lo que se facilita devolver las etiquetas de entidad válidas.</span><span class="sxs-lookup"><span data-stu-id="38b52-115">In addition, the `SetETag` method has been added to the <xref:System.ServiceModel.Web.OutgoingWebRequestContext>, making it easier to return valid entity tags.</span></span>  
  
 <span data-ttu-id="38b52-116">El método <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> está pensado para ser utilizado con operaciones [WebGet].</span><span class="sxs-lookup"><span data-stu-id="38b52-116">The <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> method is intended to be used with [WebGet] operations.</span></span> <span data-ttu-id="38b52-117">Toma la etiqueta de entidad actual para el recurso dado como el parámetro `entityTag`, que puede ser de tipo `string`, `int`, `long` o `Guid`.</span><span class="sxs-lookup"><span data-stu-id="38b52-117">It takes the current entity tag for the given resource as the `entityTag` parameter, which can be a `string`, `int`, `long` or `Guid`.</span></span> <span data-ttu-id="38b52-118">El método <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> comprueba la etiqueta de entidad con respecto al encabezadoIf-None-Match de HTTP de la solicitud.</span><span class="sxs-lookup"><span data-stu-id="38b52-118">The <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> method checks the entity tag against the HTTP If-None-Match header of the request.</span></span> <span data-ttu-id="38b52-119">Si la etiqueta de entidad se encuentra en el encabezado If-None-Match de HTTP, se inicia un <xref:System.ServiceModel.Web.WebFaultException> con el código de estado No modificado (304); de lo contrario, el método vuelve.</span><span class="sxs-lookup"><span data-stu-id="38b52-119">If the entity tag is present in the HTTP If-None-Match header, then a <xref:System.ServiceModel.Web.WebFaultException> with a status code of Not Modified (304) is thrown; otherwise the method returns.</span></span> <span data-ttu-id="38b52-120">El mecanismo de recuperación condicional permite al cliente indicar al servidor que tiene esta entidad y enviar solo la entidad actual, si el cliente aún no la tiene.</span><span class="sxs-lookup"><span data-stu-id="38b52-120">The conditional retrieve mechanism allows the client to tell the server that it has this entity and to only send the current entity if the client does not already have it.</span></span> <span data-ttu-id="38b52-121">Un uso de ejemplo del método <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> se puede ver en las operaciones `GetCustomer` y `GetCustomers` del servicio.</span><span class="sxs-lookup"><span data-stu-id="38b52-121">Example usage of the <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> method can be seen in the `GetCustomer` and `GetCustomers` operations of the service.</span></span> <span data-ttu-id="38b52-122">Es importante tener en cuenta que las llamadas a <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> pueden no volver.</span><span class="sxs-lookup"><span data-stu-id="38b52-122">It is important to note that calls to <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> may not return.</span></span> <span data-ttu-id="38b52-123">Los desarrolladores de software deberían implementar la operación de modo que ya se sepa que la solicitud es correcta antes de ejecutar la llamada al método <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A>, de modo que si la llamada al método <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> no se realizara, el servicio enviaría una respuesta con un código de estado correcto.</span><span class="sxs-lookup"><span data-stu-id="38b52-123">Developers should implement the operation so that the request is already known to be successful before the call to <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> is executed, such that if the call to <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> was not present, the service would send a response with a successful status code.</span></span>  
  
 <span data-ttu-id="38b52-124">El método <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalUpdate%2A> es similar al método <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A>.</span><span class="sxs-lookup"><span data-stu-id="38b52-124">The <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalUpdate%2A> method is similar to the <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> method.</span></span> <span data-ttu-id="38b52-125">También acepta la etiqueta de entidad actual para el recurso dado.</span><span class="sxs-lookup"><span data-stu-id="38b52-125">It also takes the current entity tag for the given resource.</span></span> <span data-ttu-id="38b52-126">Sin embargo, se pretende ser utilizado con operaciones [WebInvoke] en el que el método se establece en "PUT" o "Eliminar".</span><span class="sxs-lookup"><span data-stu-id="38b52-126">However, it is intended to be used with [WebInvoke] operations in which the method is set to "PUT" or "DELETE".</span></span> <span data-ttu-id="38b52-127">El método <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalUpdate%2A> comprueba la etiqueta de entidad con respecto al encabezado If-Match de HTTP de la solicitud.</span><span class="sxs-lookup"><span data-stu-id="38b52-127">The <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalUpdate%2A> method checks the entity tag against the HTTP If-Match header of the request.</span></span> <span data-ttu-id="38b52-128">Si la etiqueta de entidad no se encuentra en el encabezado If-Match de HTTP, se genera una <xref:System.ServiceModel.Web.WebFaultException> con un código de estado de error en la condición previa (412).</span><span class="sxs-lookup"><span data-stu-id="38b52-128">If the entity tag is not present in the HTTP If-Match header, then a <xref:System.ServiceModel.Web.WebFaultException> with a status code of Precondition Failed (412) is thrown.</span></span> <span data-ttu-id="38b52-129">El mecanismo de actualización condicional permite al cliente indicar al servidor que tiene esta entidad para el recurso y permitir que únicamente el cliente modifique el recurso; si la entidad que tiene es actual.</span><span class="sxs-lookup"><span data-stu-id="38b52-129">The conditional update mechanism allows the client to tell the server that it has this entity for the resource and to only allow the client to alter the resource; if the entity it has is current.</span></span> <span data-ttu-id="38b52-130">Un uso de ejemplo del método <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalUpdate%2A> se puede ver en las operaciones `UpdateCustomer` y `DeleteCustomer` del servicio.</span><span class="sxs-lookup"><span data-stu-id="38b52-130">Example usage of the <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalUpdate%2A> method can be seen in the `UpdateCustomer` and `DeleteCustomer` operations of the service.</span></span> <span data-ttu-id="38b52-131">Así como con <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A>, es importante tener en cuenta que las llamadas a <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalUpdate%2A> pueden no volver.</span><span class="sxs-lookup"><span data-stu-id="38b52-131">Just as with <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A>, it is important to note that calls to <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalUpdate%2A> may not return.</span></span> <span data-ttu-id="38b52-132">Los desarrolladores de software deberían implementar tal operación de modo que ya se sepa que la solicitud es correcta antes de ejecutar la llamada al método <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalUpdate%2A>, de modo que si la llamada al método <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalUpdate%2A> no se realizara, el servicio respondería con un código de estado correcto.</span><span class="sxs-lookup"><span data-stu-id="38b52-132">Developers should implement the operation such that the request is already known to be successful before the call to <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalUpdate%2A> is executed, such that if the call to <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalUpdate%2A> was not present, the service would respond with a successful status code.</span></span>  
  
 <span data-ttu-id="38b52-133">El ejemplo consta de un servicio autohospedado y un cliente que se ejecuta dentro de una aplicación de consola.</span><span class="sxs-lookup"><span data-stu-id="38b52-133">The sample consists of a self-hosted service and a client that runs within a console application.</span></span> <span data-ttu-id="38b52-134">A medida que se ejecuta la aplicación de consola, el cliente realiza solicitudes al servicio y escribe la información pertinente de las respuestas en la ventana de la consola.</span><span class="sxs-lookup"><span data-stu-id="38b52-134">As the console application runs, the client makes requests to the service and writes the pertinent information from the responses to the console window.</span></span>  
  
#### <a name="to-run-the-sample"></a><span data-ttu-id="38b52-135">Para ejecutar el ejemplo</span><span class="sxs-lookup"><span data-stu-id="38b52-135">To run the sample</span></span>  
  
1.  <span data-ttu-id="38b52-136">Abra la solución del ejemplo de Get y Put condicionales.</span><span class="sxs-lookup"><span data-stu-id="38b52-136">Open the solution for the Conditional Get and Put sample.</span></span> <span data-ttu-id="38b52-137">Al iniciar [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)], debe ejecutarlo como administrador para ejecutar el ejemplo correctamente.</span><span class="sxs-lookup"><span data-stu-id="38b52-137">When launching [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)], you must run as an administrator to execute the sample successfully.</span></span> <span data-ttu-id="38b52-138">Hacer esto haciendo clic con el [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] icono y elija **ejecutar como administrador** en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="38b52-138">Do this by right-clicking the [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] icon and choosing **Run as Administrator** from the context menu.</span></span>  
  
2.  <span data-ttu-id="38b52-139">Presione CTRL+MAYÚS+B para compilar la solución y, a continuación, presione CTRL+F5 para ejecutar el proyecto de la aplicación de consola.</span><span class="sxs-lookup"><span data-stu-id="38b52-139">Press CTRL+SHIFT+B to build the solution and then press CTRL+F5 to run the console application project.</span></span> <span data-ttu-id="38b52-140">Si este proyecto se ejecuta con la depuración habilitada (al presionar F5 en lugar de CTRL+F5), el depurador se detiene cuando se genera una excepción al comprobar las operaciones GET y PUT condicionales.</span><span class="sxs-lookup"><span data-stu-id="38b52-140">If running this project with debugging enabled (by pressing F5 instead of CTRL+F5), the debugger stops when an exception is thrown by the conditional GET and PUT checking.</span></span> <span data-ttu-id="38b52-141">Si sucede esto, presione F5 para seguir ejecutando el ejemplo.</span><span class="sxs-lookup"><span data-stu-id="38b52-141">When this happens, press F5 to continue executing the sample.</span></span>  
  
3.  <span data-ttu-id="38b52-142">La ventana de la consola aparece y proporciona el URI del servicio en ejecución y el URI de la página de Ayuda HTML para este.</span><span class="sxs-lookup"><span data-stu-id="38b52-142">The console window appear sand provides the URI of the running service and the URI of the HTML help page for the running service.</span></span>  
  
4.  <span data-ttu-id="38b52-143">A medida que se ejecute el ejemplo, el cliente envía las solicitudes al servicio y escribe las respuestas en la ventana de la consola.</span><span class="sxs-lookup"><span data-stu-id="38b52-143">As the sample runs, the client sends requests to the service and writes the responses to the console window.</span></span>  
  
5.  <span data-ttu-id="38b52-144">Presione cualquier tecla para terminar el ejemplo.</span><span class="sxs-lookup"><span data-stu-id="38b52-144">Press any key to terminate the sample.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="38b52-145">Puede que los ejemplos ya estén instalados en su equipo.</span><span class="sxs-lookup"><span data-stu-id="38b52-145">The samples may already be installed on your machine.</span></span> <span data-ttu-id="38b52-146">Compruebe el siguiente directorio (predeterminado) antes de continuar.</span><span class="sxs-lookup"><span data-stu-id="38b52-146">Check for the following (default) directory before continuing.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  <span data-ttu-id="38b52-147">Si no existe este directorio, vaya a [Windows Communication Foundation (WCF) y Windows Workflow Foundation (WF) Samples para .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) para descargar todos los Windows Communication Foundation (WCF) y [!INCLUDE[wf1](../../../../includes/wf1-md.md)] ejemplos.</span><span class="sxs-lookup"><span data-stu-id="38b52-147">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="38b52-148">Este ejemplo se encuentra en el siguiente directorio.</span><span class="sxs-lookup"><span data-stu-id="38b52-148">This sample is located in the following directory.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WCF\Basic\Web\ConditionalGetAndPut`
