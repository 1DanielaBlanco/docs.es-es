---
title: Selección de formato automática
ms.date: 03/30/2017
ms.assetid: dab51e56-8517-4a6a-bb54-b55b15ab37bb
ms.openlocfilehash: 4fd695195f5c7c13bc088248a6b3c12388328d37
ms.sourcegitcommit: 2eceb05f1a5bb261291a1f6a91c5153727ac1c19
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/04/2018
ms.locfileid: "43659766"
---
# <a name="automatic-format-selection"></a><span data-ttu-id="952ee-102">Selección de formato automática</span><span class="sxs-lookup"><span data-stu-id="952ee-102">Automatic Format Selection</span></span>
<span data-ttu-id="952ee-103">Este ejemplo muestra cómo habilitar la selección automática de formato (XML o JSON) con el modelo, así como para establecer explícitamente el formato en el código de operación de programación de REST de Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="952ee-103">This sample demonstrates how to enable automatic format selection (XML or JSON) with the Windows Communication Foundation (WCF) REST programming model, as well as how to explicitly set the format in the operation code.</span></span>  
  
## <a name="sample-details"></a><span data-ttu-id="952ee-104">Detalles del ejemplo</span><span class="sxs-lookup"><span data-stu-id="952ee-104">Sample Details</span></span>  
 <span data-ttu-id="952ee-105">El ejemplo está compuesto de un servicio junto con el código de cliente que realiza las solicitudes al servicio.</span><span class="sxs-lookup"><span data-stu-id="952ee-105">The sample consists of a service along with client code that makes requests to the service.</span></span> <span data-ttu-id="952ee-106">El servicio admite una única operación HTTP `GET` (`EchoWithGet`) y una única operación HTTP `POST` (`EchoWithPost`).</span><span class="sxs-lookup"><span data-stu-id="952ee-106">The service supports a single HTTP `GET` operation (`EchoWithGet`) and a single HTTP `POST` operation (`EchoWithPost`).</span></span> <span data-ttu-id="952ee-107">Ambas operaciones esperan una cadena y, a continuación, devuelven la cadena en la respuesta.</span><span class="sxs-lookup"><span data-stu-id="952ee-107">Both operations expect a string and then return the string in the response.</span></span> <span data-ttu-id="952ee-108">Con la operación `GET`, la cadena se proporciona en un parámetro de cadena de consulta de URI.</span><span class="sxs-lookup"><span data-stu-id="952ee-108">With the `GET` operation, the string is provided in a URI query-string parameter.</span></span> <span data-ttu-id="952ee-109">Con la operación `POST`, la cadena se proporciona en el cuerpo de la solicitud, serializado en XML.</span><span class="sxs-lookup"><span data-stu-id="952ee-109">With the `POST` operation, the string is provided in the body of the request, serialized in XML.</span></span> <span data-ttu-id="952ee-110">El servicio puede devolver las respuestas en XML o JSON, utilizando las nuevas características de selección automática de formato y selección imperativa de formato de [!INCLUDE[netfx40_long](../../../../includes/netfx40-long-md.md)].</span><span class="sxs-lookup"><span data-stu-id="952ee-110">The service is able to return responses in either XML or JSON, utilizing the new automatic format selection and imperative format selection features in [!INCLUDE[netfx40_long](../../../../includes/netfx40-long-md.md)].</span></span>  
  
 <span data-ttu-id="952ee-111">En el ejemplo, la selección automática de formato se habilita con el archivo App.config.</span><span class="sxs-lookup"><span data-stu-id="952ee-111">In the sample, automatic format selection is enabled using the App.config file.</span></span> <span data-ttu-id="952ee-112">En el extremo HTTP web predeterminado, el atributo `automaticFormatSelectionEnabled` se le ha proporcionado el valor `true`.</span><span class="sxs-lookup"><span data-stu-id="952ee-112">On the default Web HTTP endpoint, the `automaticFormatSelectionEnabled` attribute has been given a value of `true`.</span></span> <span data-ttu-id="952ee-113">La infraestructura de WCF con selección de formato automática habilitada, selecciona el formato más adecuado respuesta (XML o JSON) dado los encabezados Content-Type o HTTP Accept de la solicitud.</span><span class="sxs-lookup"><span data-stu-id="952ee-113">With automatic format selection enabled, the WCF infrastructure selects the most appropriate response format (XML or JSON) given the HTTP Accept or Content-Type headers of the request.</span></span> <span data-ttu-id="952ee-114">Para utilizar esta nueva característica, no es necesario que el desarrollador de software proporcione código adicional ni una configuración aparte de establecer el atributo `automaticFormatSelectionEnabled` en `true`.</span><span class="sxs-lookup"><span data-stu-id="952ee-114">The developer is not required to provide any additional code or configuration other than setting the `automaticFormatSelectionEnabled` attribute to `true` to use this new feature.</span></span> <span data-ttu-id="952ee-115">En el código de cliente en Program.cs, las solicitudes se envían tanto a la `GET` y `POST` las operaciones del servicio con el encabezado HTTP Accept especificado como "application/xml" o "application/json" y el servicio devuelve una respuesta en el que formato respectivo.</span><span class="sxs-lookup"><span data-stu-id="952ee-115">In the client code in Program.cs, requests are sent to both the `GET` and `POST` operations of the service with the HTTP Accept header specified as either "application/xml" or "application/json" and the service returns a response in that respective format.</span></span>  
  
 <span data-ttu-id="952ee-116">Además, en la operación `GET` se utiliza la selección imperativa de formato.</span><span class="sxs-lookup"><span data-stu-id="952ee-116">Also in the `GET` operation, imperative format selection is used.</span></span> <span data-ttu-id="952ee-117">La operación `GET` comprueba un parámetro de la cadena de consulta `format` opcional y, si está presente, establece el formato de la respuesta en la propiedad <xref:System.ServiceModel.Web.WebOperationContext.OutgoingResponse%2A>.</span><span class="sxs-lookup"><span data-stu-id="952ee-117">The `GET` operation checks for an optional `format` query-string parameter and if present, sets the response format on the <xref:System.ServiceModel.Web.WebOperationContext.OutgoingResponse%2A> property.</span></span> <span data-ttu-id="952ee-118">Imperativamente establecer el formato de respuesta de esta manera, invalida la selección de formato automática mediante la infraestructura de WCF.</span><span class="sxs-lookup"><span data-stu-id="952ee-118">Imperatively setting the response format in this way overrides the automatic format selection done by the WCF infrastructure.</span></span>  
  
 <span data-ttu-id="952ee-119">El ejemplo consta de un servicio autohospedado y un cliente que se ejecuta dentro de una aplicación de consola.</span><span class="sxs-lookup"><span data-stu-id="952ee-119">The sample consists of a self-hosted service and a client that runs within a console application.</span></span> <span data-ttu-id="952ee-120">A medida que se ejecuta la aplicación de consola, el cliente realiza solicitudes al servicio y escribe la información pertinente de las respuestas en la ventana de la consola.</span><span class="sxs-lookup"><span data-stu-id="952ee-120">As the console application runs, the client makes requests to the service and writes the pertinent information from the responses to the console window.</span></span>  
  
#### <a name="to-use-this-sample"></a><span data-ttu-id="952ee-121">Para utilizar este ejemplo</span><span class="sxs-lookup"><span data-stu-id="952ee-121">To use this sample</span></span>  
  
1.  <span data-ttu-id="952ee-122">Abra la solución del ejemplo de selección automática de formato.</span><span class="sxs-lookup"><span data-stu-id="952ee-122">Open the solution for the Automatic Format Selection Sample.</span></span> <span data-ttu-id="952ee-123">Al iniciar [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)], debe ejecutarlo como administrador para que el ejemplo se ejecute correctamente.</span><span class="sxs-lookup"><span data-stu-id="952ee-123">When launching [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)], you must run as an administrator for the sample to execute successfully.</span></span> <span data-ttu-id="952ee-124">Hacer esto haciendo clic con el [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] icono y seleccione **ejecutar como administrador** en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="952ee-124">Do this by right-clicking the [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] icon and select **Run as Administrator** from the context menu.</span></span>  
  
2.  <span data-ttu-id="952ee-125">Presione CTRL+MAYÚS+B para compilar la solución y, a continuación, presione Ctrl+F5 para ejecutar el proyecto AutomaticFormatSelection de la aplicación de consola.</span><span class="sxs-lookup"><span data-stu-id="952ee-125">Press CTRL+SHIFT+B to build the solution and then press Ctrl+F5 to run the console application AutomaticFormatSelection project.</span></span> <span data-ttu-id="952ee-126">La ventana de la consola aparece y proporciona el URI del servicio en ejecución y el URI de la página de Ayuda HTML para este.</span><span class="sxs-lookup"><span data-stu-id="952ee-126">The console window appears and provides the URI of the running service and the URI of the HTML help page for the running service.</span></span>  
  
3.  <span data-ttu-id="952ee-127">A medida que se ejecute el ejemplo, el cliente envía las solicitudes al servicio y escribe las respuestas en la ventana de la consola.</span><span class="sxs-lookup"><span data-stu-id="952ee-127">As the sample runs, the client sends requests to the service and writes the responses to the console window.</span></span> <span data-ttu-id="952ee-128">Observe los diferentes formatos de las respuestas en XML y JSON.</span><span class="sxs-lookup"><span data-stu-id="952ee-128">Notice the different formats of the responses in XML and JSON.</span></span>  
  
4.  <span data-ttu-id="952ee-129">Presione cualquier tecla para terminar el ejemplo.</span><span class="sxs-lookup"><span data-stu-id="952ee-129">Press any key to terminate the sample.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="952ee-130">Puede que los ejemplos ya estén instalados en su equipo.</span><span class="sxs-lookup"><span data-stu-id="952ee-130">The samples may already be installed on your machine.</span></span> <span data-ttu-id="952ee-131">Compruebe el siguiente directorio (predeterminado) antes de continuar.</span><span class="sxs-lookup"><span data-stu-id="952ee-131">Check for the following (default) directory before continuing.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  <span data-ttu-id="952ee-132">Si no existe este directorio, vaya a [Windows Communication Foundation (WCF) y Windows Workflow Foundation (WF) Samples para .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) para descargar todos los Windows Communication Foundation (WCF) y [!INCLUDE[wf1](../../../../includes/wf1-md.md)] ejemplos.</span><span class="sxs-lookup"><span data-stu-id="952ee-132">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="952ee-133">Este ejemplo se encuentra en el siguiente directorio.</span><span class="sxs-lookup"><span data-stu-id="952ee-133">This sample is located in the following directory.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WCF\Basic\Web\AutomaticFormatSelection`  
  
## <a name="see-also"></a><span data-ttu-id="952ee-134">Vea también</span><span class="sxs-lookup"><span data-stu-id="952ee-134">See Also</span></span>
