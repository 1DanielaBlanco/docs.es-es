---
title: Filtros avanzados
ms.date: 03/30/2017
ms.assetid: 8d81590f-e036-4f96-824a-4a187f462764
ms.openlocfilehash: 7022384e8abe93f4276eec48785b3243ed926438
ms.sourcegitcommit: 3c1c3ba79895335ff3737934e39372555ca7d6d0
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 09/05/2018
ms.locfileid: "43805447"
---
# <a name="advanced-filters"></a><span data-ttu-id="97e20-102">Filtros avanzados</span><span class="sxs-lookup"><span data-stu-id="97e20-102">Advanced Filters</span></span>
<span data-ttu-id="97e20-103">Este ejemplo muestra un servicio de enrutamiento de Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="97e20-103">This sample demonstrates a Windows Communication Foundation (WCF) routing service.</span></span> <span data-ttu-id="97e20-104">El servicio de enrutamiento es un componente WCF que facilita la tarea debe incluir un enrutador basado en contenido en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="97e20-104">The routing service is a WCF component that makes it easy to include a content-based router in your application.</span></span> <span data-ttu-id="97e20-105">Este ejemplo adapta el ejemplo de calculadora de WCF estándar para comunicarse con el servicio de enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="97e20-105">This sample adapts the standard WCF Calculator sample to communicate using the routing service.</span></span> <span data-ttu-id="97e20-106">En este ejemplo se muestra cómo definir la lógica de enrutamiento basado en contenido a través del uso de filtros de mensajes y tablas de filtro de mensajes.</span><span class="sxs-lookup"><span data-stu-id="97e20-106">This sample shows how to define content-based routing logic through the use of message filters and message filter tables.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="97e20-107">Puede que los ejemplos ya estén instalados en su equipo.</span><span class="sxs-lookup"><span data-stu-id="97e20-107">The samples may already be installed on your computer.</span></span> <span data-ttu-id="97e20-108">Compruebe el siguiente directorio (predeterminado) antes de continuar.</span><span class="sxs-lookup"><span data-stu-id="97e20-108">Check for the following (default) directory before continuing.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  <span data-ttu-id="97e20-109">Si no existe este directorio, vaya a [Windows Communication Foundation (WCF) y Windows Workflow Foundation (WF) Samples para .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) para descargar todos los Windows Communication Foundation (WCF) y [!INCLUDE[wf1](../../../../includes/wf1-md.md)] ejemplos.</span><span class="sxs-lookup"><span data-stu-id="97e20-109">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="97e20-110">Este ejemplo se encuentra en el siguiente directorio.</span><span class="sxs-lookup"><span data-stu-id="97e20-110">This sample is located in the following directory.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WCF\Basic\RoutingServices\AdvancedFilters`  
  
## <a name="sample-details"></a><span data-ttu-id="97e20-111">Detalles del ejemplo</span><span class="sxs-lookup"><span data-stu-id="97e20-111">Sample Details</span></span>  
 <span data-ttu-id="97e20-112">En la siguiente tabla se muestran los filtros de mensajes que se agregan a la tabla de filtros de mensajes del servicio de enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="97e20-112">The following table shows the message filters that are added to the message filter table of the routing service.</span></span>  
  
|<span data-ttu-id="97e20-113">Filtro</span><span class="sxs-lookup"><span data-stu-id="97e20-113">Filter</span></span>|<span data-ttu-id="97e20-114">Regla</span><span class="sxs-lookup"><span data-stu-id="97e20-114">Rule</span></span>|<span data-ttu-id="97e20-115">Prioridad</span><span class="sxs-lookup"><span data-stu-id="97e20-115">Priority</span></span>|  
|------------|----------|--------------|  
|<span data-ttu-id="97e20-116">Si (tiene encabezado)</span><span class="sxs-lookup"><span data-stu-id="97e20-116">If (has header)</span></span>|<span data-ttu-id="97e20-117">Redondeo</span><span class="sxs-lookup"><span data-stu-id="97e20-117">Rounding</span></span>|<span data-ttu-id="97e20-118">2</span><span class="sxs-lookup"><span data-stu-id="97e20-118">2</span></span>|  
|<span data-ttu-id="97e20-119">Si (se muestra en Ep2)</span><span class="sxs-lookup"><span data-stu-id="97e20-119">If (showed up on Ep2)</span></span>|<span data-ttu-id="97e20-120">Estándar</span><span class="sxs-lookup"><span data-stu-id="97e20-120">Regular</span></span>|<span data-ttu-id="97e20-121">1</span><span class="sxs-lookup"><span data-stu-id="97e20-121">1</span></span>|  
|<span data-ttu-id="97e20-122">Si (se muestra con Address2)</span><span class="sxs-lookup"><span data-stu-id="97e20-122">If (showed up with Address2)</span></span>|<span data-ttu-id="97e20-123">Redondeo</span><span class="sxs-lookup"><span data-stu-id="97e20-123">Rounding</span></span>|<span data-ttu-id="97e20-124">1</span><span class="sxs-lookup"><span data-stu-id="97e20-124">1</span></span>|  
|<span data-ttu-id="97e20-125">Si (RoundRobin1)</span><span class="sxs-lookup"><span data-stu-id="97e20-125">If (RoundRobin1)</span></span>|<span data-ttu-id="97e20-126">Estándar</span><span class="sxs-lookup"><span data-stu-id="97e20-126">Regular</span></span>|<span data-ttu-id="97e20-127">0</span><span class="sxs-lookup"><span data-stu-id="97e20-127">0</span></span>|  
|<span data-ttu-id="97e20-128">If (RoundRobin2)</span><span class="sxs-lookup"><span data-stu-id="97e20-128">If (RoundRobin2)</span></span>|<span data-ttu-id="97e20-129">Redondeo</span><span class="sxs-lookup"><span data-stu-id="97e20-129">Rounding</span></span>|<span data-ttu-id="97e20-130">0</span><span class="sxs-lookup"><span data-stu-id="97e20-130">0</span></span>|  
  
 <span data-ttu-id="97e20-131">Los filtros de mensajes y las tablas de filtros de mensajes se pueden crear y configurar o bien a través del código o bien en el archivo de configuración de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="97e20-131">The message filters and message filter tables can be created and configured either through code or in the application configuration file.</span></span> <span data-ttu-id="97e20-132">En este ejemplo, puede encontrar los filtros de mensajes y las tablas de filtros de mensajes definidos a través del código en el archivo RoutingService\routing.cs o definidos en el archivo de configuración de la aplicación del archivo RoutingService\App.config.</span><span class="sxs-lookup"><span data-stu-id="97e20-132">For this sample, you can find the message filters and message filter tables defined through code in the RoutingService\routing.cs file, or defined in the application configuration file in the RoutingService\App.config file.</span></span> <span data-ttu-id="97e20-133">Los siguientes párrafos describen el modo en que se crean los filtros de mensajes y las tablas de filtros de mensajes para obtener este ejemplo a través del código.</span><span class="sxs-lookup"><span data-stu-id="97e20-133">The following paragraphs describe how the message filters and message filter tables are created for this sample through code.</span></span>  
  
 <span data-ttu-id="97e20-134">Primero, un objeto <xref:System.ServiceModel.Dispatcher.XPathMessageFilter> busca el encabezado personalizado.</span><span class="sxs-lookup"><span data-stu-id="97e20-134">First, an <xref:System.ServiceModel.Dispatcher.XPathMessageFilter> looks for the custom header.</span></span> <span data-ttu-id="97e20-135">Tenga en cuenta que el objeto <xref:System.ServiceModel.WSHttpBinding> da como resultado una versión de sobre que usa SOAP 1.2, de modo que la instrucción Xpath se defina para utilizar el espacio de nombres SOAP 1.2.</span><span class="sxs-lookup"><span data-stu-id="97e20-135">Note that <xref:System.ServiceModel.WSHttpBinding> results in an envelope version using SOAP 1.2, so the XPath statement is defined to use the SOAP 1.2 namespace.</span></span> <span data-ttu-id="97e20-136">El administrador del espacio de nombres predeterminado para <xref:System.ServiceModel.Dispatcher.XPathMessageFilter> ya define un prefijo para el espacio de nombres SOAP 1.2, /s12, que se puede utilizar.</span><span class="sxs-lookup"><span data-stu-id="97e20-136">The default namespace manager for <xref:System.ServiceModel.Dispatcher.XPathMessageFilter>s already defines a prefix for the SOAP 1.2 namespace, /s12, which can be used.</span></span> <span data-ttu-id="97e20-137">Sin embargo, el administrador del espacio de nombres predeterminado no tiene el espacio de nombres personalizado que el cliente utiliza para definir el valor de encabezado real, de modo que se debe definir el prefijo.</span><span class="sxs-lookup"><span data-stu-id="97e20-137">However, the default namespace manager does not have the custom namespace that the client uses to define the actual header value, so that prefix must be defined.</span></span> <span data-ttu-id="97e20-138">Cualquier mensaje que se presente con este encabezado coincide con este filtro.</span><span class="sxs-lookup"><span data-stu-id="97e20-138">Any message that shows up with this header matches this filter.</span></span>  
  
```  
XPathMessageContext namespaceManager = new XPathMessageContext();  
namespaceManager.AddNamespace("custom", "http://my.custom.namespace/");  
  
XPathMessageFilter xpathFilter = new XPathMessageFilter("/s12:Envelope/s12:Header/custom:RoundingCalculator = 1", namespaceManager);  
```  
  
 <span data-ttu-id="97e20-139">El segundo filtro es un <xref:System.ServiceModel.Dispatcher.EndpointNameMessageFilter>, que coincide con cualquier mensaje que se recibiera en `calculatorEndpoint`.</span><span class="sxs-lookup"><span data-stu-id="97e20-139">The second filter is an <xref:System.ServiceModel.Dispatcher.EndpointNameMessageFilter>, which matches any message that was received on the `calculatorEndpoint`.</span></span> <span data-ttu-id="97e20-140">El nombre de punto de conexión se define cuando se crea un objeto de punto de conexión de servicio.</span><span class="sxs-lookup"><span data-stu-id="97e20-140">The endpoint name is defined when a service endpoint object is created.</span></span>  
  
```  
EndpointNameMessageFilter endpointNameFilter = new EndpointNameMessageFilter("calculatorEndpoint");  
```  
  
 <span data-ttu-id="97e20-141">El tercer filtro es un <xref:System.ServiceModel.Dispatcher.PrefixEndpointAddressMessageFilter>.</span><span class="sxs-lookup"><span data-stu-id="97e20-141">The third filter is a <xref:System.ServiceModel.Dispatcher.PrefixEndpointAddressMessageFilter>.</span></span> <span data-ttu-id="97e20-142">Esto coincide con cualquier mensaje que se presentara en un punto de conexión con una dirección que coincida con el prefijo de dirección (o la parte delantera) proporcionado.</span><span class="sxs-lookup"><span data-stu-id="97e20-142">This matches any message that showed up on an endpoint with an address that matches the address prefix (or the front portion) provided.</span></span> <span data-ttu-id="97e20-143">En este ejemplo se define el prefijo de dirección como "http://localhost/routingservice/router/rounding/".</span><span class="sxs-lookup"><span data-stu-id="97e20-143">In this example the address prefix is defined as "http://localhost/routingservice/router/rounding/".</span></span> <span data-ttu-id="97e20-144">Esto significa que los mensajes entrantes que se dirigen al " http://localhost/routingservice/router/rounding/ \*" coincide con este filtro.</span><span class="sxs-lookup"><span data-stu-id="97e20-144">This means that any incoming messages that are addressed to "http://localhost/routingservice/router/rounding/\*" are matched by this filter.</span></span> <span data-ttu-id="97e20-145">En este caso, es un mensaje que se muestran en el punto de conexión de calculadora de redondeo, que tiene la dirección de "http://localhost/routingservice/router/rounding/calculator".</span><span class="sxs-lookup"><span data-stu-id="97e20-145">In this case, it is messages that show up on the Rounding Calculator endpoint, which has the address of "http://localhost/routingservice/router/rounding/calculator".</span></span>  
  
```  
PrefixEndpointAddressMessageFilter prefixAddressFilter = new PrefixEndpointAddressMessageFilter(new EndpointAddress("http://localhost/routingservice/router/rounding/"));  
```  
  
 <span data-ttu-id="97e20-146">Los dos filtros de mensajes últimos son <xref:System.ServiceModel.Dispatcher.MessageFilter> personalizados.</span><span class="sxs-lookup"><span data-stu-id="97e20-146">The last two message filters are custom <xref:System.ServiceModel.Dispatcher.MessageFilter>s.</span></span> <span data-ttu-id="97e20-147">En este ejemplo, se usa un filtro de mensajes “RoundRobin”.</span><span class="sxs-lookup"><span data-stu-id="97e20-147">In this example, a "RoundRobin" message filter is used.</span></span> <span data-ttu-id="97e20-148">Este filtro de mensajes se crea en el archivo RoutingService\RoundRobinMessageFilter.cs proporcionado.</span><span class="sxs-lookup"><span data-stu-id="97e20-148">This message filter is created in the provided RoutingService\RoundRobinMessageFilter.cs file.</span></span> <span data-ttu-id="97e20-149">Estos filtros, cuando se establecen en el mismo grupo, alternan entre notificar que coinciden con el mensaje y que no lo hacen, de modo que solo uno de ellos responde `true` a la vez.</span><span class="sxs-lookup"><span data-stu-id="97e20-149">These filters, when set to the same group, alternate between reporting that they match the message and that they do not, such that only one of them responds `true` at a time.</span></span>  
  
```  
RoundRobinMessageFilter roundRobinFilter1 = new RoundRobinMessageFilter("group1");  
  
RoundRobinMessageFilter roundRobinFilter2 = new RoundRobinMessageFilter("group1");  
```  
  
 <span data-ttu-id="97e20-150">Luego, todos esos mensajes se agregan a un <xref:System.ServiceModel.Dispatcher.MessageFilterTable%601>.</span><span class="sxs-lookup"><span data-stu-id="97e20-150">Next, all of those messages are added to a <xref:System.ServiceModel.Dispatcher.MessageFilterTable%601>.</span></span> <span data-ttu-id="97e20-151">Para ello, se especifican prioridades para influir en el orden en el que la tabla de filtros de mensajes ejecuta los filtros.</span><span class="sxs-lookup"><span data-stu-id="97e20-151">In doing so, priorities are specified to influence the order in which the message filter table executes the filters.</span></span> <span data-ttu-id="97e20-152">Cuanta más alta es la prioridad, antes se ejecuta el filtro; cuanto menor es la prioridad, más tarde se ejecuta un filtro.</span><span class="sxs-lookup"><span data-stu-id="97e20-152">The higher the priority, the sooner the filter is executed; the lower the priority, the later a filter is executed.</span></span> <span data-ttu-id="97e20-153">Por tanto, un filtro de prioridad 2 se ejecuta antes que uno de prioridad 1.</span><span class="sxs-lookup"><span data-stu-id="97e20-153">Thus a filter at priority 2 runs before a filter at priority 1.</span></span> <span data-ttu-id="97e20-154">El nivel de prioridad predeterminado es 0 si no se especifica ninguno.</span><span class="sxs-lookup"><span data-stu-id="97e20-154">The default priority level if none is specified is 0.</span></span> <span data-ttu-id="97e20-155">En una tabla de filtros de mensajes se ejecutan todos los filtros en un nivel de prioridad determinado antes de pasar al nivel de prioridad inferior siguiente.</span><span class="sxs-lookup"><span data-stu-id="97e20-155">A message filter table executes all of the filters at a given priority level before moving to the next lowest priority level.</span></span> <span data-ttu-id="97e20-156">Si se encuentra una coincidencia en una prioridad determinada, la tabla de filtros de mensajes no sigue intentando encontrar coincidencias en la prioridad inferior siguiente.</span><span class="sxs-lookup"><span data-stu-id="97e20-156">If a match is found at a particular priority, then the message filter table does not continue trying to find matches at the next lower priority.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="97e20-157">Aunque este ejemplo muestra cómo utilizar las prioridades del filtro de mensajes, en general es más adecuado diseñar y configurar los filtros de modo que no requieran la asignación de prioridades para funcionar correctamente.</span><span class="sxs-lookup"><span data-stu-id="97e20-157">While this example shows how to use message filter priorities, in general it is more performant and better design to design and configure your filters such that they do not require prioritization to function correctly.</span></span>  
  
 <span data-ttu-id="97e20-158">El primer filtro que se va a agregar es el filtro de XPath y su prioridad se establece en 2.</span><span class="sxs-lookup"><span data-stu-id="97e20-158">The first filter to be added is the XPath filter and its priority is set to 2.</span></span> <span data-ttu-id="97e20-159">Este es el primer filtro de mensajes que se ejecuta.</span><span class="sxs-lookup"><span data-stu-id="97e20-159">This is the first message filter that executes.</span></span> <span data-ttu-id="97e20-160">Si encuentra el encabezado personalizado, independientemente de cuáles serían los resultados de los demás filtros, el mensaje se enruta al punto de conexión de la calculadora de redondeo.</span><span class="sxs-lookup"><span data-stu-id="97e20-160">If it finds the custom header, regardless of what the results of the other filters would be, the message is routed to the Rounding Calculator endpoint.</span></span>  
  
 <span data-ttu-id="97e20-161">En la prioridad 1, se agregan dos filtros.</span><span class="sxs-lookup"><span data-stu-id="97e20-161">At priority 1, two filters are added.</span></span> <span data-ttu-id="97e20-162">De nuevo, solo se ejecutan si el filtro de XPath en la prioridad 2 no coincide con el mensaje.</span><span class="sxs-lookup"><span data-stu-id="97e20-162">Again, these only run if the XPath filter at priority 2 does not match the message.</span></span> <span data-ttu-id="97e20-163">Estos dos filtros muestran dos maneras diferentes de determinar dónde se dirigió el mensaje cuando se presentó.</span><span class="sxs-lookup"><span data-stu-id="97e20-163">These two filters show two different ways to determine where the message was addressed when it showed up.</span></span> <span data-ttu-id="97e20-164">Dado que los dos filtran comprueban eficazmente si el mensaje llegó a uno de los dos extremos, se pueden ejecutar en el mismo nivel de prioridad porque ambos no devuelven `true` al mismo tiempo.</span><span class="sxs-lookup"><span data-stu-id="97e20-164">Because the two filters effectively check to see whether the message arrived at one of the two endpoints, they can be run at the same priority level because they do not both return `true` at the same time.</span></span>  
  
 <span data-ttu-id="97e20-165">Finalmente, en la prioridad 0 (la más baja) se ejecutan los filtros de mensajes RoundRobin.</span><span class="sxs-lookup"><span data-stu-id="97e20-165">Finally, at Priority 0 (the lowest priority) run the RoundRobin message filters.</span></span> <span data-ttu-id="97e20-166">Dado que los filtros se configuran con el mismo nombre de grupo, solo uno de ellos coincide a la vez.</span><span class="sxs-lookup"><span data-stu-id="97e20-166">Because the filters are configured with the same group name, only one of them matches at a time.</span></span> <span data-ttu-id="97e20-167">Dado que se han enrutado todos los mensajes con el encabezado personalizado y todos los dirigidos a extremos virtualizados concretos, solo los mensajes administrados por los filtros de mensajes RoundRobin son los que se dirigieron al extremo del enrutador predeterminado sin el encabezado personalizado.</span><span class="sxs-lookup"><span data-stu-id="97e20-167">Because all messages with the custom header have been routed and all those addressed to the specific virtualized endpoints, messages handled by the RoundRobin message filters are only messages that were addressed to the default router endpoint without the custom header.</span></span> <span data-ttu-id="97e20-168">Dado que estos mensajes activan un mensaje para cada llamada, la mitad de las operaciones va al punto de conexión de calculadora normal y la otra mitad va al punto de conexión de calculadora de redondeo.</span><span class="sxs-lookup"><span data-stu-id="97e20-168">Because these messages switch on a message for each call, half of the operations go to the Regular Calculator endpoint and the other half go to the Rounding Calculator endpoint.</span></span>  
  
#### <a name="to-use-this-sample"></a><span data-ttu-id="97e20-169">Para utilizar este ejemplo</span><span class="sxs-lookup"><span data-stu-id="97e20-169">To use this sample</span></span>  
  
1.  <span data-ttu-id="97e20-170">Con [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)], abra AdvancedFilters.sln.</span><span class="sxs-lookup"><span data-stu-id="97e20-170">Using [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)], open AdvancedFilters.sln.</span></span>  
  
2.  <span data-ttu-id="97e20-171">Para abrir **el Explorador de soluciones**, seleccione **el Explorador de soluciones** desde el **vista** menú.</span><span class="sxs-lookup"><span data-stu-id="97e20-171">To open **Solution Explorer**, select **Solution Explorer** from the **View** menu.</span></span>  
  
3.  <span data-ttu-id="97e20-172">Presione F5 o CTRL + MAYÚS + B en Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="97e20-172">Press F5 or CTRL+SHIFT+B in Visual Studio.</span></span>  
  
    1.  <span data-ttu-id="97e20-173">Si desea iniciar automáticamente los proyectos necesarios al presionar F5, haga clic en la solución y seleccione **propiedades**.</span><span class="sxs-lookup"><span data-stu-id="97e20-173">If you would like to auto-launch the necessary projects when you press F5, right-click the solution and select **Properties**.</span></span> <span data-ttu-id="97e20-174">Seleccione el **proyecto de inicio** nodo bajo **propiedades comunes** en el panel izquierdo.</span><span class="sxs-lookup"><span data-stu-id="97e20-174">Select the **Startup Project** node under **Common Properties** in the left pane.</span></span> <span data-ttu-id="97e20-175">Seleccione el **varios proyectos de inicio** botón de radio y establezca todos los proyectos que tienen el **iniciar** acción.</span><span class="sxs-lookup"><span data-stu-id="97e20-175">Select the **Multiple Startup Projects**  radio button and set all of the projects to have the **Start** action.</span></span>  
  
    2.  <span data-ttu-id="97e20-176">Si compila el proyecto con CTRL+MAYÚS+B, debe iniciar las siguientes aplicaciones:</span><span class="sxs-lookup"><span data-stu-id="97e20-176">If you build the project with CTRL+SHIFT+B, you must start the following applications:</span></span>  
  
        1.  <span data-ttu-id="97e20-177">El cliente de la calculadora (./CalculatorClient/bin/client.exe)</span><span class="sxs-lookup"><span data-stu-id="97e20-177">Calculator Client (./CalculatorClient/bin/client.exe)</span></span>  
  
        2.  <span data-ttu-id="97e20-178">El servicio de calculadora (./CalculatorService/bin/service.exe)</span><span class="sxs-lookup"><span data-stu-id="97e20-178">Calculator Service (./CalculatorService/bin/service.exe)</span></span>  
  
        3.  <span data-ttu-id="97e20-179">El servicio de enrutamiento de calculadora (./RoundingCalcService/bin/service.exe)</span><span class="sxs-lookup"><span data-stu-id="97e20-179">Routing Calculator Service (./RoundingCalcService/bin/service.exe)</span></span>  
  
        4.  <span data-ttu-id="97e20-180">RoutingService (./RoutingService/bin/RoutingService.exe)</span><span class="sxs-lookup"><span data-stu-id="97e20-180">RoutingService (./RoutingService/bin/RoutingService.exe)</span></span>  
  
4.  <span data-ttu-id="97e20-181">En la ventana de la consola del cliente de la calculadora, presione ENTRAR para iniciar el cliente.</span><span class="sxs-lookup"><span data-stu-id="97e20-181">In the console window of the Calculator client, press ENTER to start the client.</span></span> <span data-ttu-id="97e20-182">El cliente devuelve una lista de los puntos de conexión de destino entre los que elegir.</span><span class="sxs-lookup"><span data-stu-id="97e20-182">The client returns a list of destination endpoints to choose from.</span></span>  
  
5.  <span data-ttu-id="97e20-183">Elija un punto de conexión de destino escribiendo su letra correspondiente y presione ENTRAR.</span><span class="sxs-lookup"><span data-stu-id="97e20-183">Choose a destination endpoint by typing its corresponding letter and press ENTER.</span></span>  
  
6.  <span data-ttu-id="97e20-184">Después, el cliente le pregunta si desea agregar un encabezado personalizado.</span><span class="sxs-lookup"><span data-stu-id="97e20-184">Next, the client asks you if you want to add a custom header.</span></span> <span data-ttu-id="97e20-185">Presione S para indicar Sí o N para indicar No; a continuación, presione ENTRAR.</span><span class="sxs-lookup"><span data-stu-id="97e20-185">Press Y for Yes or N for No, then press ENTER.</span></span>  
  
7.  <span data-ttu-id="97e20-186">En función de las selecciones que realizó, debería ver resultados diferentes.</span><span class="sxs-lookup"><span data-stu-id="97e20-186">Depending on the selections you made, you should see different outputs.</span></span>  
  
    1.  <span data-ttu-id="97e20-187">Lo siguiente es el resultado que se devuelve si agregó un encabezado personalizado a los mensajes.</span><span class="sxs-lookup"><span data-stu-id="97e20-187">The following is the output returned if you added a custom header to the messages.</span></span>  
  
        ```Output  
        Add(100,15.99) = 116  
        Subtract(145,76.54) = 68.5  
        Multiply(9,81.25) = 731.3  
        Divide(22,7) = 3.1  
        ```  
  
    2.  <span data-ttu-id="97e20-188">Lo siguiente es el resultado que se devuelve si eligió el punto de conexión de calculadora de redondeo sin un encabezado personalizado.</span><span class="sxs-lookup"><span data-stu-id="97e20-188">The following is the output returned if you chose the Rounding Calculator endpoint without a custom header.</span></span>  
  
        ```Output  
        Add(100,15.99) = 116  
        Subtract(145,76.54) = 68.5  
        Multiply(9,81.25) = 731.3  
        Divide(22,7) = 3.1  
        ```  
  
    3.  <span data-ttu-id="97e20-189">Lo siguiente es el resultado que se devuelve si eligió el punto de conexión de calculadora normal sin un encabezado personalizado.</span><span class="sxs-lookup"><span data-stu-id="97e20-189">The following is the output returned if you chose the Regular Calculator endpoint without a custom header.</span></span>  
  
        ```Output  
        Add(100,15.99) = 115.99  
        Subtract(145,76.54) = 68. 46  
        Multiply(9,81.25) = 731.25  
        Divide(22,7) = 3.14285714285714  
        ```  
  
    4.  <span data-ttu-id="97e20-190">Lo siguiente es el resultado que se devuelve si eligió el punto de conexión de enrutador predeterminado sin un encabezado personalizado.</span><span class="sxs-lookup"><span data-stu-id="97e20-190">The following is the output returned if you chose the Default Router endpoint without a custom header.</span></span>  
  
        ```Output  
        Add(100,15.99) = 116  
        Subtract(145,76.54) = 68.46  
        Multiply(9,81.25) = 731.3  
        Divide(22,7) = 3.14285714285714  
        ```  
  
8.  <span data-ttu-id="97e20-191">El servicio de calculadora y el servicio de calculadora de redondeo también imprime un registro de las operaciones invocadas en sus respectivas ventanas de consola.</span><span class="sxs-lookup"><span data-stu-id="97e20-191">The Calculator Service and the Rounding Calculator Service also prints out a log of the operations invoked to their respective console windows.</span></span>  
  
9. <span data-ttu-id="97e20-192">En la ventana de consola de cliente, escriba `quit` y presione ENTRAR para salir.</span><span class="sxs-lookup"><span data-stu-id="97e20-192">In the client console window, type `quit` and press ENTER to exit.</span></span>  
  
10. <span data-ttu-id="97e20-193">Presione ENTRAR en las ventanas de la consola de servicios para terminar los servicios.</span><span class="sxs-lookup"><span data-stu-id="97e20-193">Press ENTER in the services console windows to terminate the services.</span></span>  
  
## <a name="configurable-via-code-or-appconfig"></a><span data-ttu-id="97e20-194">Configurable a través de código o App.onfig</span><span class="sxs-lookup"><span data-stu-id="97e20-194">Configurable Via Code or App.config</span></span>  
 <span data-ttu-id="97e20-195">El ejemplo viene configurado para utilizar un archivo App.config que define el comportamiento del enrutador.</span><span class="sxs-lookup"><span data-stu-id="97e20-195">The sample ships configured to use an App.config file to define the router’s behavior.</span></span> <span data-ttu-id="97e20-196">También puede cambiar el nombre del archivo RoutingService\App.config por otro que no se reconozca y quitar el comentario de la llamada al método `ConfigureRouterViaCode()` en RoutingService\routing.cs.</span><span class="sxs-lookup"><span data-stu-id="97e20-196">You can also change the name of the RoutingService\App.config file to something else so that it is not recognized and uncomment the method call to `ConfigureRouterViaCode()` in RoutingService\routing.cs.</span></span> <span data-ttu-id="97e20-197">Cualquier método provoca el mismo comportamiento del enrutador.</span><span class="sxs-lookup"><span data-stu-id="97e20-197">Either method results in the same behavior from the router.</span></span>  
  
### <a name="scenario"></a><span data-ttu-id="97e20-198">Escenario</span><span class="sxs-lookup"><span data-stu-id="97e20-198">Scenario</span></span>  
 <span data-ttu-id="97e20-199">En este ejemplo se muestra el enrutador que actúa como enrutador basado en contenido que permite exponer varios tipos o la implementación de los servicios a través de un extremo.</span><span class="sxs-lookup"><span data-stu-id="97e20-199">This sample demonstrates the router acting as a content-based router allowing multiple types or implementation of services to be exposed through one endpoint.</span></span>  
  
### <a name="real-world-scenario"></a><span data-ttu-id="97e20-200">Escenario real</span><span class="sxs-lookup"><span data-stu-id="97e20-200">Real World Scenario</span></span>  
 <span data-ttu-id="97e20-201">Contoso desea virtualizar todos sus servicios para exponer solo un extremo a través del que ofrecer acceso a varios tipos diferentes de servicios públicamente.</span><span class="sxs-lookup"><span data-stu-id="97e20-201">Contoso wants to virtualize all of their services to expose only one endpoint publicly through which they offer access to multiple different types of services.</span></span> <span data-ttu-id="97e20-202">En este caso, utilizan las capacidades de enrutamiento basado en contenido del servicio de enrutamiento para determinar dónde se deberían enviar las solicitudes entrantes.</span><span class="sxs-lookup"><span data-stu-id="97e20-202">In this case they utilize the routing service’s content-based routing capabilities to determine where the incoming requests should be sent.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="97e20-203">Vea también</span><span class="sxs-lookup"><span data-stu-id="97e20-203">See Also</span></span>  
 [<span data-ttu-id="97e20-204">Ejemplos de persistencia y el hospedaje de AppFabric</span><span class="sxs-lookup"><span data-stu-id="97e20-204">AppFabric Hosting and Persistence Samples</span></span>](https://go.microsoft.com/fwlink/?LinkId=193961)
