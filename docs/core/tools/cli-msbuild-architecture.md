---
title: "Arquitectura de las herramientas de la línea de comandos de .NET Core"
description: "Obtenga información sobre las capas de herramientas de .NET Core y sobre lo que ha cambiado en versiones recientes."
keywords: .NET Core, MSBuild, arquitectura
author: blackdwarf
ms.date: 03/06/2017
ms.topic: article
ms.prod: .net-core
ms.technology: dotnet-cli
ms.devlang: dotnet
ms.assetid: 7fff0f61-ac23-42f0-9661-72a7240a4456
ms.translationtype: HT
ms.sourcegitcommit: 306c608dc7f97594ef6f72ae0f5aaba596c936e1
ms.openlocfilehash: 6830cc46994aa44d46a9c862efff525142578003
ms.contentlocale: es-es
ms.lasthandoff: 07/28/2017

---

# <a name="high-level-overview-of-changes-in-the-net-core-tools"></a><span data-ttu-id="e3f51-104">Introducción de alto nivel de los cambios en las herramientas de .NET Core</span><span class="sxs-lookup"><span data-stu-id="e3f51-104">High-level overview of changes in the .NET Core tools</span></span>

<span data-ttu-id="e3f51-105">En este documento se describen los cambios asociados con el traslado de *project.json* a MSBuild y al sistema del proyecto *csproj* con información sobre los cambios realizados en las capas de las herramientas de .NET Core y en la implementación de los comandos de la CLI.</span><span class="sxs-lookup"><span data-stu-id="e3f51-105">This document describes the changes associated with moving from *project.json* to MSBuild and the *csproj* project system with information on the changes to the layering of the .NET Core tooling and the implementation of the CLI commands.</span></span> <span data-ttu-id="e3f51-106">Estos cambios se han producido con la versión de .NET Core SDK 1.0 y Visual Studio 2017 de 7 de marzo de 2017 (vea el [anuncio](https://blogs.msdn.microsoft.com/dotnet/2017/03/07/announcing-net-core-tools-1-0/)), pero se han implementado inicialmente con la versión de .NET Core SDK Preview 3.</span><span class="sxs-lookup"><span data-stu-id="e3f51-106">These changes occurred with the release of .NET Core SDK 1.0 and Visual Studio 2017 on March 7, 2017 (see the [announcement](https://blogs.msdn.microsoft.com/dotnet/2017/03/07/announcing-net-core-tools-1-0/)) but were initially implemented with the release of the .NET Core SDK Preview 3.</span></span>

## <a name="moving-away-from-projectjson"></a><span data-ttu-id="e3f51-107">Abandono de project.json</span><span class="sxs-lookup"><span data-stu-id="e3f51-107">Moving away from project.json</span></span>
<span data-ttu-id="e3f51-108">El cambio más importante en las herramientas para .NET Core es ciertamente el [abandono de project.json en favor de csproj](https://blogs.msdn.microsoft.com/dotnet/2016/05/23/changes-to-project-json/) como sistema de proyectos.</span><span class="sxs-lookup"><span data-stu-id="e3f51-108">The biggest change in the tooling for .NET Core is certainly the [move away from project.json to csproj](https://blogs.msdn.microsoft.com/dotnet/2016/05/23/changes-to-project-json/) as the project system.</span></span> <span data-ttu-id="e3f51-109">Las últimas versiones de las herramientas de línea de comandos no admiten archivos *project.json*.</span><span class="sxs-lookup"><span data-stu-id="e3f51-109">The latest versions of the command-line tools don't support *project.json* files.</span></span> <span data-ttu-id="e3f51-110">Esto significa que no puede utilizarse para compilar, ejecutar o publicar bibliotecas y aplicaciones basadas en project.json.</span><span class="sxs-lookup"><span data-stu-id="e3f51-110">That means that it cannot be used to build, run or publish project.json based applications and libraries.</span></span> <span data-ttu-id="e3f51-111">Para poder utilizar esta versión de las herramientas, debe migrar los proyectos existentes o iniciar otros nuevos.</span><span class="sxs-lookup"><span data-stu-id="e3f51-111">In order to use this version of the tools, you will need to migrate your existing projects or start new ones.</span></span> 

<span data-ttu-id="e3f51-112">Como parte de este proceso, el motor de compilación personalizado que se desarrolló para compilar proyectos de project.json se ha reemplazado por un motor de compilación maduro y totalmente compatible llamado [MSBuild](https://github.com/Microsoft/msbuild).</span><span class="sxs-lookup"><span data-stu-id="e3f51-112">As part of this move, the custom build engine that was developed to build project.json projects was replaced with a mature and fully capable build engine called [MSBuild](https://github.com/Microsoft/msbuild).</span></span> <span data-ttu-id="e3f51-113">MSBuild es un motor conocido en la comunidad. NET, ya que ha sido una tecnología clave desde el primer lanzamiento de la plataforma.</span><span class="sxs-lookup"><span data-stu-id="e3f51-113">MSBuild is a well-known engine in the .NET community, since it has been a key technology since the platform's first release.</span></span> <span data-ttu-id="e3f51-114">Por supuesto, como debe compilar aplicaciones .NET Core, MSBuild se ha trasladado a .NET Core y puede utilizarse en cualquier plataforma donde se ejecute .NET Core.</span><span class="sxs-lookup"><span data-stu-id="e3f51-114">Of course, because it needs to build .NET Core applications, MSBuild has been ported to .NET Core and can be used on any platform that .NET Core runs on.</span></span> <span data-ttu-id="e3f51-115">Una de las promesas principales de .NET Core es una pila de desarrollo multiplataforma, y nos hemos asegurado de que esta transición no rompa esa promesa.</span><span class="sxs-lookup"><span data-stu-id="e3f51-115">One of the main promises of .NET Core is that of a cross-platform development stack, and we have made sure that this move does not break that promise.</span></span>

> [!NOTE]
> <span data-ttu-id="e3f51-116">Si no está familiarizado con MSBuild y quiere aprender más al respecto, puede empezar por leer el artículo [Conceptos de MSBuild](/visualstudio/msbuild/msbuild-concepts).</span><span class="sxs-lookup"><span data-stu-id="e3f51-116">If you are new to MSBuild and would like to learn more about it, you can start by reading the [MSBuild Concepts](/visualstudio/msbuild/msbuild-concepts) article.</span></span> 

## <a name="the-tooling-layers"></a><span data-ttu-id="e3f51-117">Las capas de herramientas</span><span class="sxs-lookup"><span data-stu-id="e3f51-117">The tooling layers</span></span>
<span data-ttu-id="e3f51-118">Cuando nos alejamos del sistema de proyecto existente y pensamos en la compilación de modificadores del motor, la pregunta que surge de manera natural es: ¿cambiarán algunos de estos cambios la "disposición en capas" general del ecosistema completo de herramientas de .NET Core?</span><span class="sxs-lookup"><span data-stu-id="e3f51-118">With the move away from the existing project system as well as with building engine switches, the question that naturally follows is do any of these changes change the overall "layering" of the whole .NET Core tooling ecosystem?</span></span> <span data-ttu-id="e3f51-119">¿Hay nuevos bits y componentes?</span><span class="sxs-lookup"><span data-stu-id="e3f51-119">Are there new bits and components?</span></span>

<span data-ttu-id="e3f51-120">Comencemos con un repaso rápido de la disposición en capas de Preview 2, como se muestra en la siguiente imagen:</span><span class="sxs-lookup"><span data-stu-id="e3f51-120">Let's start with a quick refresher on Preview 2 layering as shown in the following picture:</span></span>

![Arquitectura de alto nivel de herramientas de Preview 2](media/cli-msbuild-architecture/p2-arch.png)

<span data-ttu-id="e3f51-122">La disposición en capas de las herramientas es bastante sencilla.</span><span class="sxs-lookup"><span data-stu-id="e3f51-122">The layering of the tools is quite simple.</span></span> <span data-ttu-id="e3f51-123">En la parte inferior, tenemos como base las herramientas de línea de comandos de .NET Core.</span><span class="sxs-lookup"><span data-stu-id="e3f51-123">At the bottom we have the .NET Core Command Line tools as a foundation.</span></span> <span data-ttu-id="e3f51-124">Todas las demás herramientas de mayor nivel, como Visual Studio o Visual Studio Code, dependen de la CLI para compilar proyectos, restaurar dependencias, etc.</span><span class="sxs-lookup"><span data-stu-id="e3f51-124">All other, higher-level tools such as Visual Studio or Visual Studio Code, depend and rely on the CLI to build projects, restore dependencies and so on.</span></span> <span data-ttu-id="e3f51-125">Esto significa que si, por ejemplo, se quisiera realizar una operación de restauración con Visual Studio, se llamaría al comando `dotnet restore` de la CLI.</span><span class="sxs-lookup"><span data-stu-id="e3f51-125">This meant that, for example, if Visual Studio wanted to perform a restore operation, it would call into `dotnet restore` command in the CLI.</span></span> 

<span data-ttu-id="e3f51-126">Con el paso al nuevo sistema de proyecto, el diagrama anterior cambia:</span><span class="sxs-lookup"><span data-stu-id="e3f51-126">With the move to the new project system, the previous diagram changes:</span></span> 

![Arquitectura de alto nivel del SDK 1.0.0 de .NET Core](media/cli-msbuild-architecture/p3-arch.png)

<span data-ttu-id="e3f51-128">La principal diferencia es que la CLI ya no es la base; este papel es ocupado ahora por el "componente de SDK compartido".</span><span class="sxs-lookup"><span data-stu-id="e3f51-128">The main difference is that the CLI is not the foundational layer anymore; this role is now filled by the "shared SDK component".</span></span> <span data-ttu-id="e3f51-129">Este componente de SDK compartido es un conjunto de destinos y tareas asociadas que son responsables de compilar el código y publicarlo, de empaquetar paquetes de NuGet, etc. El propio SDK es código abierto y está disponible en GitHub en el [repositorio de SDK](https://github.com/dotnet/sdk).</span><span class="sxs-lookup"><span data-stu-id="e3f51-129">This shared SDK component is a set of targets and associated tasks that are responsible for compiling your code, publishing it, packing NuGet packages etc. The SDK itself is open-source and is available on GitHub on the [SDK repo](https://github.com/dotnet/sdk).</span></span> 

> [!NOTE]
> <span data-ttu-id="e3f51-130">Un "destino" es un término de MSBuild que indica una operación con nombre que puede invocar MSBuild.</span><span class="sxs-lookup"><span data-stu-id="e3f51-130">A "target" is a MSBuild term that indicates a named operation that MSBuild can invoke.</span></span> <span data-ttu-id="e3f51-131">Normalmente está unido a una o varias tareas que ejecutan alguna lógica que se supone que debe hacer el destino.</span><span class="sxs-lookup"><span data-stu-id="e3f51-131">It is usually coupled with one or more tasks that execute some logic that the target is supposed to do.</span></span> <span data-ttu-id="e3f51-132">MSBuild admite michos destinos predefinidos, como `Copy` o `Execute`; también permite a los usuarios escribir sus propias tareas mediante código administrado y definir destinos para ejecutar esas tareas.</span><span class="sxs-lookup"><span data-stu-id="e3f51-132">MSBuild supports many ready-made targets such as `Copy` or `Execute`; it also allows users to write their own tasks using managed code and define targets to execute those tasks.</span></span> <span data-ttu-id="e3f51-133">Para obtener más información, consulte [Tareas de MSBuild](/visualstudio/msbuild/msbuild-tasks).</span><span class="sxs-lookup"><span data-stu-id="e3f51-133">For more information, see [MSBuild tasks](/visualstudio/msbuild/msbuild-tasks).</span></span> 

<span data-ttu-id="e3f51-134">Todos los conjuntos de herramientas consumen ahora el componente de SDK compartido y sus destinos, incluida la CLI.</span><span class="sxs-lookup"><span data-stu-id="e3f51-134">All the toolsets now consume the shared SDK component and its targets, CLI included.</span></span> <span data-ttu-id="e3f51-135">Por ejemplo, la siguiente versión de Visual Studio no llamará al comando `dotnet restore` para restaurar las dependencias para proyectos de .NET Core, sino que usará directamente el destino "Restore".</span><span class="sxs-lookup"><span data-stu-id="e3f51-135">For example, the next version of Visual Studio will not call into `dotnet restore` command to restore dependencies for .NET Core projects, it will use the "Restore" target directly.</span></span> <span data-ttu-id="e3f51-136">Como son destinos de MSBuild, también puede usar MSBuild sin procesar para ejecutarlos mediante el comando [dotnet msbuild](dotnet-msbuild.md).</span><span class="sxs-lookup"><span data-stu-id="e3f51-136">Since these are MSBuild targets, you can also use raw MSBuild to execute them using the [dotnet msbuild](dotnet-msbuild.md) command.</span></span> 

### <a name="cli-commands"></a><span data-ttu-id="e3f51-137">Comandos de la CLI</span><span class="sxs-lookup"><span data-stu-id="e3f51-137">CLI commands</span></span>
<span data-ttu-id="e3f51-138">El componente de SDK compartido implica que la mayoría de los comandos de la CLI existentes se han vuelto a implementar como tareas y destinos de MSBuild.</span><span class="sxs-lookup"><span data-stu-id="e3f51-138">The shared SDK component means that the majority of existing CLI commands have been re-implemented as MSBuild tasks and targets.</span></span> <span data-ttu-id="e3f51-139">¿Qué significa esto para los comandos de la CLI y el uso del conjunto de herramientas?</span><span class="sxs-lookup"><span data-stu-id="e3f51-139">What does this mean for the CLI commands and your usage of the toolset?</span></span> 

<span data-ttu-id="e3f51-140">Desde una perspectiva del uso, no cambia la forma de usar la CLI.</span><span class="sxs-lookup"><span data-stu-id="e3f51-140">From an usage perspective, it doesn't change the way you use the CLI.</span></span> <span data-ttu-id="e3f51-141">La CLI sigue teniendo los comandos principales que existen en la versión Preview 2:</span><span class="sxs-lookup"><span data-stu-id="e3f51-141">The CLI still has the core commands that exist in Preview 2 release:</span></span>

* `new`
* `restore`
* `run` 
* `build`
* `publish`
* `test`
* `pack` 

<span data-ttu-id="e3f51-142">Estos comandos todavía hacen lo que se espera que hagan (crear un nuevo proyecto, compilarlo, publicarlo, empaquetarlo, etc.).</span><span class="sxs-lookup"><span data-stu-id="e3f51-142">These commands still do what you expect them to do (new up a project, build it, publish it, pack it and so on).</span></span> <span data-ttu-id="e3f51-143">La mayoría de las opciones no varían y siguen ahí. Puede consultar las pantallas de ayuda de los comandos (mediante `dotnet <command> --help`) o la documentación de este sitio para familiarizarse con los cambios.</span><span class="sxs-lookup"><span data-stu-id="e3f51-143">Majority of the options are not changed, and are still there, and you can consult either the commands' help screens (using `dotnet <command> --help`) or documentation on this site to get familiar with any changes.</span></span> 

<span data-ttu-id="e3f51-144">Desde una perspectiva de la ejecución, los comandos de la CLI tomarán sus parámetros y construirán una llamada a MSBuild "sin procesar" que establecerá las propiedades necesarias y ejecutará el destino deseado.</span><span class="sxs-lookup"><span data-stu-id="e3f51-144">From an execution perspective, the CLI commands will take their parameters and construct a call to "raw" MSBuild that will set the needed properties and run the desired target.</span></span> <span data-ttu-id="e3f51-145">Para ilustrar mejor esto, considere el siguiente comando:</span><span class="sxs-lookup"><span data-stu-id="e3f51-145">To better illustrate this, consider the following command:</span></span> 

   `dotnet publish -o pub -c Release`
    
<span data-ttu-id="e3f51-146">Este comando está publicando una aplicación en una carpeta `pub` mediante la configuración de "Release".</span><span class="sxs-lookup"><span data-stu-id="e3f51-146">This command is publishing an application into a `pub` folder using the "Release" configuration.</span></span> <span data-ttu-id="e3f51-147">Internamente, este comando se traduce en la siguiente invocación de MSBuild:</span><span class="sxs-lookup"><span data-stu-id="e3f51-147">Internally, this command gets translated into the following MSBuild invocation:</span></span> 

   `dotnet msbuild /t:Publish /p:OutputPath=pub /p:Configuration=Release`

<span data-ttu-id="e3f51-148">La excepción importante a esta regla son los comandos `new` y `run`, dado que no se han implementado como destinos de MSBuild.</span><span class="sxs-lookup"><span data-stu-id="e3f51-148">The notable exception to this rule are `new` and `run` commands, as they have not been implemented as MSBuild targets.</span></span>

