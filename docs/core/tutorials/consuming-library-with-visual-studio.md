---
title: Consumo de una biblioteca de clases con .NET Core en Visual Studio 2017
description: Cree una aplicación de .NET Core que llame a los miembros de otra biblioteca de clases con Visual Studio 2017.
author: BillWagner
ms.author: wiwagn
ms.date: 06/05/2018
dev_langs:
- csharp
- vb
ms.custom: vs-dotnet, seodec18
ms.openlocfilehash: 424933f4d221492b3127d0b847249821fee86b10
ms.sourcegitcommit: ccd8c36b0d74d99291d41aceb14cf98d74dc9d2b
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 12/10/2018
ms.locfileid: "53147325"
---
# <a name="consuming-a-net-standard-library-in-visual-studio-2017"></a><span data-ttu-id="214f5-103">Consumo de una biblioteca de clases con .NET Core en Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="214f5-103">Consuming a .NET Standard library in Visual Studio 2017</span></span>

<span data-ttu-id="214f5-104">Una vez que haya creado una biblioteca de clases de .NET Standard siguiendo los pasos de [Building a C# class library with .NET Core in Visual Studio 2017](./library-with-visual-studio.md) (Creación de una biblioteca de clases de C# con .NET Core en Visual Studio 2017) o [Building a Visual Basic class library with .NET Core in Visual Studio 2017](vb-library-with-visual-studio.md) (Creación de una biblioteca de clases de Visual Basic con .NET Core en Visual Studio 2017), pruébela en [Testing a class library with .NET Core in Visual Studio 2017](testing-library-with-visual-studio.md) (Prueba de una biblioteca de clases con .NET Core en Visual Studio 2017), y compile una versión de lanzamiento de la biblioteca; el paso siguiente consiste en hacer que esté disponible para los autores de llamadas.</span><span class="sxs-lookup"><span data-stu-id="214f5-104">Once you've created a .NET Standard class library by following the steps in [Building a C# class library with .NET Core in Visual Studio 2017](./library-with-visual-studio.md) or [Building a Visual Basic class library with .NET Core in Visual Studio 2017](vb-library-with-visual-studio.md), tested it in [Testing a class library with .NET Core in Visual Studio 2017](testing-library-with-visual-studio.md), and built a Release version of the library, the next step is to make it available to callers.</span></span> <span data-ttu-id="214f5-105">Existen dos maneras de hacerlo:</span><span class="sxs-lookup"><span data-stu-id="214f5-105">You can do this in two ways:</span></span>

* <span data-ttu-id="214f5-106">Si una única solución va a usar la biblioteca (por ejemplo, si es un componente de una sola aplicación más grande), se puede incluir como proyecto en la solución.</span><span class="sxs-lookup"><span data-stu-id="214f5-106">If the library will be used by a single solution (for example, if it's a component in a single large application), you can include it as a project in your solution.</span></span>

* <span data-ttu-id="214f5-107">Si la biblioteca va a ser accesible con carácter general, puede distribuirla como un paquete NuGet.</span><span class="sxs-lookup"><span data-stu-id="214f5-107">If the library will be generally accessible, you can distribute it as a NuGet package.</span></span>

## <a name="including-a-library-as-a-project-in-a-solution"></a><span data-ttu-id="214f5-108">Inclusión de una biblioteca como proyecto en una solución</span><span class="sxs-lookup"><span data-stu-id="214f5-108">Including a library as a project in a solution</span></span>

<span data-ttu-id="214f5-109">Así como se incluyen pruebas unitarias en la misma solución que la biblioteca de clases, se puede incluir la aplicación como parte de esa solución.</span><span class="sxs-lookup"><span data-stu-id="214f5-109">Just as you included unit tests in the same solution as your class library, you can include your application as part of that solution.</span></span> <span data-ttu-id="214f5-110">Por ejemplo, se puede usar la biblioteca de clases en una aplicación de consola que pide al usuario que inserte una cadena e informa de si su primer carácter está en mayúsculas:</span><span class="sxs-lookup"><span data-stu-id="214f5-110">For example, you can use your class library in a console application that prompts the user to enter a string and reports whether its first character is uppercase:</span></span>

# <a name="ctabcsharp"></a>[<span data-ttu-id="214f5-111">C#</span><span class="sxs-lookup"><span data-stu-id="214f5-111">C#</span></span>](#tab/csharp)
1. <span data-ttu-id="214f5-112">Abra la solución `ClassLibraryProjects` creada en el tema [Building a C# Class Library with .NET Core in Visual Studio 2017](./library-with-visual-studio.md) (Creación de una biblioteca de clases de C# con .NET Core en Visual Studio 2017).</span><span class="sxs-lookup"><span data-stu-id="214f5-112">Open the `ClassLibraryProjects` solution you created in the [Building a C# Class Library with .NET Core in Visual Studio 2017](./library-with-visual-studio.md) topic.</span></span> <span data-ttu-id="214f5-113">En el **Explorador de soluciones**, haga clic con el botón derecho en la solución **ClassLibraryProject** y seleccione **Agregar** > **Nuevo proyecto** en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="214f5-113">In **Solution Explorer**, right-click the **ClassLibraryProjects** solution and select **Add** > **New Project** from the context menu.</span></span>

1. <span data-ttu-id="214f5-114">En el cuadro de diálogo **Agregar nuevo proyecto**, expanda el nodo **Visual C#** y seleccione el nodo **.NET Core** seguido por la plantilla del proyecto **Aplicación de consola (.NET Core)**.</span><span class="sxs-lookup"><span data-stu-id="214f5-114">In the **Add New Project** dialog, expand the **Visual C#** node and select the **.NET Core** node followed by the **Console App (.NET Core)** project template.</span></span> <span data-ttu-id="214f5-115">En el cuadro de texto **Nombre**, escriba "Presentación" y pulse el botón **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="214f5-115">In the **Name** text box, type "ShowCase", and select the **OK** button.</span></span>

   ![Cuadro de diálogo Agregar nuevo proyecto](./media/consuming-library-with-visual-studio/addnewproject.png)

1. <span data-ttu-id="214f5-117">En el **Explorador de soluciones**, haga clic con el botón derecho en el proyecto **Presentación** y seleccione **Establecer como proyecto de inicio** en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="214f5-117">In **Solution Explorer**, right-click the **ShowCase** project and select **Set as StartUp Project** in the context menu.</span></span> 

   ![Menú contextual de Presentación](./media/consuming-library-with-visual-studio/setstartupproject.png)

1. <span data-ttu-id="214f5-119">Inicialmente, el proyecto no tiene acceso a la biblioteca de clases.</span><span class="sxs-lookup"><span data-stu-id="214f5-119">Initially, your project doesn't have access to your class library.</span></span> <span data-ttu-id="214f5-120">Para permitir que se llame a métodos de la biblioteca de clases, puede crear una referencia a la biblioteca de clases.</span><span class="sxs-lookup"><span data-stu-id="214f5-120">To allow it to call methods in your class library, you create a reference to the class library.</span></span> <span data-ttu-id="214f5-121">En el **Explorador de soluciones**, haga clic con el botón derecho en el nodo **Dependencias** del proyecto `ShowCase` y seleccione **Agregar referencia**.</span><span class="sxs-lookup"><span data-stu-id="214f5-121">In **Solution Explorer**, right-click the `ShowCase` project's **Dependencies** node and select **Add Reference**.</span></span>

   ![Menú contextual Dependencias de Presentación](./media/consuming-library-with-visual-studio/addreference.png)

1. <span data-ttu-id="214f5-123">En el cuadro de diálogo **Administrador de referencias**, seleccione **StringLibrary**, el proyecto de biblioteca de clases, y pulse el botón **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="214f5-123">In the **Reference Manager** dialog, select **StringLibrary**, your class library project, and select the **OK** button.</span></span>

   ![Administrador de referencias](./media/consuming-library-with-visual-studio/referencemanager.png)

1. <span data-ttu-id="214f5-125">En la ventana de código del archivo *Program.cs*, reemplace todo el código por el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="214f5-125">In the code window for the *Program.cs* file, replace all of the code with the following code:</span></span>

   [!CODE-csharp[UsingClassLib#1](../../../samples/snippets/csharp/getting_started/with_visual_studio_2017/showcase.cs)]

   <span data-ttu-id="214f5-126">El código usa la variable `row` para mantener un recuento del número de filas de datos escritas en la ventana de consola.</span><span class="sxs-lookup"><span data-stu-id="214f5-126">The code uses the `row` variable to maintain a count of the number of rows of data written to the console window.</span></span> <span data-ttu-id="214f5-127">Siempre que sea mayor o igual a 25, el código borra la ventana de consola y muestra un mensaje al usuario.</span><span class="sxs-lookup"><span data-stu-id="214f5-127">Whenever it is greater than or equal to 25, the code clears the console window and displays a message to the user.</span></span>

   <span data-ttu-id="214f5-128">El programa le pide al usuario que escriba una cadena.</span><span class="sxs-lookup"><span data-stu-id="214f5-128">The program prompts the user to enter a string.</span></span> <span data-ttu-id="214f5-129">Indica si la cadena comienza con un carácter en mayúsculas.</span><span class="sxs-lookup"><span data-stu-id="214f5-129">It indicates whether the string starts with an uppercase character.</span></span> <span data-ttu-id="214f5-130">Si el usuario presiona la tecla Entrar sin especificar una cadena, la aplicación finaliza y la ventana de consola se cierra.</span><span class="sxs-lookup"><span data-stu-id="214f5-130">If the user presses the Enter key without entering a string, the application terminates, and the console window closes.</span></span>

1. <span data-ttu-id="214f5-131">Si es necesario, cambie la barra de herramientas para compilar la versión de **depuración** del proyecto `ShowCase`.</span><span class="sxs-lookup"><span data-stu-id="214f5-131">If necessary, change the toolbar to compile the **Debug** release of the `ShowCase` project.</span></span> <span data-ttu-id="214f5-132">Compile y ejecute el programa haciendo clic en la flecha verde en el botón **Presentación**.</span><span class="sxs-lookup"><span data-stu-id="214f5-132">Compile and run the program by selecting the green arrow on the **ShowCase** button.</span></span>

   ![Imagen](./media/consuming-library-with-visual-studio/toolbar.png)
# <a name="visual-basictabvb"></a>[<span data-ttu-id="214f5-134">Visual Basic</span><span class="sxs-lookup"><span data-stu-id="214f5-134">Visual Basic</span></span>](#tab/vb)
1. <span data-ttu-id="214f5-135">Abra la solución `ClassLibraryProjects` creada en el tema [Building a class Library with Visual Basic and .NET Core in Visual Studio 2017](vb-library-with-visual-studio.md) (Creación de una biblioteca de clases con Visual Basic y .NET Core en Visual Studio 2017).</span><span class="sxs-lookup"><span data-stu-id="214f5-135">Open the `ClassLibraryProjects` solution you created in the [Building a class Library with Visual Basic and .NET Core in Visual Studio 2017](vb-library-with-visual-studio.md) topic.</span></span> <span data-ttu-id="214f5-136">En el **Explorador de soluciones**, haga clic con el botón derecho en la solución **ClassLibraryProject** y seleccione **Agregar** > **Nuevo proyecto** en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="214f5-136">In **Solution Explorer**, right-click the **ClassLibraryProjects** solution and select **Add** > **New Project** from the context menu.</span></span>

1. <span data-ttu-id="214f5-137">En el cuadro de diálogo **Agregar nuevo proyecto**, expanda el nodo **Visual Basic** y seleccione el nodo **.NET Core** seguido por la plantilla del proyecto **Aplicación de consola (.NET Core)**.</span><span class="sxs-lookup"><span data-stu-id="214f5-137">In the **Add New Project** dialog, expand the **Visual Basic** node and select the **.NET Core** node followed by the **Console App (.NET Core)** project template.</span></span> <span data-ttu-id="214f5-138">En el cuadro de texto **Nombre**, escriba "Presentación" y pulse el botón **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="214f5-138">In the **Name** text box, type "ShowCase", and select the **OK** button.</span></span>

   ![Cuadro de diálogo Agregar nuevo proyecto](./media/consuming-library-with-visual-studio/vb-addnewproject.png)

1. <span data-ttu-id="214f5-140">En el **Explorador de soluciones**, haga clic con el botón derecho en el proyecto **Presentación** y seleccione **Establecer como proyecto de inicio** en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="214f5-140">In **Solution Explorer**, right-click the **ShowCase** project and select **Set as StartUp Project** in the context menu.</span></span> 

   ![Menú contextual de Presentación](./media/consuming-library-with-visual-studio/setstartupproject.png)

1. <span data-ttu-id="214f5-142">Inicialmente, el proyecto no tiene acceso a la biblioteca de clases.</span><span class="sxs-lookup"><span data-stu-id="214f5-142">Initially, your project doesn't have access to your class library.</span></span> <span data-ttu-id="214f5-143">Para permitir que se llame a métodos de la biblioteca de clases, puede crear una referencia a la biblioteca de clases.</span><span class="sxs-lookup"><span data-stu-id="214f5-143">To allow it to call methods in your class library, you create a reference to the class library.</span></span> <span data-ttu-id="214f5-144">En el **Explorador de soluciones**, haga clic con el botón derecho en el nodo **Dependencias** del proyecto `ShowCase` y seleccione **Agregar referencia**.</span><span class="sxs-lookup"><span data-stu-id="214f5-144">In **Solution Explorer**, right-click the `ShowCase` project's **Dependencies** node and select **Add Reference**.</span></span>

   ![Menú contextual Dependencias de Presentación](./media/consuming-library-with-visual-studio/addreference.png)

1. <span data-ttu-id="214f5-146">En el cuadro de diálogo **Administrador de referencias**, seleccione **StringLibrary**, el proyecto de biblioteca de clases, y pulse el botón **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="214f5-146">In the **Reference Manager** dialog, select **StringLibrary**, your class library project, and select the **OK** button.</span></span>

   ![Administrador de referencias](./media/consuming-library-with-visual-studio/referencemanager.png)

1. <span data-ttu-id="214f5-148">En la ventana de código del archivo *Program.vb*, reemplace todo el código por el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="214f5-148">In the code window for the *Program.vb* file, replace all of the code with the following code:</span></span>

    [!CODE-vb[UsingClassLib#1](../../../samples/snippets/core/tutorials/vb-library-with-visual-studio/showcase.vb)]

   <span data-ttu-id="214f5-149">El código usa la variable `row` para mantener un recuento del número de filas de datos escritas en la ventana de consola.</span><span class="sxs-lookup"><span data-stu-id="214f5-149">The code uses the `row` variable to maintain a count of the number of rows of data written to the console window.</span></span> <span data-ttu-id="214f5-150">Siempre que sea mayor o igual a 25, el código borra la ventana de consola y muestra un mensaje al usuario.</span><span class="sxs-lookup"><span data-stu-id="214f5-150">Whenever it is greater than or equal to 25, the code clears the console window and displays a message to the user.</span></span>

   <span data-ttu-id="214f5-151">El programa le pide al usuario que escriba una cadena.</span><span class="sxs-lookup"><span data-stu-id="214f5-151">The program prompts the user to enter a string.</span></span> <span data-ttu-id="214f5-152">Indica si la cadena comienza con un carácter en mayúsculas.</span><span class="sxs-lookup"><span data-stu-id="214f5-152">It indicates whether the string starts with an uppercase character.</span></span> <span data-ttu-id="214f5-153">Si el usuario presiona la tecla Entrar sin especificar una cadena, la aplicación finaliza y la ventana de consola se cierra.</span><span class="sxs-lookup"><span data-stu-id="214f5-153">If the user presses the Enter key without entering a string, the application terminates, and the console window closes.</span></span>

1. <span data-ttu-id="214f5-154">Si es necesario, cambie la barra de herramientas para compilar la versión de **depuración** del proyecto `ShowCase`.</span><span class="sxs-lookup"><span data-stu-id="214f5-154">If necessary, change the toolbar to compile the **Debug** release of the `ShowCase` project.</span></span> <span data-ttu-id="214f5-155">Compile y ejecute el programa haciendo clic en la flecha verde en el botón **Presentación**.</span><span class="sxs-lookup"><span data-stu-id="214f5-155">Compile and run the program by selecting the green arrow on the **ShowCase** button.</span></span>

   ![Imagen](./media/consuming-library-with-visual-studio/toolbar.png)
---

<span data-ttu-id="214f5-157">La aplicación que usa esta biblioteca se puede depurar y publicar siguiendo los pasos indicados en [Debugging your Hello World Application with Visual Studio 2017](debugging-with-visual-studio.md) (Depuración de la aplicación Hola a todos con Visual Studio 2017) y [Publishing your Hello World Application with Visual Studio 2017](publishing-with-visual-studio.md) (Publicación de la aplicación Hola a todos con Visual Studio 2017).</span><span class="sxs-lookup"><span data-stu-id="214f5-157">You can debug and publish the application that uses this library by following the steps in [Debugging your Hello World application with Visual Studio 2017](debugging-with-visual-studio.md) and [Publishing your Hello World Application with Visual Studio 2017](publishing-with-visual-studio.md).</span></span>

## <a name="distributing-the-library-in-a-nuget-package"></a><span data-ttu-id="214f5-158">Distribución de la biblioteca en un paquete NuGet</span><span class="sxs-lookup"><span data-stu-id="214f5-158">Distributing the library in a NuGet package</span></span>

<span data-ttu-id="214f5-159">Puede hacer que la biblioteca de clases tenga una disponibilidad amplia si la publica como un paquete NuGet.</span><span class="sxs-lookup"><span data-stu-id="214f5-159">You can make your class library widely available by publishing it as a NuGet package.</span></span> <span data-ttu-id="214f5-160">Visual Studio no admite la creación de paquetes NuGet.</span><span class="sxs-lookup"><span data-stu-id="214f5-160">Visual Studio does not support the creation of NuGet packages.</span></span> <span data-ttu-id="214f5-161">Para crear uno, se usa la [utilidad de línea de comandos `dotnet`](../../core/tools/dotnet.md):</span><span class="sxs-lookup"><span data-stu-id="214f5-161">To create one, you use the [`dotnet` command line utility](../../core/tools/dotnet.md):</span></span>

1. <span data-ttu-id="214f5-162">Abra una ventana de consola.</span><span class="sxs-lookup"><span data-stu-id="214f5-162">Open a console window.</span></span> <span data-ttu-id="214f5-163">Por ejemplo, en el cuadro de texto **Pregúntame cualquier cosa** de la barra de tareas de Windows, escriba `Command Prompt` (o `cmd` para abreviar) y abra una ventana de consola seleccionando la aplicación de escritorio **Símbolo del sistema** o presionando Entrar si está seleccionada en los resultados de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="214f5-163">For example in the **Ask me anything** text box in the Windows taskbar, enter `Command Prompt` (or `cmd` for short), and open a console window by either selecting the **Command Prompt** desktop app or pressing Enter if it's selected in the search results.</span></span>

1. <span data-ttu-id="214f5-164">Vaya al directorio del proyecto de la biblioteca.</span><span class="sxs-lookup"><span data-stu-id="214f5-164">Navigate to your library's project directory.</span></span> <span data-ttu-id="214f5-165">A menos que haya reconfigurado la ubicación típica del archivo, se encuentra en el directorio *Documentos\Visual Studio 2017\Projects\ClassLibraryProjects\StringLibrary*.</span><span class="sxs-lookup"><span data-stu-id="214f5-165">Unless you've reconfigured the typical file location, it's in the *Documents\Visual Studio 2017\Projects\ClassLibraryProjects\StringLibrary* directory.</span></span> <span data-ttu-id="214f5-166">El directorio contiene el código fuente y un archivo de proyecto, *StringLibrary.csproj*.</span><span class="sxs-lookup"><span data-stu-id="214f5-166">The directory contains your source code and a project file, *StringLibrary.csproj*.</span></span>

1. <span data-ttu-id="214f5-167">Emita el comando `dotnet pack --no-build`:</span><span class="sxs-lookup"><span data-stu-id="214f5-167">Issue the command `dotnet pack --no-build`.</span></span> <span data-ttu-id="214f5-168">La utilidad `dotnet` genera un paquete con una extensión *.nupkg*.</span><span class="sxs-lookup"><span data-stu-id="214f5-168">The `dotnet` utility generates a package with a *.nupkg* extension.</span></span>

   > [!TIP]
   > <span data-ttu-id="214f5-169">Si el directorio que contiene *dotnet.exe* no está en la ruta de acceso, puede encontrar su ubicación escribiendo `where dotnet.exe` en la ventana de consola.</span><span class="sxs-lookup"><span data-stu-id="214f5-169">If the directory that contains *dotnet.exe* is not in your PATH, you can find its location by entering `where dotnet.exe` in the console window.</span></span>

<span data-ttu-id="214f5-170">Para más información sobre la creación de paquetes NuGet, consulte [Cómo crear un paquete NuGet con herramientas multiplataforma ](../../core/deploying/creating-nuget-packages.md).</span><span class="sxs-lookup"><span data-stu-id="214f5-170">For more information on creating NuGet packages, see [How to Create a NuGet Package with Cross Platform Tools](../../core/deploying/creating-nuget-packages.md).</span></span>
